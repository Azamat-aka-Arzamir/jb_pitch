var Gr="0.8.2",E=Symbol(`typegpu:${Gr}:$internal`),Ne=Symbol(`typegpu:${Gr}:$gpuValueOf`),st=Symbol(`typegpu:${Gr}:$getNameForward`),Ar=Symbol(`typegpu:${Gr}:$providing`),Xt=Symbol(`typegpu:${Gr}:$ownSnippet`),he=Symbol(`typegpu:${Gr}:$resolve`),fs=Symbol(`typegpu:${Gr}:$repr`);function Ge(e){return!!e?.[E]}var at={[E]:!0,type:"void",toString(){return"void"}},Tp=["bool","f32","f16","i32","u32","u16","vec2f","vec2h","vec2i","vec2u","vec2<bool>","vec3f","vec3h","vec3i","vec3u","vec3<bool>","vec4f","vec4h","vec4i","vec4u","vec4<bool>","mat2x2f","mat3x3f","mat4x4f","struct","array","ptr","atomic","decorated","abstractInt","abstractFloat","void","texture_1d","texture_storage_1d","texture_2d","texture_storage_2d","texture_multisampled_2d","texture_depth_2d","texture_depth_multisampled_2d","texture_2d_array","texture_storage_2d_array","texture_depth_2d_array","texture_cube","texture_depth_cube","texture_cube_array","texture_depth_cube_array","texture_3d","texture_storage_3d","texture_external","sampler","sampler_comparison"];function Ze(e){let t=e;return Ge(t)&&typeof t.kind=="string"&&t.kind.startsWith("vec")}function Ea(e){let t=e;return Ge(t)&&typeof t.type=="string"&&t.type.startsWith("vec2")}function Sa(e){let t=e;return Ge(t)&&typeof t.type=="string"&&t.type.startsWith("vec3")}function Ul(e){let t=e;return Ge(t)&&typeof t.type=="string"&&t.type.startsWith("vec4")}function rr(e){return Ea(e)||Sa(e)||Ul(e)}function jn(e){let t=e;return Ge(t)&&typeof t.kind?.startsWith=="function"&&t.kind.startsWith("mat")}function Al(e){return Ge(e)&&e?.type==="mat2x2f"}function Il(e){return Ge(e)&&e?.type==="mat3x3f"}function _p(e){return Ge(e)&&e?.type==="mat4x4f"}function Ns(e){return Al(e)||Il(e)||_p(e)}function ru(e){return Ze(e)&&["vec2f","vec3f","vec4f"].includes(e.kind)}function zt(e){return Ge(e)&&Tp.includes(e?.type)}function Lt(e){return Ge(e)&&e?.type==="array"}function vt(e){return Ge(e)&&e?.type==="struct"}function Br(e){return Ge(e)&&e?.type==="ptr"}function ki(e){return Ge(e)&&e?.type==="atomic"}function co(e){return Ge(e)&&e?.type==="@align"}function ho(e){return Ge(e)&&e?.type==="@size"}function Bl(e){return Ge(e)&&e?.type==="@location"}function $p(e){return Ge(e)&&e?.type==="@interpolate"}function po(e){return Ge(e)&&e?.type==="@builtin"}function zn(e){return Ge(e)&&e?.type==="decorated"}function kl(e){return Ge(e)&&e.type==="void"}function sr(e){let t=e?.type;return Ge(e)&&(t==="abstractInt"||t==="abstractFloat"||t==="f32"||t==="f16"||t==="i32"||t==="u32")}function fo(e){let t=e?.type;return Ge(e)&&(t==="f16"||t==="vec2h"||t==="vec3h"||t==="vec4h")}Object.assign(globalThis,{__TYPEGPU_AUTONAME__:(e,t)=>(Qi(e)&&Ge(e)&&!W(e)&&e.$name(t),e)});var Pa=globalThis;function Ol(e){return!!e?.[st]}function W(e){return Ol(e)?W(e[st]):Ki(e)?.name}function Fe(e,t){Ol(e)&&Fe(e[st],t),Mp(e,{name:t})}function Qi(e){return!!e?.$name}function Ps(e){return!!Ki(e)?.ast}function Ki(e){return Pa.__TYPEGPU_META__.get(e)}function Mp(e,t){Pa.__TYPEGPU_META__??=new WeakMap;let n=Pa.__TYPEGPU_META__;n.set(e,{...n.get(e),...t})}var Vl=["uint8","uint8x2","uint8x4","sint8","sint8x2","sint8x4","unorm8","unorm8x2","unorm8x4","snorm8","snorm8x2","snorm8x4","uint16","uint16x2","uint16x4","sint16","sint16x2","sint16x4","unorm16","unorm16x2","unorm16x4","snorm16","snorm16x2","snorm16x4","float16","float16x2","float16x4","float32","float32x2","float32x3","float32x4","uint32","uint32x2","uint32x3","uint32x4","sint32","sint32x2","sint32x3","sint32x4","unorm10-10-10-2","unorm8x4-bgra"],zp={f32:"float32",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",f16:"float16",vec2h:"float16x2",vec4h:"float16x4",u32:"uint32",vec2u:"uint32x2",vec3u:"uint32x3",vec4u:"uint32x4",i32:"sint32",vec2i:"sint32x2",vec3i:"sint32x3",vec4i:"sint32x4"};function mr(e){return e.type==="decorated"||e.type==="loose-decorated"?e.inner:e}var Ep=["unstruct","disarray","loose-decorated",...Vl];function ms(e){return Ge(e)&&Ep.includes(e?.type)}function ir(e){return Ge(e)&&e?.type==="disarray"}function En(e){return Ge(e)&&e?.type==="unstruct"}function Sn(e){return Ge(e)&&e?.type==="loose-decorated"}function Us(e){return e.attribs?.find(co)?.params[0]}function Sp(e){return e.attribs?.find(ho)?.params[0]}function yr(e){return e.attribs?.find(Bl)?.params[0]}function Dr(e){return zt(e)||ms(e)}var kt={type:"unknown",toString(){return"unknown"}},su=class{constructor(t,n,r){this.name=t,this.lhs=n,this.operator=r}},iu=class{constructor(t){this.matrix=t}},au=class{constructor(t){this.op=t,Fe(this,"consoleLog")}[E]=!0},Pp="Invariant failed";function er(e,t){if(!e)throw new Error(Pp)}var Ms=class Ua extends Error{constructor(t,n){let r=n.map(s=>`- ${Ps(s)?`fn*:${W(s)}`:s}`);r.length>20&&(r=[...r.slice(0,11),"...",...r.slice(-10)]),super(`Resolution of the following tree failed:
${r.join(`
`)}: ${t&&typeof t=="object"&&"message"in t?t.message:t}`),this.cause=t,this.trace=n,Object.setPrototypeOf(this,Ua.prototype)}appendToTrace(t){let n=[t,...this.trace];return new Ua(this.cause,n)}},ou=class Aa extends Error{constructor(t,n){let r=n.map(s=>`- ${s}`);r.length>20&&(r=[...r.slice(0,11),"...",...r.slice(-10)]),super(`Execution of the following tree failed:
${r.join(`
`)}: ${t&&typeof t=="object"&&"message"in t?t.message:t}`),this.cause=t,this.trace=n,Object.setPrototypeOf(this,Aa.prototype)}appendToTrace(t){let n=[t,...this.trace];return new Aa(this.cause,n)}},Up=class Gl extends Error{constructor(t){super(`Missing value for '${t}'`),this.slot=t,Object.setPrototypeOf(this,Gl.prototype)}},Ap=class Dl extends Error{constructor(t){super(`Buffer '${W(t)??"<unnamed>"}' is not bindable as a uniform. Use .$usage('uniform') to allow it.`),Object.setPrototypeOf(this,Dl.prototype)}},Ip=class Rl extends Error{constructor(t,n){super(`The function '${t??"<unnamed>"}' is missing links to the following external values: ${n}.`),Object.setPrototypeOf(this,Rl.prototype)}},mo=class Nl extends Error{constructor(t){super(`Missing bind groups for layouts: '${[...t].map(n=>W(n)??"<unnamed>").join(", ")}'. Please provide it using pipeline.with(bindGroup).(...)`),Object.setPrototypeOf(this,Nl.prototype)}},Fl=class Ll extends Error{constructor(t){super(`Missing vertex buffers for layouts: '${[...t].map(n=>W(n)??"<unnamed>").join(", ")}'. Please provide it using pipeline.with(layout, buffer).(...)`),Object.setPrototypeOf(this,Ll.prototype)}},uu=class jl extends Error{constructor(t){super(t),Object.setPrototypeOf(this,jl.prototype)}},lu=class Yl extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Yl.prototype)}},yn=class Cl extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Cl.prototype)}};function Ia(e){return e?.resourceType==="slot"}function Ba(e){return e?.resourceType==="derived"}function ka(e){return e?.[Ar]!==void 0}function ea(e){return e?.resourceType==="accessor"}var ql=class{constructor(t,n){this.value=t,this.dataType=n}};function yo(e){return e instanceof ql}function fi(e){return sr(e.dataType)}function B(e,t){return new ql(e,mr(t))}var Wl=class{type="normal"},Bp=class{type="codegen"},kp=class{constructor(e,t){this.buffers=e,this.vars=t}type="simulate"};function Xl(e){return!!e?.[he]}function go(e){return e?.[Xt]}function Op(e){return typeof e=="number"||typeof e=="boolean"||typeof e=="string"||Xl(e)||zt(e)||Ia(e)||Ba(e)||ka(e)}function Oa(e){return!!e&&typeof e=="object"&&"getMappedRange"in e&&"mapAsync"in e}var Mi=!1;function Vp(e){if(Mi)return e();try{return Mi=!0,e()}finally{Mi=!1}}function Oi(){return Mi}var lr;function Jl(e,t){if(er(lr===void 0||lr===e),lr===e)return t();lr=e;try{return t()}finally{lr=void 0}}function gr(){return lr}var Zl=new Wl;function Vi(){return lr?.mode??Zl}function kn(){return lr?.mode.type==="codegen"}function S(e,...t){let n=gr();function r(i){return yo(i)?n.resolve(i.value,i.dataType).value:i}let s="";for(let i=0;i<e.length;++i){s+=e[i];let p=t[i];Array.isArray(p)?s+=p.filter(y=>y!==void 0).map(r).join(", "):p&&(s+=r(p))}return s}function hs(e,t){throw new Error(`Failed to handle ${e} at ${t}`)}var wo={rank:Number.POSITIVE_INFINITY,action:"none"};function Gi(e,t){let n=mr(e),r=mr(t);if(n.type===r.type)return{rank:0,action:"none"};if(n.type==="abstractFloat"){if(r.type==="f32")return{rank:1,action:"none"};if(r.type==="f16")return{rank:2,action:"none"}}if(n.type==="abstractInt"){if(r.type==="i32")return{rank:3,action:"none"};if(r.type==="u32")return{rank:4,action:"none"};if(r.type==="abstractFloat")return{rank:5,action:"none"};if(r.type==="f32")return{rank:6,action:"none"};if(r.type==="f16")return{rank:7,action:"none"}}return rr(n)&&rr(r)?Gi(n.primitive,r.primitive):Ns(n)&&Ns(r)?{rank:0,action:"none"}:wo}function Gp(e,t){let n=mr(e),r=mr(t);if(n.type==="ptr"&&Gi(n.inner,r).rank<Number.POSITIVE_INFINITY)return{rank:0,action:"deref"};if(r.type==="ptr"&&Gi(n,r.inner).rank<Number.POSITIVE_INFINITY)return{rank:1,action:"ref"};let s={f32:0,f16:1,i32:2,u32:3,bool:4};if(n.type in s&&r.type in s){let i=n.type,p=r.type;if(i!==p){let y=s[i];return{rank:s[p]<y?10:20,action:"cast",targetType:r}}}if(n.type==="abstractFloat"){if(r.type==="u32")return{rank:2,action:"cast",targetType:r};if(r.type==="i32")return{rank:1,action:"cast",targetType:r}}return wo}function Dp(e,t,n){let r=Gi(e,t);return r.rank<Number.POSITIVE_INFINITY?r:n?Gp(e,t):wo}function cu(e,t,n){let r;for(let i of t){let p=[],y=0;for(let v of e){let _=Dp(v,i,n);if(y+=_.rank,_.rank===Number.POSITIVE_INFINITY)break;p.push(_)}y<(r?.sum??Number.POSITIVE_INFINITY)&&(r={type:i,details:p,sum:y})}if(!r)return;let s=r.details.map((i,p)=>({sourceIndex:p,action:i.action,...i.action==="cast"&&{targetType:i.targetType}}));return{targetType:r.type,actions:s,hasImplicitConversions:s.some(i=>i.action==="cast")}}function xo(e,t){if(e.length===0)return;let n=[...new Set((t||e).map(mr))],r=cu(e,n,!1);if(r)return r;let s=cu(e,n,!0);if(s)return s}function Rp(e,t,n){if(t.action==="none")return B(e.value,n);switch(t.action){case"ref":return B(S`&${e}`,n);case"deref":return B(S`*${e}`,n);case"cast":return n(e);default:hs(t.action,"applyActionToSnippet")}}function ct(e,t){if(e.some(r=>r.type==="unknown"))return;let n=xo(e,t);if(n)return e.map(()=>n.targetType)}function As(e,t,n=!0){let r=e.map(i=>i.dataType);if(r.some(i=>i.type==="unknown"))return;let s=xo(r,t);if(s)return e.map((i,p)=>{let y=s.actions[p];return er(y),Rp(i,y,s.targetType)})}function Va(e,t,n=!0){if(t===e.dataType)return B(e.value,t);if(e.dataType.type==="unknown")return B(S`${B(e.value,t)}`,t);let r=As([e],[t],n);if(!r)throw new yn(`Cannot convert value of type '${e.dataType.type}' to type '${t.type}'`);return r[0]}function Np(e,t){return Object.keys(e.propTypes).map(n=>{let r=t[n];if(!r)throw new Error(`Missing property ${n}`);let s=e.propTypes[n];return As([r],[s])?.[0]??r})}function Fp(e){return typeof e!="string"&&go(e)===void 0}function ce(e,t,n,r="keep"){let s=((...i)=>kn()?t(...i):e(...i));return Fe(s,n),s.toString=()=>n,Object.defineProperty(s,E,{value:{jsImpl:e,gpuImpl:t,argConversionHint:r}}),s}var on=class extends Error{constructor(t){super(t),this.name=this.constructor.name}};function D(e){let t=(...r)=>{let{argTypes:s,returnType:i}=typeof e.signature=="function"?e.signature(...r.map(y=>y.dataType)):e.signature,p=r.map((y,v)=>Va(y,s[v],!e.ignoreImplicitCastWarning));if(p.every(y=>Fp(y.value))&&typeof e.normalImpl=="function")try{return B(e.normalImpl(...p.map(y=>y.value)),i)}catch(y){if(!(y instanceof on))throw y}return B(e.codegenImpl(...p),i)},n=((...r)=>{if(kn())return t(...r);if(typeof e.normalImpl=="string")throw new on(e.normalImpl);return e.normalImpl(...r)});return Fe(n,e.name),n.toString=()=>e.name,Object.defineProperty(n,E,{value:{jsImpl:e.normalImpl,gpuImpl:t,argConversionHint:"keep"}}),n}var Zs={[E]:!0,type:"abstractInt",toString(){return"abstractInt"}},Pn={[E]:!0,type:"abstractFloat",toString(){return"abstractFloat"}},Lp=D({name:"bool",signature:e=>({argTypes:e?[e]:[],returnType:ke}),normalImpl(e){return e===void 0?!1:typeof e=="boolean"?e:!!e},codegenImpl:e=>e.dataType.type==="bool"?S`${e}`:S`bool(${e})`}),ke=Object.assign(Lp,{type:"bool"}),jp=D({name:"u32",signature:e=>({argTypes:e?[e]:[],returnType:J}),normalImpl(e){return e===void 0?0:typeof e=="boolean"?e?1:0:(e&4294967295)>>>0},codegenImpl:e=>e.dataType.type==="u32"?S`${e}`:S`u32(${e})`}),J=Object.assign(jp,{type:"u32"}),Yp=D({name:"i32",signature:e=>({argTypes:e?[e]:[],returnType:Ae}),normalImpl(e){return e===void 0?0:typeof e=="boolean"?e?1:0:e|0},codegenImpl:e=>e.dataType.type==="i32"?S`${e}`:S`i32(${e})`}),Cp={[E]:!0,type:"u16"},Ae=Object.assign(Yp,{type:"i32"}),qp=D({name:"f32",signature:e=>({argTypes:e?[e]:[],returnType:$}),normalImpl(e){return e===void 0?0:typeof e=="boolean"?e?1:0:Math.fround(e)},codegenImpl:e=>e.dataType.type==="f32"?S`${e}`:S`f32(${e})`}),$=Object.assign(qp,{type:"f32"}),Hl=new ArrayBuffer(4),Wp=new Float32Array(Hl),Xp=new Uint32Array(Hl);function Jp(e){Wp[0]=e;let t=Xp[0],n=t>>>31&1,r=t>>>23&255,s=t&8388607;return r===255?n<<15|31744|(s?512:0):(r=r-127+15,r<=0?r<-10?n<<15:(s=(s|8388608)>>1-r,s=s+4096>>13,n<<15|s):r>=31||(s=s+4096,s&8388608&&(s=0,++r,r>=31))?n<<15|31744:n<<15|r<<10|s>>13)}function Zp(e){let t=e&32768?-1:1,n=e>>10&31,r=e&1023;return n===0?r?t*r*2**-24:t*0:n===31?r?Number.NaN:t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t*(1+r/1024)*2**(n-15)}function Hp(e){return Zp(Jp(e))}var Qp=D({name:"f16",signature:e=>({argTypes:e?[e]:[],returnType:ut}),normalImpl(e){return e===void 0?0:typeof e=="boolean"?e?1:0:Hp(e)},codegenImpl:e=>e.dataType.type==="f16"?S`${e}`:S`f16(${e})`}),ut=Object.assign(Qp,{type:"f16"}),Rr=class extends Array{castElement(){return this[E].elementSchema[E].jsImpl}[he](){let t=this[E].elementSchema;return this.every(n=>!n)?B(`${this.kind}()`,t):this.every(n=>this[0]===n)?B(`${this.kind}(${this[0]})`,t):B(`${this.kind}(${this.join(", ")})`,t)}toString(){return this[he]().value}get xx(){return new this._Vec2(this[0],this[0])}get xy(){return new this._Vec2(this[0],this[1])}get xz(){return new this._Vec2(this[0],this[2])}get xw(){return new this._Vec2(this[0],this[3])}get yx(){return new this._Vec2(this[1],this[0])}get yy(){return new this._Vec2(this[1],this[1])}get yz(){return new this._Vec2(this[1],this[2])}get yw(){return new this._Vec2(this[1],this[3])}get zx(){return new this._Vec2(this[2],this[0])}get zy(){return new this._Vec2(this[2],this[1])}get zz(){return new this._Vec2(this[2],this[2])}get zw(){return new this._Vec2(this[2],this[3])}get wx(){return new this._Vec2(this[3],this[0])}get wy(){return new this._Vec2(this[3],this[1])}get wz(){return new this._Vec2(this[3],this[2])}get ww(){return new this._Vec2(this[3],this[3])}get xxx(){return new this._Vec3(this[0],this[0],this[0])}get xxy(){return new this._Vec3(this[0],this[0],this[1])}get xxz(){return new this._Vec3(this[0],this[0],this[2])}get xxw(){return new this._Vec3(this[0],this[0],this[3])}get xyx(){return new this._Vec3(this[0],this[1],this[0])}get xyy(){return new this._Vec3(this[0],this[1],this[1])}get xyz(){return new this._Vec3(this[0],this[1],this[2])}get xyw(){return new this._Vec3(this[0],this[1],this[3])}get xzx(){return new this._Vec3(this[0],this[2],this[0])}get xzy(){return new this._Vec3(this[0],this[2],this[1])}get xzz(){return new this._Vec3(this[0],this[2],this[2])}get xzw(){return new this._Vec3(this[0],this[2],this[3])}get xwx(){return new this._Vec3(this[0],this[3],this[0])}get xwy(){return new this._Vec3(this[0],this[3],this[1])}get xwz(){return new this._Vec3(this[0],this[3],this[2])}get xww(){return new this._Vec3(this[0],this[3],this[3])}get yxx(){return new this._Vec3(this[1],this[0],this[0])}get yxy(){return new this._Vec3(this[1],this[0],this[1])}get yxz(){return new this._Vec3(this[1],this[0],this[2])}get yxw(){return new this._Vec3(this[1],this[0],this[3])}get yyx(){return new this._Vec3(this[1],this[1],this[0])}get yyy(){return new this._Vec3(this[1],this[1],this[1])}get yyz(){return new this._Vec3(this[1],this[1],this[2])}get yyw(){return new this._Vec3(this[1],this[1],this[3])}get yzx(){return new this._Vec3(this[1],this[2],this[0])}get yzy(){return new this._Vec3(this[1],this[2],this[1])}get yzz(){return new this._Vec3(this[1],this[2],this[2])}get yzw(){return new this._Vec3(this[1],this[2],this[3])}get ywx(){return new this._Vec3(this[1],this[3],this[0])}get ywy(){return new this._Vec3(this[1],this[3],this[1])}get ywz(){return new this._Vec3(this[1],this[3],this[2])}get yww(){return new this._Vec3(this[1],this[3],this[3])}get zxx(){return new this._Vec3(this[2],this[0],this[0])}get zxy(){return new this._Vec3(this[2],this[0],this[1])}get zxz(){return new this._Vec3(this[2],this[0],this[2])}get zxw(){return new this._Vec3(this[2],this[0],this[3])}get zyx(){return new this._Vec3(this[2],this[1],this[0])}get zyy(){return new this._Vec3(this[2],this[1],this[1])}get zyz(){return new this._Vec3(this[2],this[1],this[2])}get zyw(){return new this._Vec3(this[2],this[1],this[3])}get zzx(){return new this._Vec3(this[2],this[2],this[0])}get zzy(){return new this._Vec3(this[2],this[2],this[1])}get zzz(){return new this._Vec3(this[2],this[2],this[2])}get zzw(){return new this._Vec3(this[2],this[2],this[3])}get zwx(){return new this._Vec3(this[2],this[3],this[0])}get zwy(){return new this._Vec3(this[2],this[3],this[1])}get zwz(){return new this._Vec3(this[2],this[3],this[2])}get zww(){return new this._Vec3(this[2],this[3],this[3])}get wxx(){return new this._Vec3(this[3],this[0],this[0])}get wxy(){return new this._Vec3(this[3],this[0],this[1])}get wxz(){return new this._Vec3(this[3],this[0],this[2])}get wxw(){return new this._Vec3(this[3],this[0],this[3])}get wyx(){return new this._Vec3(this[3],this[1],this[0])}get wyy(){return new this._Vec3(this[3],this[1],this[1])}get wyz(){return new this._Vec3(this[3],this[1],this[2])}get wyw(){return new this._Vec3(this[3],this[1],this[3])}get wzx(){return new this._Vec3(this[3],this[2],this[0])}get wzy(){return new this._Vec3(this[3],this[2],this[1])}get wzz(){return new this._Vec3(this[3],this[2],this[2])}get wzw(){return new this._Vec3(this[3],this[2],this[3])}get wwx(){return new this._Vec3(this[3],this[3],this[0])}get wwy(){return new this._Vec3(this[3],this[3],this[1])}get wwz(){return new this._Vec3(this[3],this[3],this[2])}get www(){return new this._Vec3(this[3],this[3],this[3])}get xxxx(){return new this._Vec4(this[0],this[0],this[0],this[0])}get xxxy(){return new this._Vec4(this[0],this[0],this[0],this[1])}get xxxz(){return new this._Vec4(this[0],this[0],this[0],this[2])}get xxxw(){return new this._Vec4(this[0],this[0],this[0],this[3])}get xxyx(){return new this._Vec4(this[0],this[0],this[1],this[0])}get xxyy(){return new this._Vec4(this[0],this[0],this[1],this[1])}get xxyz(){return new this._Vec4(this[0],this[0],this[1],this[2])}get xxyw(){return new this._Vec4(this[0],this[0],this[1],this[3])}get xxzx(){return new this._Vec4(this[0],this[0],this[2],this[0])}get xxzy(){return new this._Vec4(this[0],this[0],this[2],this[1])}get xxzz(){return new this._Vec4(this[0],this[0],this[2],this[2])}get xxzw(){return new this._Vec4(this[0],this[0],this[2],this[3])}get xxwx(){return new this._Vec4(this[0],this[0],this[3],this[0])}get xxwy(){return new this._Vec4(this[0],this[0],this[3],this[1])}get xxwz(){return new this._Vec4(this[0],this[0],this[3],this[2])}get xxww(){return new this._Vec4(this[0],this[0],this[3],this[3])}get xyxx(){return new this._Vec4(this[0],this[1],this[0],this[0])}get xyxy(){return new this._Vec4(this[0],this[1],this[0],this[1])}get xyxz(){return new this._Vec4(this[0],this[1],this[0],this[2])}get xyxw(){return new this._Vec4(this[0],this[1],this[0],this[3])}get xyyx(){return new this._Vec4(this[0],this[1],this[1],this[0])}get xyyy(){return new this._Vec4(this[0],this[1],this[1],this[1])}get xyyz(){return new this._Vec4(this[0],this[1],this[1],this[2])}get xyyw(){return new this._Vec4(this[0],this[1],this[1],this[3])}get xyzx(){return new this._Vec4(this[0],this[1],this[2],this[0])}get xyzy(){return new this._Vec4(this[0],this[1],this[2],this[1])}get xyzz(){return new this._Vec4(this[0],this[1],this[2],this[2])}get xyzw(){return new this._Vec4(this[0],this[1],this[2],this[3])}get xywx(){return new this._Vec4(this[0],this[1],this[3],this[0])}get xywy(){return new this._Vec4(this[0],this[1],this[3],this[1])}get xywz(){return new this._Vec4(this[0],this[1],this[3],this[2])}get xyww(){return new this._Vec4(this[0],this[1],this[3],this[3])}get xzxx(){return new this._Vec4(this[0],this[2],this[0],this[0])}get xzxy(){return new this._Vec4(this[0],this[2],this[0],this[1])}get xzxz(){return new this._Vec4(this[0],this[2],this[0],this[2])}get xzxw(){return new this._Vec4(this[0],this[2],this[0],this[3])}get xzyx(){return new this._Vec4(this[0],this[2],this[1],this[0])}get xzyy(){return new this._Vec4(this[0],this[2],this[1],this[1])}get xzyz(){return new this._Vec4(this[0],this[2],this[1],this[2])}get xzyw(){return new this._Vec4(this[0],this[2],this[1],this[3])}get xzzx(){return new this._Vec4(this[0],this[2],this[2],this[0])}get xzzy(){return new this._Vec4(this[0],this[2],this[2],this[1])}get xzzz(){return new this._Vec4(this[0],this[2],this[2],this[2])}get xzzw(){return new this._Vec4(this[0],this[2],this[2],this[3])}get xzwx(){return new this._Vec4(this[0],this[2],this[3],this[0])}get xzwy(){return new this._Vec4(this[0],this[2],this[3],this[1])}get xzwz(){return new this._Vec4(this[0],this[2],this[3],this[2])}get xzww(){return new this._Vec4(this[0],this[2],this[3],this[3])}get xwxx(){return new this._Vec4(this[0],this[3],this[0],this[0])}get xwxy(){return new this._Vec4(this[0],this[3],this[0],this[1])}get xwxz(){return new this._Vec4(this[0],this[3],this[0],this[2])}get xwxw(){return new this._Vec4(this[0],this[3],this[0],this[3])}get xwyx(){return new this._Vec4(this[0],this[3],this[1],this[0])}get xwyy(){return new this._Vec4(this[0],this[3],this[1],this[1])}get xwyz(){return new this._Vec4(this[0],this[3],this[1],this[2])}get xwyw(){return new this._Vec4(this[0],this[3],this[1],this[3])}get xwzx(){return new this._Vec4(this[0],this[3],this[2],this[0])}get xwzy(){return new this._Vec4(this[0],this[3],this[2],this[1])}get xwzz(){return new this._Vec4(this[0],this[3],this[2],this[2])}get xwzw(){return new this._Vec4(this[0],this[3],this[2],this[3])}get xwwx(){return new this._Vec4(this[0],this[3],this[3],this[0])}get xwwy(){return new this._Vec4(this[0],this[3],this[3],this[1])}get xwwz(){return new this._Vec4(this[0],this[3],this[3],this[2])}get xwww(){return new this._Vec4(this[0],this[3],this[3],this[3])}get yxxx(){return new this._Vec4(this[1],this[0],this[0],this[0])}get yxxy(){return new this._Vec4(this[1],this[0],this[0],this[1])}get yxxz(){return new this._Vec4(this[1],this[0],this[0],this[2])}get yxxw(){return new this._Vec4(this[1],this[0],this[0],this[3])}get yxyx(){return new this._Vec4(this[1],this[0],this[1],this[0])}get yxyy(){return new this._Vec4(this[1],this[0],this[1],this[1])}get yxyz(){return new this._Vec4(this[1],this[0],this[1],this[2])}get yxyw(){return new this._Vec4(this[1],this[0],this[1],this[3])}get yxzx(){return new this._Vec4(this[1],this[0],this[2],this[0])}get yxzy(){return new this._Vec4(this[1],this[0],this[2],this[1])}get yxzz(){return new this._Vec4(this[1],this[0],this[2],this[2])}get yxzw(){return new this._Vec4(this[1],this[0],this[2],this[3])}get yxwx(){return new this._Vec4(this[1],this[0],this[3],this[0])}get yxwy(){return new this._Vec4(this[1],this[0],this[3],this[1])}get yxwz(){return new this._Vec4(this[1],this[0],this[3],this[2])}get yxww(){return new this._Vec4(this[1],this[0],this[3],this[3])}get yyxx(){return new this._Vec4(this[1],this[1],this[0],this[0])}get yyxy(){return new this._Vec4(this[1],this[1],this[0],this[1])}get yyxz(){return new this._Vec4(this[1],this[1],this[0],this[2])}get yyxw(){return new this._Vec4(this[1],this[1],this[0],this[3])}get yyyx(){return new this._Vec4(this[1],this[1],this[1],this[0])}get yyyy(){return new this._Vec4(this[1],this[1],this[1],this[1])}get yyyz(){return new this._Vec4(this[1],this[1],this[1],this[2])}get yyyw(){return new this._Vec4(this[1],this[1],this[1],this[3])}get yyzx(){return new this._Vec4(this[1],this[1],this[2],this[0])}get yyzy(){return new this._Vec4(this[1],this[1],this[2],this[1])}get yyzz(){return new this._Vec4(this[1],this[1],this[2],this[2])}get yyzw(){return new this._Vec4(this[1],this[1],this[2],this[3])}get yywx(){return new this._Vec4(this[1],this[1],this[3],this[0])}get yywy(){return new this._Vec4(this[1],this[1],this[3],this[1])}get yywz(){return new this._Vec4(this[1],this[1],this[3],this[2])}get yyww(){return new this._Vec4(this[1],this[1],this[3],this[3])}get yzxx(){return new this._Vec4(this[1],this[2],this[0],this[0])}get yzxy(){return new this._Vec4(this[1],this[2],this[0],this[1])}get yzxz(){return new this._Vec4(this[1],this[2],this[0],this[2])}get yzxw(){return new this._Vec4(this[1],this[2],this[0],this[3])}get yzyx(){return new this._Vec4(this[1],this[2],this[1],this[0])}get yzyy(){return new this._Vec4(this[1],this[2],this[1],this[1])}get yzyz(){return new this._Vec4(this[1],this[2],this[1],this[2])}get yzyw(){return new this._Vec4(this[1],this[2],this[1],this[3])}get yzzx(){return new this._Vec4(this[1],this[2],this[2],this[0])}get yzzy(){return new this._Vec4(this[1],this[2],this[2],this[1])}get yzzz(){return new this._Vec4(this[1],this[2],this[2],this[2])}get yzzw(){return new this._Vec4(this[1],this[2],this[2],this[3])}get yzwx(){return new this._Vec4(this[1],this[2],this[3],this[0])}get yzwy(){return new this._Vec4(this[1],this[2],this[3],this[1])}get yzwz(){return new this._Vec4(this[1],this[2],this[3],this[2])}get yzww(){return new this._Vec4(this[1],this[2],this[3],this[3])}get ywxx(){return new this._Vec4(this[1],this[3],this[0],this[0])}get ywxy(){return new this._Vec4(this[1],this[3],this[0],this[1])}get ywxz(){return new this._Vec4(this[1],this[3],this[0],this[2])}get ywxw(){return new this._Vec4(this[1],this[3],this[0],this[3])}get ywyx(){return new this._Vec4(this[1],this[3],this[1],this[0])}get ywyy(){return new this._Vec4(this[1],this[3],this[1],this[1])}get ywyz(){return new this._Vec4(this[1],this[3],this[1],this[2])}get ywyw(){return new this._Vec4(this[1],this[3],this[1],this[3])}get ywzx(){return new this._Vec4(this[1],this[3],this[2],this[0])}get ywzy(){return new this._Vec4(this[1],this[3],this[2],this[1])}get ywzz(){return new this._Vec4(this[1],this[3],this[2],this[2])}get ywzw(){return new this._Vec4(this[1],this[3],this[2],this[3])}get ywwx(){return new this._Vec4(this[1],this[3],this[3],this[0])}get ywwy(){return new this._Vec4(this[1],this[3],this[3],this[1])}get ywwz(){return new this._Vec4(this[1],this[3],this[3],this[2])}get ywww(){return new this._Vec4(this[1],this[3],this[3],this[3])}get zxxx(){return new this._Vec4(this[2],this[0],this[0],this[0])}get zxxy(){return new this._Vec4(this[2],this[0],this[0],this[1])}get zxxz(){return new this._Vec4(this[2],this[0],this[0],this[2])}get zxxw(){return new this._Vec4(this[2],this[0],this[0],this[3])}get zxyx(){return new this._Vec4(this[2],this[0],this[1],this[0])}get zxyy(){return new this._Vec4(this[2],this[0],this[1],this[1])}get zxyz(){return new this._Vec4(this[2],this[0],this[1],this[2])}get zxyw(){return new this._Vec4(this[2],this[0],this[1],this[3])}get zxzx(){return new this._Vec4(this[2],this[0],this[2],this[0])}get zxzy(){return new this._Vec4(this[2],this[0],this[2],this[1])}get zxzz(){return new this._Vec4(this[2],this[0],this[2],this[2])}get zxzw(){return new this._Vec4(this[2],this[0],this[2],this[3])}get zxwx(){return new this._Vec4(this[2],this[0],this[3],this[0])}get zxwy(){return new this._Vec4(this[2],this[0],this[3],this[1])}get zxwz(){return new this._Vec4(this[2],this[0],this[3],this[2])}get zxww(){return new this._Vec4(this[2],this[0],this[3],this[3])}get zyxx(){return new this._Vec4(this[2],this[1],this[0],this[0])}get zyxy(){return new this._Vec4(this[2],this[1],this[0],this[1])}get zyxz(){return new this._Vec4(this[2],this[1],this[0],this[2])}get zyxw(){return new this._Vec4(this[2],this[1],this[0],this[3])}get zyyx(){return new this._Vec4(this[2],this[1],this[1],this[0])}get zyyy(){return new this._Vec4(this[2],this[1],this[1],this[1])}get zyyz(){return new this._Vec4(this[2],this[1],this[1],this[2])}get zyyw(){return new this._Vec4(this[2],this[1],this[1],this[3])}get zyzx(){return new this._Vec4(this[2],this[1],this[2],this[0])}get zyzy(){return new this._Vec4(this[2],this[1],this[2],this[1])}get zyzz(){return new this._Vec4(this[2],this[1],this[2],this[2])}get zyzw(){return new this._Vec4(this[2],this[1],this[2],this[3])}get zywx(){return new this._Vec4(this[2],this[1],this[3],this[0])}get zywy(){return new this._Vec4(this[2],this[1],this[3],this[1])}get zywz(){return new this._Vec4(this[2],this[1],this[3],this[2])}get zyww(){return new this._Vec4(this[2],this[1],this[3],this[3])}get zzxx(){return new this._Vec4(this[2],this[2],this[0],this[0])}get zzxy(){return new this._Vec4(this[2],this[2],this[0],this[1])}get zzxz(){return new this._Vec4(this[2],this[2],this[0],this[2])}get zzxw(){return new this._Vec4(this[2],this[2],this[0],this[3])}get zzyx(){return new this._Vec4(this[2],this[2],this[1],this[0])}get zzyy(){return new this._Vec4(this[2],this[2],this[1],this[1])}get zzyz(){return new this._Vec4(this[2],this[2],this[1],this[2])}get zzyw(){return new this._Vec4(this[2],this[2],this[1],this[3])}get zzzx(){return new this._Vec4(this[2],this[2],this[2],this[0])}get zzzy(){return new this._Vec4(this[2],this[2],this[2],this[1])}get zzzz(){return new this._Vec4(this[2],this[2],this[2],this[2])}get zzzw(){return new this._Vec4(this[2],this[2],this[2],this[3])}get zzwx(){return new this._Vec4(this[2],this[2],this[3],this[0])}get zzwy(){return new this._Vec4(this[2],this[2],this[3],this[1])}get zzwz(){return new this._Vec4(this[2],this[2],this[3],this[2])}get zzww(){return new this._Vec4(this[2],this[2],this[3],this[3])}get zwxx(){return new this._Vec4(this[2],this[3],this[0],this[0])}get zwxy(){return new this._Vec4(this[2],this[3],this[0],this[1])}get zwxz(){return new this._Vec4(this[2],this[3],this[0],this[2])}get zwxw(){return new this._Vec4(this[2],this[3],this[0],this[3])}get zwyx(){return new this._Vec4(this[2],this[3],this[1],this[0])}get zwyy(){return new this._Vec4(this[2],this[3],this[1],this[1])}get zwyz(){return new this._Vec4(this[2],this[3],this[1],this[2])}get zwyw(){return new this._Vec4(this[2],this[3],this[1],this[3])}get zwzx(){return new this._Vec4(this[2],this[3],this[2],this[0])}get zwzy(){return new this._Vec4(this[2],this[3],this[2],this[1])}get zwzz(){return new this._Vec4(this[2],this[3],this[2],this[2])}get zwzw(){return new this._Vec4(this[2],this[3],this[2],this[3])}get zwwx(){return new this._Vec4(this[2],this[3],this[3],this[0])}get zwwy(){return new this._Vec4(this[2],this[3],this[3],this[1])}get zwwz(){return new this._Vec4(this[2],this[3],this[3],this[2])}get zwww(){return new this._Vec4(this[2],this[3],this[3],this[3])}get wxxx(){return new this._Vec4(this[3],this[0],this[0],this[0])}get wxxy(){return new this._Vec4(this[3],this[0],this[0],this[1])}get wxxz(){return new this._Vec4(this[3],this[0],this[0],this[2])}get wxxw(){return new this._Vec4(this[3],this[0],this[0],this[3])}get wxyx(){return new this._Vec4(this[3],this[0],this[1],this[0])}get wxyy(){return new this._Vec4(this[3],this[0],this[1],this[1])}get wxyz(){return new this._Vec4(this[3],this[0],this[1],this[2])}get wxyw(){return new this._Vec4(this[3],this[0],this[1],this[3])}get wxzx(){return new this._Vec4(this[3],this[0],this[2],this[0])}get wxzy(){return new this._Vec4(this[3],this[0],this[2],this[1])}get wxzz(){return new this._Vec4(this[3],this[0],this[2],this[2])}get wxzw(){return new this._Vec4(this[3],this[0],this[2],this[3])}get wxwx(){return new this._Vec4(this[3],this[0],this[3],this[0])}get wxwy(){return new this._Vec4(this[3],this[0],this[3],this[1])}get wxwz(){return new this._Vec4(this[3],this[0],this[3],this[2])}get wxww(){return new this._Vec4(this[3],this[0],this[3],this[3])}get wyxx(){return new this._Vec4(this[3],this[1],this[0],this[0])}get wyxy(){return new this._Vec4(this[3],this[1],this[0],this[1])}get wyxz(){return new this._Vec4(this[3],this[1],this[0],this[2])}get wyxw(){return new this._Vec4(this[3],this[1],this[0],this[3])}get wyyx(){return new this._Vec4(this[3],this[1],this[1],this[0])}get wyyy(){return new this._Vec4(this[3],this[1],this[1],this[1])}get wyyz(){return new this._Vec4(this[3],this[1],this[1],this[2])}get wyyw(){return new this._Vec4(this[3],this[1],this[1],this[3])}get wyzx(){return new this._Vec4(this[3],this[1],this[2],this[0])}get wyzy(){return new this._Vec4(this[3],this[1],this[2],this[1])}get wyzz(){return new this._Vec4(this[3],this[1],this[2],this[2])}get wyzw(){return new this._Vec4(this[3],this[1],this[2],this[3])}get wywx(){return new this._Vec4(this[3],this[1],this[3],this[0])}get wywy(){return new this._Vec4(this[3],this[1],this[3],this[1])}get wywz(){return new this._Vec4(this[3],this[1],this[3],this[2])}get wyww(){return new this._Vec4(this[3],this[1],this[3],this[3])}get wzxx(){return new this._Vec4(this[3],this[2],this[0],this[0])}get wzxy(){return new this._Vec4(this[3],this[2],this[0],this[1])}get wzxz(){return new this._Vec4(this[3],this[2],this[0],this[2])}get wzxw(){return new this._Vec4(this[3],this[2],this[0],this[3])}get wzyx(){return new this._Vec4(this[3],this[2],this[1],this[0])}get wzyy(){return new this._Vec4(this[3],this[2],this[1],this[1])}get wzyz(){return new this._Vec4(this[3],this[2],this[1],this[2])}get wzyw(){return new this._Vec4(this[3],this[2],this[1],this[3])}get wzzx(){return new this._Vec4(this[3],this[2],this[2],this[0])}get wzzy(){return new this._Vec4(this[3],this[2],this[2],this[1])}get wzzz(){return new this._Vec4(this[3],this[2],this[2],this[2])}get wzzw(){return new this._Vec4(this[3],this[2],this[2],this[3])}get wzwx(){return new this._Vec4(this[3],this[2],this[3],this[0])}get wzwy(){return new this._Vec4(this[3],this[2],this[3],this[1])}get wzwz(){return new this._Vec4(this[3],this[2],this[3],this[2])}get wzww(){return new this._Vec4(this[3],this[2],this[3],this[3])}get wwxx(){return new this._Vec4(this[3],this[3],this[0],this[0])}get wwxy(){return new this._Vec4(this[3],this[3],this[0],this[1])}get wwxz(){return new this._Vec4(this[3],this[3],this[0],this[2])}get wwxw(){return new this._Vec4(this[3],this[3],this[0],this[3])}get wwyx(){return new this._Vec4(this[3],this[3],this[1],this[0])}get wwyy(){return new this._Vec4(this[3],this[3],this[1],this[1])}get wwyz(){return new this._Vec4(this[3],this[3],this[1],this[2])}get wwyw(){return new this._Vec4(this[3],this[3],this[1],this[3])}get wwzx(){return new this._Vec4(this[3],this[3],this[2],this[0])}get wwzy(){return new this._Vec4(this[3],this[3],this[2],this[1])}get wwzz(){return new this._Vec4(this[3],this[3],this[2],this[2])}get wwzw(){return new this._Vec4(this[3],this[3],this[2],this[3])}get wwwx(){return new this._Vec4(this[3],this[3],this[3],this[0])}get wwwy(){return new this._Vec4(this[3],this[3],this[3],this[1])}get wwwz(){return new this._Vec4(this[3],this[3],this[3],this[2])}get wwww(){return new this._Vec4(this[3],this[3],this[3],this[3])}},Hs=class extends Rr{e0;e1;constructor(t,n){super(2),this.e0=this.castElement()(t),this.e1=this.castElement()(n??t)}get 0(){return this.e0}get 1(){return this.e1}set 0(t){this.e0=this.castElement()(t)}set 1(t){this.e1=this.castElement()(t)}get x(){return this[0]}get y(){return this[1]}set x(t){this[0]=this.castElement()(t)}set y(t){this[1]=this.castElement()(t)}},Qs=class extends Rr{e0;e1;e2;constructor(t,n,r){super(3),this.e0=this.castElement()(t),this.e1=this.castElement()(n??t),this.e2=this.castElement()(r??t)}get 0(){return this.e0}get 1(){return this.e1}get 2(){return this.e2}set 0(t){this.e0=this.castElement()(t)}set 1(t){this.e1=this.castElement()(t)}set 2(t){this.e2=this.castElement()(t)}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=this.castElement()(t)}set y(t){this[1]=this.castElement()(t)}set z(t){this[2]=this.castElement()(t)}},Ks=class extends Rr{e0;e1;e2;e3;constructor(t,n,r,s){super(4),this.e0=this.castElement()(t),this.e1=this.castElement()(n??t),this.e2=this.castElement()(r??t),this.e3=this.castElement()(s??t)}get 0(){return this.e0}get 1(){return this.e1}get 2(){return this.e2}get 3(){return this.e3}set 0(t){this.e0=this.castElement()(t)}set 1(t){this.e1=this.castElement()(t)}set 2(t){this.e2=this.castElement()(t)}set 3(t){this.e3=this.castElement()(t)}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(t){this[0]=t}set y(t){this[1]=t}set z(t){this[2]=t}set w(t){this[3]=t}},vo=class Ql extends Hs{get[E](){return{elementSchema:$}}get kind(){return"vec2f"}get _Vec2(){return Ql}get _Vec3(){return Mo}get _Vec4(){return Uo}},bo=class Kl extends Hs{get[E](){return{elementSchema:ut}}get kind(){return"vec2h"}get _Vec2(){return Kl}get _Vec3(){return zo}get _Vec4(){return Ao}},To=class ec extends Hs{get[E](){return{elementSchema:Ae}}get kind(){return"vec2i"}get _Vec2(){return ec}get _Vec3(){return Eo}get _Vec4(){return Io}},_o=class tc extends Hs{get[E](){return{elementSchema:J}}get kind(){return"vec2u"}get _Vec2(){return tc}get _Vec3(){return So}get _Vec4(){return Bo}},$o=class nc extends Hs{get[E](){return{elementSchema:ke}}get kind(){return"vec2<bool>"}get _Vec2(){return nc}get _Vec3(){return Po}get _Vec4(){return ko}},Mo=class rc extends Qs{get[E](){return{elementSchema:$}}get kind(){return"vec3f"}get _Vec2(){return vo}get _Vec3(){return rc}get _Vec4(){return Uo}},zo=class sc extends Qs{get[E](){return{elementSchema:ut}}get kind(){return"vec3h"}get _Vec2(){return bo}get _Vec3(){return sc}get _Vec4(){return Ao}},Eo=class ic extends Qs{get[E](){return{elementSchema:Ae}}get kind(){return"vec3i"}get _Vec2(){return To}get _Vec3(){return ic}get _Vec4(){return Io}},So=class ac extends Qs{get[E](){return{elementSchema:J}}get kind(){return"vec3u"}get _Vec2(){return _o}get _Vec3(){return ac}get _Vec4(){return Bo}},Po=class oc extends Qs{get[E](){return{elementSchema:ke}}get kind(){return"vec3<bool>"}get _Vec2(){return $o}get _Vec3(){return oc}get _Vec4(){return ko}},Uo=class uc extends Ks{get[E](){return{elementSchema:$}}get kind(){return"vec4f"}get _Vec2(){return vo}get _Vec3(){return Mo}get _Vec4(){return uc}},Ao=class lc extends Ks{get[E](){return{elementSchema:ut}}get kind(){return"vec4h"}get _Vec2(){return bo}get _Vec3(){return zo}get _Vec4(){return lc}},Io=class cc extends Ks{get[E](){return{elementSchema:Ae}}get kind(){return"vec4i"}get _Vec2(){return To}get _Vec3(){return Eo}get _Vec4(){return cc}},Bo=class hc extends Ks{get[E](){return{elementSchema:J}}get kind(){return"vec4u"}get _Vec2(){return _o}get _Vec3(){return So}get _Vec4(){return hc}},ko=class pc extends Ks{get[E](){return{elementSchema:ke}}get kind(){return"vec4<bool>"}get _Vec2(){return $o}get _Vec3(){return Po}get _Vec4(){return pc}},G=Yt(vo,$),Un=Yt(bo,ut),Be=Yt(To,Ae),xt=Yt(_o,J),br=Yt($o,ke),O=Yt(Mo,$),An=Yt(zo,ut),Ot=Yt(Eo,Ae),rt=Yt(So,J),Tr=Yt(Po,ke),k=Yt(Uo,$),In=Yt(Ao,ut),Le=Yt(Io,Ae),Ce=Yt(Bo,J),_r=Yt(ko,ke),Di={vec2f:G,vec2h:Un,vec2i:Be,vec2u:xt,"vec2<bool>":br,vec3f:O,vec3h:An,vec3i:Ot,vec3u:rt,"vec3<bool>":Tr,vec4f:k,vec4h:In,vec4i:Le,vec4u:Ce,"vec4<bool>":_r};function Yt(e,t){let{kind:n,length:r}=new e,s=D({name:n,signature:(...p)=>({argTypes:p.map(y=>{let v=mr(y);return rr(v)?v:t}),returnType:i}),normalImpl:(...p)=>{let y=new Array(p.length),v=0;for(let _ of p)if(typeof _=="number"||typeof _=="boolean")y[v++]=_;else for(let P=0;P<_.length;++P)y[v++]=_[P];if(y.length<=1||y.length===r)return new e(...y);throw new Error(`'${n}' constructor called with invalid number of arguments.`)},ignoreImplicitCastWarning:!0,codegenImpl:(...p)=>S`${n}(${p})`}),i=Object.assign(s,{type:n,primitive:t,[fs]:void 0});return i}var fe=class{constructor(t){this.type=t}[E]=!0},ar={uint8:J,uint8x2:xt,uint8x4:Ce,sint8:Ae,sint8x2:Be,sint8x4:Le,unorm8:$,unorm8x2:G,unorm8x4:k,snorm8:$,snorm8x2:G,snorm8x4:k,uint16:J,uint16x2:xt,uint16x4:Ce,sint16:Ae,sint16x2:Be,sint16x4:Le,unorm16:$,unorm16x2:G,unorm16x4:k,snorm16:$,snorm16x2:G,snorm16x4:k,float16:$,float16x2:G,float16x4:k,float32:$,float32x2:G,float32x3:O,float32x4:k,uint32:J,uint32x2:xt,uint32x3:rt,uint32x4:Ce,sint32:Ae,sint32x2:Be,sint32x3:Ot,sint32x4:Le,"unorm10-10-10-2":k,"unorm8x4-bgra":k},Oo=new Set(Object.keys(ar)),Kp=new fe("uint8"),ed=new fe("uint8x2"),td=new fe("uint8x4"),nd=new fe("sint8"),rd=new fe("sint8x2"),sd=new fe("sint8x4"),id=new fe("unorm8"),ad=new fe("unorm8x2"),od=new fe("unorm8x4"),ud=new fe("snorm8"),ld=new fe("snorm8x2"),cd=new fe("snorm8x4"),hd=new fe("uint16"),pd=new fe("uint16x2"),dd=new fe("uint16x4"),fd=new fe("sint16"),md=new fe("sint16x2"),yd=new fe("sint16x4"),gd=new fe("unorm16"),wd=new fe("unorm16x2"),xd=new fe("unorm16x4"),vd=new fe("snorm16"),bd=new fe("snorm16x2"),Td=new fe("snorm16x4"),_d=new fe("float16"),$d=new fe("float16x2"),Md=new fe("float16x4"),zd=new fe("float32"),Ed=new fe("float32x2"),Sd=new fe("float32x3"),Pd=new fe("float32x4"),Ud=new fe("uint32"),Ad=new fe("uint32x2"),Id=new fe("uint32x3"),Bd=new fe("uint32x4"),kd=new fe("sint32"),Od=new fe("sint32x2"),Vd=new fe("sint32x3"),Gd=new fe("sint32x4"),Dd=new fe("unorm10-10-10-2"),Rd=new fe("unorm8x4-bgra");function dc(e){return Ge(e)&&Oo.has(e?.type)}function Jt(e){let t=String(e);if(t!=="[object Object]")return t;try{return JSON.stringify(e)}catch(n){return console.error("Error parsing JSON:",n),"<invalid json>"}}function Ga(e){return Ze(e)||jn(e)?e.toString():Array.isArray(e)?`[${e.map(Ga).join(", ")}]`:e&&typeof e=="object"?`{ ${Object.entries(e).map(([t,n])=>`${t}: ${Ga(n)}`).join(", ")} }`:String(e)}var Nd={f32:4,f16:2,i32:4,u32:4,bool:4,u16:2,vec2f:8,vec2h:4,vec2i:8,vec2u:8,vec2b:8,vec3f:16,vec3h:8,vec3i:16,vec3u:16,vec3b:16,vec4f:16,vec4h:8,vec4i:16,vec4u:16,vec4b:16,mat2x2f:8,mat3x3f:16,mat4x4f:16,atomic:4};function Fd(e){let t=e?.type,n=Nd[t];if(n!==void 0)return n;if(vt(e))return Object.values(e.propTypes).map(tt).reduce((r,s)=>r>s?r:s);if(Lt(e))return tt(e.elementType);if(En(e)){let r=Object.values(e.propTypes)[0];return r?Us(r)??1:1}if(ir(e))return Us(e.elementType)??1;if(zn(e)||Sn(e))return Us(e)??tt(e.inner);if(Oo.has(t))return 1;throw new Error(`Cannot determine alignment of data: ${Jt(e)}`)}function Ld(e){if(En(e)){let t=Object.values(e.propTypes)[0];return t?wn(t):1}return ir(e)?wn(e.elementType):Sn(e)?Us(e)??wn(e.inner):Us(e)??1}var hu=new WeakMap,pu=new WeakMap;function tt(e){let t=hu.get(e);return t===void 0&&(t=Fd(e),hu.set(e,t)),t}function wn(e){let t=pu.get(e);return t===void 0&&(t=Ld(e),pu.set(e,t)),t}function jd(e){return tt(e)}var sn=(e,t)=>{let n=t-1,r=~n;return(e&n)===0?e:(e&r)+t},Yd={bool:4,f32:4,f16:2,i32:4,u32:4,u16:2,vec2f:8,vec2h:4,vec2i:8,vec2u:8,"vec2<bool>":8,vec3f:12,vec3h:6,vec3i:12,vec3u:12,"vec3<bool>":12,vec4f:16,vec4h:8,vec4i:16,vec4u:16,"vec4<bool>":16,mat2x2f:16,mat3x3f:48,mat4x4f:64,uint8:1,uint8x2:2,uint8x4:4,sint8:1,sint8x2:2,sint8x4:4,unorm8:1,unorm8x2:2,unorm8x4:4,snorm8:1,snorm8x2:2,snorm8x4:4,uint16:2,uint16x2:4,uint16x4:8,sint16:2,sint16x2:4,sint16x4:8,unorm16:2,unorm16x2:4,unorm16x4:8,snorm16:2,snorm16x2:4,snorm16x4:8,float16:2,float16x2:4,float16x4:8,float32:4,float32x2:8,float32x3:12,float32x4:16,uint32:4,uint32x2:8,uint32x3:12,uint32x4:16,sint32:4,sint32x2:8,sint32x3:12,sint32x4:16,"unorm10-10-10-2":4,"unorm8x4-bgra":4,atomic:4};function Cd(e){let t=0,n=e.propTypes;for(let r of Object.values(n)){if(Number.isNaN(t))throw new Error("Only the last property of a struct can be unbounded");if(t=sn(t,tt(r)),t+=Me(r),Number.isNaN(t)&&r.type!=="array")throw new Error("Cannot nest unbounded struct within another struct")}return sn(t,tt(e))}function qd(e){let t=0,n=e.propTypes;for(let r of Object.values(n)){let s=wn(r);t=sn(t,s),t+=Me(r)}return t}function Wd(e){let t=Yd[e?.type];if(t!==void 0)return t;if(vt(e))return Cd(e);if(En(e))return qd(e);if(Lt(e)){if(e.elementCount===0)return Number.NaN;let n=tt(e.elementType);return sn(Me(e.elementType),n)*e.elementCount}if(ir(e)){let n=wn(e.elementType);return sn(Me(e.elementType),n)*e.elementCount}if(zn(e)||Sn(e))return Sp(e)??Me(e.inner);throw new Error(`Cannot determine size of data: ${e}`)}var du=new WeakMap;function Me(e){let t=du.get(e);return t===void 0&&(t=Wd(e),du.set(e,t)),t}function Xd(e){return Me(e)}function ys(e,t){return zn(e)?new fu(e.inner,[t,...e.attribs]):Sn(e)?new mu(e.inner,[t,...e.attribs]):ms(e)?new mu(e,[t]):new fu(e,[t])}function Jd(e,t){return ys(t,{[E]:!0,type:"@align",params:[e]})}function Zd(e,t){return ys(t,{[E]:!0,type:"@size",params:[e]})}function Ri(e,t){return ys(t,{[E]:!0,type:"@location",params:[e]})}function Hd(e,t){return ys(t,{[E]:!0,type:"@interpolate",params:[e]})}function Qd(e){if(!Nr(e))throw new Error("The @invariant attribute must only be applied to the position built-in value.");let t=zn(e)||Sn(e)?e.attribs.find(po):void 0;if(!t||t.params[0]!=="position")throw new Error("The @invariant attribute must only be applied to the position built-in value.");return ys(e,{[E]:!0,type:"@invariant",params:[]})}function Nr(e){return(zn(e)||Sn(e))&&e.attribs.find(po)!==void 0}function Vo(e){return!zn(e)&&!Sn(e)?"":e.attribs.map(t=>t.params.length===0?`${t.type} `:`${t.type}(${t.params.join(", ")}) `).join("")}var fc=class{constructor(t,n){this.inner=t,this.attribs=n;let r=n.find(co)?.params[0],s=n.find(ho)?.params[0];if(r!==void 0){if(r<=0)throw new Error(`Custom data alignment must be a positive number, got: ${r}.`);if(Math.log2(r)%1!==0)throw new Error(`Alignment has to be a power of 2, got: ${r}.`);if(zt(this.inner)&&r%tt(this.inner)!==0)throw new Error(`Custom alignment has to be a multiple of the standard data alignment. Got: ${r}, expected multiple of: ${tt(this.inner)}.`)}if(s!==void 0){if(s<Me(this.inner))throw new Error(`Custom data size cannot be smaller then the standard data size. Got: ${s}, expected at least: ${Me(this.inner)}.`);if(s<=0)throw new Error(`Custom data size must be a positive number. Got: ${s}.`)}}[E]=!0},fu=class extends fc{[E]=!0;type="decorated"},mu=class extends fc{[E]=!0;type="loose-decorated"};function kr(e,t){let n=e?.type,r=n in ar?ar[n]:e;return typeof r!="function"?t:t===void 0?r():r(t)}function Wn(e){return mc(e,!1)}function wt(e){return mc(e,!0)}function mc(e,t){let n=r=>Object.fromEntries(Object.entries(e).map(([s,i])=>[s,kr(i,r?.[s])]));return Object.setPrototypeOf(n,Kd),n.propTypes=e,Object.defineProperty(n,E,{value:{isAbstruct:t}}),n}var Kd={type:"struct",$name(e){return Fe(this,e),this},toString(){return`struct:${W(this)??"<unnamed>"}`}},Cn=ce(((e,t)=>t===void 0?n=>fa(e,n):fa(e,t)),(e,t)=>{if(t?.value===void 0){let n=r=>Cn[E].gpuImpl(e,r);return n[E]=!0,B(n,kt)}if(typeof t.value!="number")throw new Error(`Cannot create array schema with count unknown at compile-time: '${t.value}'`);return B(fa(e.value,t.value),e.value)},"arrayOf");function fa(e,t){let n=r=>{if(r&&r.length!==t)throw new Error(`Array schema of ${t} elements of type ${e.type} called with ${r.length} argument(s).`);return Array.from({length:t},(s,i)=>kr(e,r?.[i]))};if(Object.setPrototypeOf(n,ef),Number.isNaN(Me(e)))throw new Error("Cannot nest runtime sized arrays.");if(n.elementType=e,!Number.isInteger(t)||t<0)throw new Error(`Cannot create array schema with invalid element count: ${t}.`);return n.elementCount=t,n}var ef={[E]:!0,type:"array",toString(){return`arrayOf(${this.elementType}, ${this.elementCount})`}};function Nt(e,t){return ys(e,{[E]:!0,type:"@builtin",params:[t]})}var Fs={vertexIndex:Nt(J,"vertex_index"),instanceIndex:Nt(J,"instance_index"),position:Nt(k,"position"),clipDistances:Nt(Cn(J,8),"clip_distances"),frontFacing:Nt(ke,"front_facing"),fragDepth:Nt($,"frag_depth"),sampleIndex:Nt(J,"sample_index"),sampleMask:Nt(J,"sample_mask"),localInvocationId:Nt(rt,"local_invocation_id"),localInvocationIndex:Nt(J,"local_invocation_index"),globalInvocationId:Nt(rt,"global_invocation_id"),workgroupId:Nt(rt,"workgroup_id"),numWorkgroups:Nt(rt,"num_workgroups"),subgroupInvocationId:Nt(J,"subgroup_invocation_id"),subgroupSize:Nt(J,"subgroup_size")},tf={block:0,binaryExpr:1,assignmentExpr:2,logicalExpr:3,unaryExpr:4,numericLiteral:5,call:6,memberAccess:7,indexAccess:8,return:10,if:11,let:12,const:13,for:14,while:15,continue:16,break:17,arrayExpr:100,preUpdate:101,postUpdate:102,stringLiteral:103,objectExpr:104},Da={identifier:"i",destructuredObject:"d"},nf=1;const rf=Object.freeze(Object.defineProperty({__proto__:null,FORMAT_VERSION:nf,FuncParameterType:Da,NodeTypeCatalog:tf},Symbol.toStringTag,{value:"Module"}));function Is(e,t){for(let[n,r]of Object.entries(t))e[n]=r,r&&(typeof r=="object"||typeof r=="function")&&W(r)===void 0&&Fe(r,n)}function sf(e,t,n){let r=[...e.matchAll(/:\s*(?<arg>.*?)\s*[,)]/g)].map(s=>s?s[1]:void 0);n(Object.fromEntries(t.flatMap((s,i)=>{let p=r?r[i]:void 0;return vt(s)&&p!==void 0?[[p,s]]:[]})))}function yc(e,t,n){let r=e.match(/->\s(?<output>[\w\d_]+)\s{/),s=r?r[1]?.trim():void 0;vt(t)&&s&&!/\s/g.test(s)&&n({[s]:t})}function af(e){return new RegExp(`(?<![\\w\\$_.])${e.replaceAll(".","\\.").replaceAll("$","\\$")}(?![\\w\\$_])`,"g")}function ta(e,t,n){return Object.entries(t).reduce((r,[s,i])=>{let p=af(s);if(n&&s!=="Out"&&s!=="In"&&!p.test(n)&&console.warn(`The external '${s}' wasn't used in the resolved template.`),Op(i)||ms(i)||Ps(i))return r.replaceAll(p,e.resolve(i).value);if(i!==null&&typeof i=="object"){let y=[...n.matchAll(new RegExp(`${s.replaceAll(".","\\.").replaceAll("$","\\$")}\\.(?<prop>.*?)(?![\\w\\$_])`,"g"))].map(v=>v[1]);return[...new Set(y)].reduce((v,_)=>_&&_ in i?ta(e,{[`${s}.${_}`]:i[_]},v):v,r)}return console.warn(`During resolution, the external '${s}' has been omitted. Only primitives, TGPU resources and plain JS objects can be used as externals.`),r},n)}function of(e){let{strippedCode:t,argRange:n}=uf(e),r=new gc(t);r.consume("(");let s=[];for(;!r.isAt(")");){let p=[];for(;r.isAt("@");)r.parseUntil(yu,gu),r.consume(")"),p.push(r.lastParsed);r.parseUntil(cf);let y=r.lastParsed,v;r.isAt(":")&&(r.consume(":"),r.parseUntil(hf,df),v=r.lastParsed),s.push({identifier:y,attributes:p,type:v}),r.isAt(",")&&r.consume(",")}r.consume(")");let i;if(r.isAt("->")){r.consume("->");let p=[];for(;r.isAt("@");)r.parseUntil(yu,gu),r.consume(")"),p.push(r.lastParsed);i={type:r.str.slice(r.pos),attributes:p}}return{args:s,ret:i,range:{begin:n[0],end:n[1]}}}function uf(e){let t=new gc(e),n="",r;for(;!t.isFinished();){if(t.isAt(lf)){t.advanceBy(1);continue}if(t.isAt("//")){t.consume("//"),t.parseUntil(wc),t.advanceBy(1);continue}if(t.isAt("/*")){t.parseUntil(pf,ff),t.consume("*/");continue}if(t.isAt("{"))return{strippedCode:n,argRange:[r,t.pos]};t.isAt("(")&&r===void 0&&(r=t.pos),r!==void 0&&(n+=t.str[t.pos]),t.advanceBy(1)}throw new Error("Invalid wgsl code!")}var gc=class{constructor(t){this.str=t,this.#t=0}#e;#t;get pos(){return this.#t}get lastParsed(){if(this.#e===void 0)throw new Error("Parse was not called yet!");return this.str.slice(this.#e,this.pos)}isFinished(){return this.#t>=this.str.length}isAt(t){if(typeof t=="string"){for(let n=0;n<t.length;n++)if(this.str[this.#t+n]!==t[n])return!1;return!0}for(let n of t)if(this.isAt(n))return!0;return!1}parseUntil(t,n){this.#e=this.#t;let r=0;for(;this.#t<this.str.length;){if(n&&this.isAt(n[0])&&(r+=1),n&&this.isAt(n[1])&&(r-=1),r===0&&this.isAt(t))return this.#t;this.#t+=1}throw new Error("Reached the end of the string without finding a match!")}advanceBy(t){this.#t+=t}consume(t){if(!this.isAt(t))throw new Error(`Expected '${t}' at position ${this.#t}, but found '${this.str.slice(this.#t,this.#t+t.length)}'`);this.advanceBy(t.length)}},wc=new Set([`
`,"\v","\f","\r","","\u2028","\u2029"]),lf=new Set([...wc," ","	","",""]),yu=new Set([")"]),cf=new Set([":",",",")"]),hf=new Set([",",")"]),pf=new Set(["*/"]),gu=["(",")"],df=["<",">"],ff=["/*","*/"];function ei(e,t=""){let n=[],r={applyExternals(i){n.push(i)},resolve(i,p,y){let v={};for(let oe of n)Is(v,oe);let _=i.getUniqueName(this);if(typeof e=="string"){if(!y)throw new Error("Explicit return type is required for string implementation");let oe=ta(i,v,e),_e="",Ee="";if(t!==""){let Pe=vt(p[0])?`(in: ${i.resolve(p[0]).value})`:"()",Ue=zt(y)?Vo(y):"",yt=y!==at?vt(y)?`-> ${i.resolve(y).value}`:`-> ${Ue!==""?Ue:"@location(0)"} ${i.resolve(y).value}`:"";_e=`${Pe} ${yt} `,Ee=oe}else{let Pe=of(oe);if(Pe.args.length!==p.length)throw new Error(`WGSL implementation has ${Pe.args.length} arguments, while the shell has ${p.length} arguments.`);let Ue=Pe.args.map((ht,it)=>`${ht.identifier}: ${wu(i,`parameter ${ht.identifier}`,ht.type,p[it])}`).join(", "),yt=y===at?"":`-> ${wu(i,"return type",Pe.ret?.type,y)}`;_e=`(${Ue}) ${yt}`,Ee=oe.slice(Pe.range.end)}return i.addDeclaration(`${t}fn ${_}${_e}${Ee}`),B(_,y)}let P=Ki(e);if(P?.externals){let oe=Object.fromEntries(Object.entries(P.externals).filter(([_e])=>!(_e in v)));Is(v,oe)}let U=P?.ast;if(!U)throw new Error("Missing metadata for tgpu.fn function body (either missing 'use gpu' directive, or misconfigured `unplugin-typegpu`)");let N=U.externalNames.filter(oe=>!(oe in v));if(N.length>0)throw new Ip(W(this),N);let j=U.params[1];j&&j.type==="i"&&t!==""&&Is(v,{[j.name]:mr(y)});let L=[],Z=[];for(let[oe,_e]of p.entries()){let Ee=U.params[oe];switch(Ee?.type){case Da.identifier:{let Pe=Ee.name,Ue=B(i.makeNameValid(Pe),_e);L.push(Ue),Ue.value!==Pe&&Z.push([Pe,Ue]);break}case Da.destructuredObject:{L.push(B(`_arg_${oe}`,_e)),Z.push(...Ee.props.map(({name:Pe,alias:Ue})=>[Ue,B(`_arg_${oe}.${Pe}`,p[oe].propTypes[Pe])]));break}case void 0:L.push(B(`_arg_${oe}`,_e))}}let{head:Q,body:se,returnType:ze}=i.fnToWgsl({args:L,argAliases:Object.fromEntries(Z),returnType:y,body:U.body,externalMap:v});return i.addDeclaration(`${t}fn ${_}${i.resolve(Q).value}${i.resolve(se).value}`),B(_,ze)}},s=W(e);return s!==void 0&&Fe(r,s),r}function wu(e,t,n,r){let s=e.resolve(r).value.replace(/\s/g,"");if(!n)return s;let i=n.replace(/\s/g,"");if(i!==s)throw new Error(`Type mismatch between TGPU shell and WGSL code string: ${t}, JS type "${s}", WGSL type "${i}".`);return n}function mf(e,t={}){let n=0,r=new Set;return Object.fromEntries(Object.entries(e??{}).map(([s,i])=>{let p=yr(i);if(p!==void 0){if(r.has(p))throw new Error("Duplicate custom location attributes found");r.add(p)}return[s,i]}).map(([s,i])=>{if(Nr(i))return[s,i];if(yr(i)!==void 0)return[s,i];if(t[s])return[s,Ri(t[s],i)];for(;r.has(n);)n++;return[s,Ri(n++,i)]}))}function ti(e,t={}){return Dr(e)?kl(e)||yr(e)!==void 0?e:Ri(0,e):Wn(mf(e,t))}function na(e,...t){return yf(e)?gf(e,...t):e}function yf(e){return Array.isArray(e)&&"raw"in e&&Array.isArray(e.raw)&&e.raw.every(t=>typeof t=="string")}function gf(e,...t){return e.slice(1).reduce((n,r,s)=>`${n}${t[s]}${r}`,e[0])}function xc(e){if(Object.keys(e.out).length===0)throw new Error("A vertexFn output cannot be empty since it must include the 'position' builtin.");let t={in:e.in,out:e.out,argTypes:e.in&&Object.keys(e.in).length!==0?[ti(e.in)]:[],isEntry:!0},n=(r,...s)=>wf(t,na(r,...s));return Object.assign(Object.assign(n,t),{does:n})}function wf(e,t){let n=ei(t,"@vertex "),r=e.argTypes[0];return{shell:e,$uses(s){return n.applyExternals(s),this},[E]:!0,[st]:n,$name(s){return Fe(n,s),Qi(r)&&r.$name(`${s}_Input`),this},[he](s){let i=ti(e.out,s.varyingLocations).$name(`${W(this)??""}_Output`);return typeof t=="string"&&(r&&n.applyExternals({In:r}),n.applyExternals({Out:i})),n.resolve(s,e.argTypes,i)},toString(){return`vertexFn:${W(n)??"<unnamed>"}`}}}var gs=class{};function Go(e){let t=ce((...r)=>{let s=[];for(let i of r)if(typeof i=="number")s.push(i);else for(let p=0;p<i.length;++p)s.push(i[p]);if(s.length!==0&&s.length!==e.columns*e.rows)throw new Error(`'${e.type}' constructor called with invalid number of arguments.`);for(let i=s.length;i<e.columns*e.rows;++i)s.push(0);return new e.MatImpl(...s)},(...r)=>B(S`${e.type}(${r})`,n),e.type),n=Object.assign(t,{type:e.type,identity:Mf[e.columns],translation:e.columns===4?ra:void 0,scaling:e.columns===4?sa:void 0,rotationX:e.columns===4?ia:void 0,rotationY:e.columns===4?aa:void 0,rotationZ:e.columns===4?oa:void 0});return n}var xf=class extends gs{[E]=!0;columns;length=4;constructor(...t){super(),this.columns=[this.makeColumn(t[0],t[1]),this.makeColumn(t[2],t[3])]}get 0(){return this.columns[0].x}get 1(){return this.columns[0].y}get 2(){return this.columns[1].x}get 3(){return this.columns[1].y}set 0(t){this.columns[0].x=t}set 1(t){this.columns[0].y=t}set 2(t){this.columns[1].x=t}set 3(t){this.columns[1].y=t}*[Symbol.iterator](){yield this[0],yield this[1],yield this[2],yield this[3]}[he](){return B(`${this.kind}(${Array.from({length:this.length}).map((t,n)=>this[n]).join(", ")})`,xn)}toString(){return this[he]().value}},vf=class extends xf{kind="mat2x2f";makeColumn(t,n){return G(t,n)}},bf=class extends gs{[E]=!0;columns;length=12;constructor(...t){super(),this.columns=[this.makeColumn(t[0],t[1],t[2]),this.makeColumn(t[3],t[4],t[5]),this.makeColumn(t[6],t[7],t[8])]}get 0(){return this.columns[0].x}get 1(){return this.columns[0].y}get 2(){return this.columns[0].z}get 3(){return 0}get 4(){return this.columns[1].x}get 5(){return this.columns[1].y}get 6(){return this.columns[1].z}get 7(){return 0}get 8(){return this.columns[2].x}get 9(){return this.columns[2].y}get 10(){return this.columns[2].z}get 11(){return 0}set 0(t){this.columns[0].x=t}set 1(t){this.columns[0].y=t}set 2(t){this.columns[0].z=t}set 3(t){}set 4(t){this.columns[1].x=t}set 5(t){this.columns[1].y=t}set 6(t){this.columns[1].z=t}set 7(t){}set 8(t){this.columns[2].x=t}set 9(t){this.columns[2].y=t}set 10(t){this.columns[2].z=t}set 11(t){}*[Symbol.iterator](){for(let t=0;t<12;t++)yield this[t]}[he](){return B(`${this.kind}(${this[0]}, ${this[1]}, ${this[2]}, ${this[4]}, ${this[5]}, ${this[6]}, ${this[8]}, ${this[9]}, ${this[10]})`,Bn)}toString(){return this[he]().value}},Tf=class extends bf{kind="mat3x3f";makeColumn(t,n,r){return O(t,n,r)}},_f=class extends gs{[E]=!0;columns;constructor(...t){super(),this.columns=[this.makeColumn(t[0],t[1],t[2],t[3]),this.makeColumn(t[4],t[5],t[6],t[7]),this.makeColumn(t[8],t[9],t[10],t[11]),this.makeColumn(t[12],t[13],t[14],t[15])]}length=16;get 0(){return this.columns[0].x}get 1(){return this.columns[0].y}get 2(){return this.columns[0].z}get 3(){return this.columns[0].w}get 4(){return this.columns[1].x}get 5(){return this.columns[1].y}get 6(){return this.columns[1].z}get 7(){return this.columns[1].w}get 8(){return this.columns[2].x}get 9(){return this.columns[2].y}get 10(){return this.columns[2].z}get 11(){return this.columns[2].w}get 12(){return this.columns[3].x}get 13(){return this.columns[3].y}get 14(){return this.columns[3].z}get 15(){return this.columns[3].w}set 0(t){this.columns[0].x=t}set 1(t){this.columns[0].y=t}set 2(t){this.columns[0].z=t}set 3(t){this.columns[0].w=t}set 4(t){this.columns[1].x=t}set 5(t){this.columns[1].y=t}set 6(t){this.columns[1].z=t}set 7(t){this.columns[1].w=t}set 8(t){this.columns[2].x=t}set 9(t){this.columns[2].y=t}set 10(t){this.columns[2].z=t}set 11(t){this.columns[2].w=t}set 12(t){this.columns[3].x=t}set 13(t){this.columns[3].y=t}set 14(t){this.columns[3].z=t}set 15(t){this.columns[3].w=t}*[Symbol.iterator](){for(let t=0;t<16;t++)yield this[t]}[he](){return B(`${this.kind}(${Array.from({length:this.length}).map((t,n)=>this[n]).join(", ")})`,ve)}toString(){return this[he]().value}},$f=class extends _f{kind="mat4x4f";makeColumn(t,n,r,s){return k(t,n,r,s)}},vc=ce(()=>xn(1,0,0,1),()=>B("mat2x2f(1, 0, 0, 1)",xn),"identity2"),bc=ce(()=>Bn(1,0,0,0,1,0,0,0,1),()=>B("mat3x3f(1, 0, 0, 0, 1, 0, 0, 0, 1)",Bn),"identity3"),Tc=ce(()=>ve(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),()=>B("mat4x4f(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",ve),"identity4"),Mf={2:vc,3:bc,4:Tc},ra=ce(e=>ve(1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1),e=>B(S`mat4x4f(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, ${e}.x, ${e}.y, ${e}.z, 1)`,ve),"translation4"),sa=ce(e=>ve(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1),e=>B(S`mat4x4f(${e}.x, 0, 0, 0, 0, ${e}.y, 0, 0, 0, 0, ${e}.z, 0, 0, 0, 0, 1)`,ve),"scaling4"),ia=ce(e=>ve(1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1),e=>B(S`mat4x4f(1, 0, 0, 0, 0, cos(${e}), sin(${e}), 0, 0, -sin(${e}), cos(${e}), 0, 0, 0, 0, 1)`,ve),"rotationX4"),aa=ce(e=>ve(Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1),e=>B(S`mat4x4f(cos(${e}), 0, -sin(${e}), 0, 0, 1, 0, 0, sin(${e}), 0, cos(${e}), 0, 0, 0, 0, 1)`,ve),"rotationY4"),oa=ce(e=>ve(Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1,0,0,0,0,1),e=>B(S`mat4x4f(cos(${e}), sin(${e}), 0, 0, -sin(${e}), cos(${e}), 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)`,ve),"rotationZ4"),xn=Go({type:"mat2x2f",rows:2,columns:2,MatImpl:vf}),Bn=Go({type:"mat3x3f",rows:3,columns:3,MatImpl:Tf}),ve=Go({type:"mat4x4f",rows:4,columns:4,MatImpl:$f});function zf(e){return e.kind==="mat3x3f"?[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]]:Array.from({length:e.length}).map((t,n)=>e[n])}function Ef(e){return e?.[Ne]}var Sf={f:{1:$,2:G,3:O,4:k},h:{1:ut,2:Un,3:An,4:In},i:{1:Ae,2:Be,3:Ot,4:Le},u:{1:J,2:xt,3:rt,4:Ce},b:{1:ke,2:br,3:Tr,4:_r}},Pf={vec2f:G,vec2h:Un,vec2i:Be,vec2u:xt,"vec2<bool>":br,vec3f:O,vec3h:An,vec3i:Ot,vec3u:rt,"vec3<bool>":Tr,vec4f:k,vec4h:In,vec4i:Le,vec4u:Ce,"vec4<bool>":_r,mat2x2f:xn,mat3x3f:Bn,mat4x4f:ve};function Ra(e,t){if(vt(e)||En(e))return e.propTypes[t]??kt;if(e===ke||sr(e))return kt;let n=t.length;if(rr(e)&&n>=1&&n<=4){let r=e.type.includes("bool")?"b":e.type[4],s=Sf[r][n];if(s)return s}return kt}var xu={mat2x2f:G,mat3x3f:O,mat4x4f:k};function ma(e){return Lt(e)||ir(e)?e.elementType:rr(e)?e.primitive:e.type in xu?xu[e.type]:kt}function Ni(e){return e>=2**63||e<-9223372036854776e3?B(e,Pn):Number.isInteger(e)?(Number.isSafeInteger(e)||console.warn(`The integer ${e} exceeds the safe integer range and may have lost precision.`),B(e,Zs)):B(e,Pn)}function Ls(e){return e.type==="abstractFloat"?$:e.type==="abstractInt"?Ae:e}function Uf(e){return e.map(t=>B(t.value,Ls(t.dataType)))}function zi(e){return yo(e)?e:go(e)||(Ze(e)||jn(e)?B(e,Pf[e.kind]):typeof e=="string"||typeof e=="function"||typeof e=="object"||typeof e=="symbol"||typeof e>"u"||e===null?B(e,kt):typeof e=="number"?Ni(e):typeof e=="boolean"?B(e,ke):B(e,kt))}var On={get(e,t){if(t in e)return Reflect.get(e,t);if(t==="toString"||t===Symbol.toStringTag||t===Symbol.toPrimitive)return()=>e.toString();if(typeof t=="symbol")return;let n=go(e).dataType,r=Ra(n,String(t));if(r.type!=="unknown")return new Proxy({[E]:!0,[he]:s=>B(`${s.resolve(e).value}.${String(t)}`,r),get[Xt](){return B(this,r)},toString:()=>`${String(e)}.${t}`},On)}};function ua(e){let t=e;for(;;){let n=Ef(t);if(!n)break;t=n}return t}function Na(e,t){return new Af(e,t)}var Af=class{constructor(t,n){this.dataType=t,this.#e=n}[E]={};#e;$name(t){return Fe(this,t),this}[he](t){let n=t.getUniqueName(this),r=t.resolve(this.dataType).value,s=t.resolve(this.#e,this.dataType).value;return t.addDeclaration(`const ${n}: ${r} = ${s};`),B(n,this.dataType)}toString(){return`const:${W(this)??"<unnamed>"}`}get[Ne](){let t=this.dataType;return new Proxy({[E]:!0,get[Xt](){return B(this,t)},[he]:n=>n.resolve(this),toString:()=>`const:${W(this)??"<unnamed>"}.$`},On)}get value(){return kn()?this[Ne]:this.#e}get $(){return this.value}};function Do(){return{[E]:!0,type:"sampler",[fs]:void 0}}function Ro(){return{[E]:!0,type:"sampler_comparison",[fs]:void 0}}function If(e){return!!e[E]&&e.type==="sampler"}function Bf(e){return!!e[E]&&e.type==="sampler_comparison"}function Fa(e){if("multisampled"in e){if(e.multisampled){if(e.dimension==="2d")return $c(e.sampleType);throw new Error(`Multisampled textures only support '2d' dimension, got '${e.dimension}'`)}switch(e.dimension){case"1d":return _c(e.sampleType);case"2d":return ps(e.sampleType);case"2d-array":return Mc(e.sampleType);case"3d":return Sc(e.sampleType);case"cube":return zc(e.sampleType);case"cube-array":return Ec(e.sampleType);default:throw new Error(`Unsupported texture dimension: '${e.dimension}'`)}}if(!("access"in e))throw new Error("Descriptor is neither a sampled nor a storage texture");switch(e.dimension){case"1d":return Pc(e.format,e.access);case"2d":return ri(e.format,e.access);case"2d-array":return Uc(e.format,e.access);case"3d":return Ac(e.format,e.access);default:throw new Error(`Unsupported storage texture dimension: '${e.dimension}'`)}}function vn(e,t){let n=e.startsWith("texture_depth")?["depth","float","unfilterable-float"]:t.sampleType.type==="i32"?["sint"]:t.sampleType.type==="u32"?["uint"]:["float","unfilterable-float"];return{[E]:!0,[fs]:void 0,type:e,bindingSampleType:n,...t}}function la(e,t){return{[E]:!0,[fs]:void 0,type:e,...t}}var vu=new Map,ni={"write-only":"write","read-only":"read","read-write":"read_write"};function Et(e,t){let n=vu.get(e);return n||(n=t(),vu.set(e,n)),n}function _c(e){let t=e||$,n=`texture_1d<${t.type}>`;return Et(n,()=>vn("texture_1d",{dimension:"1d",sampleType:t,multisampled:!1}))}function ps(e){let t=e||$,n=`texture_2d<${t.type}>`;return Et(n,()=>vn("texture_2d",{dimension:"2d",sampleType:t,multisampled:!1}))}function $c(e){let t=e||$,n=`texture_multisampled_2d<${t.type}>`;return Et(n,()=>vn("texture_multisampled_2d",{dimension:"2d",sampleType:t,multisampled:!0}))}function Mc(e){let t=e||$,n=`texture_2d_array<${t.type}>`;return Et(n,()=>vn("texture_2d_array",{dimension:"2d-array",sampleType:t,multisampled:!1}))}function zc(e){let t=e||$,n=`texture_cube<${t.type}>`;return Et(n,()=>vn("texture_cube",{dimension:"cube",sampleType:t,multisampled:!1}))}function Ec(e){let t=e||$,n=`texture_cube_array<${t.type}>`;return Et(n,()=>vn("texture_cube_array",{dimension:"cube-array",sampleType:t,multisampled:!1}))}function Sc(e){let t=e||$,n=`texture_3d<${t.type}>`;return Et(n,()=>vn("texture_3d",{dimension:"3d",sampleType:t,multisampled:!1}))}function Pc(e,t){let n=t||"write-only",r=`texture_storage_1d<${e}, ${ni[n]}>`;return Et(r,()=>la("texture_storage_1d",{dimension:"1d",format:e,access:n}))}function ri(e,t){let n=t||"write-only",r=`texture_storage_2d<${e}, ${ni[n]}>`;return Et(r,()=>la("texture_storage_2d",{dimension:"2d",format:e,access:n}))}function Uc(e,t){let n=t||"write-only",r=`texture_storage_2d_array<${e}, ${ni[n]}>`;return Et(r,()=>la("texture_storage_2d_array",{dimension:"2d-array",format:e,access:n}))}function Ac(e,t){let n=t||"write-only",r=`texture_storage_3d<${e}, ${ni[n]}>`;return Et(r,()=>la("texture_storage_3d",{dimension:"3d",format:e,access:n}))}function kf(){return Et("texture_depth_2d",()=>vn("texture_depth_2d",{dimension:"2d",sampleType:$,multisampled:!1}))}function Of(){return Et("texture_depth_multisampled_2d",()=>vn("texture_depth_multisampled_2d",{dimension:"2d",sampleType:$,multisampled:!0}))}function Vf(){return Et("texture_depth_2d_array",()=>vn("texture_depth_2d_array",{dimension:"2d-array",sampleType:$,multisampled:!1}))}function Gf(){return Et("texture_depth_cube",()=>vn("texture_depth_cube",{dimension:"cube",sampleType:$,multisampled:!1}))}function Df(){return Et("texture_depth_cube_array",()=>vn("texture_depth_cube_array",{dimension:"cube-array",sampleType:$,multisampled:!1}))}function Ic(){return Et("texture_external",()=>({[E]:!0,[fs]:void 0,type:"texture_external",dimension:"2d"}))}function Bc(e){return!!e[E]&&typeof e.multisampled=="boolean"}function La(e){return!!e[E]&&typeof e.format=="string"&&typeof e.access=="string"}function kc(e){return new Rf(e)}var Rf=class{constructor(t){this.inner=t}[E]=!0;type="atomic"},Er=(e,t,n)=>{if(e===t)return 0;let r=ge((n-e)/(t-e),0,1);return r*r*(3-2*r)},ge=(e,t,n)=>Math.min(Math.max(t,e),n),Yr=(e,t)=>t===0?e:Math.trunc(e/t);function Gn(e){let t=new DataView(new ArrayBuffer(4));return t.setUint32(0,e,!0),t.getFloat32(0,!0)}function Dn(e){let t=new DataView(new ArrayBuffer(4));return t.setUint32(0,e,!0),t.getInt32(0,!0)}var hn=br[E].jsImpl,fn=G[E].jsImpl,Zn=Un[E].jsImpl,as=Be[E].jsImpl,Bs=xt[E].jsImpl,pn=Tr[E].jsImpl,nn=O[E].jsImpl,Nn=An[E].jsImpl,os=Ot[E].jsImpl,ks=rt[E].jsImpl,dn=_r[E].jsImpl,mn=k[E].jsImpl,Hn=In[E].jsImpl,us=Le[E].jsImpl,Os=Ce[E].jsImpl,Cr=e=>Math.sqrt(e.x**2+e.y**2),qr=e=>Math.sqrt(e.x**2+e.y**2+e.z**2),Wr=e=>Math.sqrt(e.x**2+e.y**2+e.z**2+e.w**2),mi=(e,t)=>e.x*t.x+e.y*t.y,yi=(e,t)=>e.x*t.x+e.y*t.y+e.z*t.z,gi=(e,t)=>e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w,Xe=e=>t=>fn(e(t.x),e(t.y)),Qe=e=>t=>Zn(e(t.x),e(t.y)),Xr=e=>t=>as(e(t.x),e(t.y)),bs=e=>t=>Bs(e(t.x),e(t.y)),We=e=>t=>nn(e(t.x),e(t.y),e(t.z)),Ke=e=>t=>Nn(e(t.x),e(t.y),e(t.z)),Jr=e=>t=>os(e(t.x),e(t.y),e(t.z)),Ts=e=>t=>ks(e(t.x),e(t.y),e(t.z)),Ye=e=>t=>mn(e(t.x),e(t.y),e(t.z),e(t.w)),et=e=>t=>Hn(e(t.x),e(t.y),e(t.z),e(t.w)),Zr=e=>t=>us(e(t.x),e(t.y),e(t.z),e(t.w)),_s=e=>t=>Os(e(t.x),e(t.y),e(t.z),e(t.w)),bu=e=>t=>{let n=t.columns;return xn(Xe(e)(n[0]),Xe(e)(n[1]))},Tu=e=>t=>{let n=t.columns;return Bn(We(e)(n[0]),We(e)(n[1]),We(e)(n[2]))},_u=e=>t=>{let n=t.columns;return ve(Ye(e)(n[0]),Ye(e)(n[1]),Ye(e)(n[2]),Ye(e)(n[3]))},Jn=e=>(t,n)=>fn(e(t.x,n.x),e(t.y,n.y)),$r=e=>(t,n)=>Zn(e(t.x,n.x),e(t.y,n.y)),Hr=e=>(t,n)=>as(e(t.x,n.x),e(t.y,n.y)),Qr=e=>(t,n)=>Bs(e(t.x,n.x),e(t.y,n.y)),Fn=e=>(t,n)=>nn(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z)),Mr=e=>(t,n)=>Nn(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z)),Kr=e=>(t,n)=>os(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z)),es=e=>(t,n)=>ks(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z)),$n=e=>(t,n)=>mn(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z),e(t.w,n.w)),zr=e=>(t,n)=>Hn(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z),e(t.w,n.w)),ts=e=>(t,n)=>us(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z),e(t.w,n.w)),ns=e=>(t,n)=>Os(e(t.x,n.x),e(t.y,n.y),e(t.z,n.z),e(t.w,n.w)),Nf=e=>(t,n)=>{let r=t.columns,s=n.columns;return xn(Jn(e)(r[0],s[0]),Jn(e)(r[1],s[1]))},Ff=e=>(t,n)=>{let r=t.columns,s=n.columns;return Bn(Fn(e)(r[0],s[0]),Fn(e)(r[1],s[1]),Fn(e)(r[2],s[2]))},Lf=e=>(t,n)=>{let r=t.columns,s=n.columns;return ve($n(e)(r[0],s[0]),$n(e)(r[1],s[1]),$n(e)(r[2],s[2]),$n(e)(r[3],s[3]))},jf=e=>(t,n,r)=>fn(e(t.x,n.x,r.x),e(t.y,n.y,r.y)),Yf=e=>(t,n,r)=>Zn(e(t.x,n.x,r.x),e(t.y,n.y,r.y)),Cf=e=>(t,n,r)=>nn(e(t.x,n.x,r.x),e(t.y,n.y,r.y),e(t.z,n.z,r.z)),qf=e=>(t,n,r)=>Nn(e(t.x,n.x,r.x),e(t.y,n.y,r.y),e(t.z,n.z,r.z)),Wf=e=>(t,n,r)=>mn(e(t.x,n.x,r.x),e(t.y,n.y,r.y),e(t.z,n.z,r.z),e(t.w,n.w,r.w)),Xf=e=>(t,n,r)=>Hn(e(t.x,n.x,r.x),e(t.y,n.y,r.y),e(t.z,n.z,r.z),e(t.w,n.w,r.w)),ee={eq:{vec2f:(e,t)=>hn(e.x===t.x,e.y===t.y),vec2h:(e,t)=>hn(e.x===t.x,e.y===t.y),vec2i:(e,t)=>hn(e.x===t.x,e.y===t.y),vec2u:(e,t)=>hn(e.x===t.x,e.y===t.y),"vec2<bool>":(e,t)=>hn(e.x===t.x,e.y===t.y),vec3f:(e,t)=>pn(e.x===t.x,e.y===t.y,e.z===t.z),vec3h:(e,t)=>pn(e.x===t.x,e.y===t.y,e.z===t.z),vec3i:(e,t)=>pn(e.x===t.x,e.y===t.y,e.z===t.z),vec3u:(e,t)=>pn(e.x===t.x,e.y===t.y,e.z===t.z),"vec3<bool>":(e,t)=>pn(e.x===t.x,e.y===t.y,e.z===t.z),vec4f:(e,t)=>dn(e.x===t.x,e.y===t.y,e.z===t.z,e.w===t.w),vec4h:(e,t)=>dn(e.x===t.x,e.y===t.y,e.z===t.z,e.w===t.w),vec4i:(e,t)=>dn(e.x===t.x,e.y===t.y,e.z===t.z,e.w===t.w),vec4u:(e,t)=>dn(e.x===t.x,e.y===t.y,e.z===t.z,e.w===t.w),"vec4<bool>":(e,t)=>dn(e.x===t.x,e.y===t.y,e.z===t.z,e.w===t.w)},lt:{vec2f:(e,t)=>hn(e.x<t.x,e.y<t.y),vec2h:(e,t)=>hn(e.x<t.x,e.y<t.y),vec2i:(e,t)=>hn(e.x<t.x,e.y<t.y),vec2u:(e,t)=>hn(e.x<t.x,e.y<t.y),vec3f:(e,t)=>pn(e.x<t.x,e.y<t.y,e.z<t.z),vec3h:(e,t)=>pn(e.x<t.x,e.y<t.y,e.z<t.z),vec3i:(e,t)=>pn(e.x<t.x,e.y<t.y,e.z<t.z),vec3u:(e,t)=>pn(e.x<t.x,e.y<t.y,e.z<t.z),vec4f:(e,t)=>dn(e.x<t.x,e.y<t.y,e.z<t.z,e.w<t.w),vec4h:(e,t)=>dn(e.x<t.x,e.y<t.y,e.z<t.z,e.w<t.w),vec4i:(e,t)=>dn(e.x<t.x,e.y<t.y,e.z<t.z,e.w<t.w),vec4u:(e,t)=>dn(e.x<t.x,e.y<t.y,e.z<t.z,e.w<t.w)},or:{"vec2<bool>":(e,t)=>hn(e.x||t.x,e.y||t.y),"vec3<bool>":(e,t)=>pn(e.x||t.x,e.y||t.y,e.z||t.z),"vec4<bool>":(e,t)=>dn(e.x||t.x,e.y||t.y,e.z||t.z,e.w||t.w)},all:{"vec2<bool>":e=>e.x&&e.y,"vec3<bool>":e=>e.x&&e.y&&e.z,"vec4<bool>":e=>e.x&&e.y&&e.z&&e.w},abs:{vec2f:Xe(Math.abs),vec2h:Qe(Math.abs),vec2i:Xr(Math.abs),vec2u:bs(Math.abs),vec3f:We(Math.abs),vec3h:Ke(Math.abs),vec3i:Jr(Math.abs),vec3u:Ts(Math.abs),vec4f:Ye(Math.abs),vec4h:et(Math.abs),vec4i:Zr(Math.abs),vec4u:_s(Math.abs)},atan2:{vec2f:Jn(Math.atan2),vec2h:$r(Math.atan2),vec3f:Fn(Math.atan2),vec3h:Mr(Math.atan2),vec4f:$n(Math.atan2),vec4h:zr(Math.atan2)},acos:{vec2f:Xe(Math.acos),vec2h:Qe(Math.acos),vec2i:Xr(Math.acos),vec2u:bs(Math.acos),vec3f:We(Math.acos),vec3h:Ke(Math.acos),vec3i:Jr(Math.acos),vec3u:Ts(Math.acos),vec4f:Ye(Math.acos),vec4h:et(Math.acos),vec4i:Zr(Math.acos),vec4u:_s(Math.acos)},acosh:{vec2f:Xe(Math.acosh),vec2h:Qe(Math.acosh),vec3f:We(Math.acosh),vec3h:Ke(Math.acosh),vec4f:Ye(Math.acosh),vec4h:et(Math.acosh)},asin:{vec2f:Xe(Math.asin),vec2h:Qe(Math.asin),vec3f:We(Math.asin),vec3h:Ke(Math.asin),vec4f:Ye(Math.asin),vec4h:et(Math.asin)},asinh:{vec2f:Xe(Math.asinh),vec2h:Qe(Math.asinh),vec3f:We(Math.asinh),vec3h:Ke(Math.asinh),vec4f:Ye(Math.asinh),vec4h:et(Math.asinh)},atan:{vec2f:Xe(Math.atan),vec2h:Qe(Math.atan),vec3f:We(Math.atan),vec3h:Ke(Math.atan),vec4f:Ye(Math.atan),vec4h:et(Math.atan)},atanh:{vec2f:Xe(Math.atanh),vec2h:Qe(Math.atanh),vec3f:We(Math.atanh),vec3h:Ke(Math.atanh),vec4f:Ye(Math.atanh),vec4h:et(Math.atanh)},ceil:{vec2f:Xe(Math.ceil),vec2h:Qe(Math.ceil),vec3f:We(Math.ceil),vec3h:Ke(Math.ceil),vec4f:Ye(Math.ceil),vec4h:et(Math.ceil)},clamp:{vec2f:(e,t,n)=>fn(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y)),vec2h:(e,t,n)=>Zn(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y)),vec2i:(e,t,n)=>as(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y)),vec2u:(e,t,n)=>Bs(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y)),vec3f:(e,t,n)=>nn(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z)),vec3h:(e,t,n)=>Nn(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z)),vec3i:(e,t,n)=>os(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z)),vec3u:(e,t,n)=>ks(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z)),vec4f:(e,t,n)=>mn(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z),ge(e.w,t.w,n.w)),vec4h:(e,t,n)=>Hn(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z),ge(e.w,t.w,n.w)),vec4i:(e,t,n)=>us(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z),ge(e.w,t.w,n.w)),vec4u:(e,t,n)=>Os(ge(e.x,t.x,n.x),ge(e.y,t.y,n.y),ge(e.z,t.z,n.z),ge(e.w,t.w,n.w))},length:{vec2f:Cr,vec2h:Cr,vec3f:qr,vec3h:qr,vec4f:Wr,vec4h:Wr},add:{vec2f:Jn((e,t)=>e+t),vec2h:$r((e,t)=>e+t),vec2i:Hr((e,t)=>e+t),vec2u:Qr((e,t)=>e+t),vec3f:Fn((e,t)=>e+t),vec3h:Mr((e,t)=>e+t),vec3i:Kr((e,t)=>e+t),vec3u:es((e,t)=>e+t),vec4f:$n((e,t)=>e+t),vec4h:zr((e,t)=>e+t),vec4i:ts((e,t)=>e+t),vec4u:ns((e,t)=>e+t),mat2x2f:Nf((e,t)=>e+t),mat3x3f:Ff((e,t)=>e+t),mat4x4f:Lf((e,t)=>e+t)},smoothstep:{vec2f:jf(Er),vec2h:Yf(Er),vec3f:Cf(Er),vec3h:qf(Er),vec4f:Wf(Er),vec4h:Xf(Er)},addMixed:{vec2f:(e,t)=>Xe(n=>n+t)(e),vec2h:(e,t)=>Qe(n=>n+t)(e),vec2i:(e,t)=>Xr(n=>n+t)(e),vec2u:(e,t)=>bs(n=>n+t)(e),vec3f:(e,t)=>We(n=>n+t)(e),vec3h:(e,t)=>Ke(n=>n+t)(e),vec3i:(e,t)=>Jr(n=>n+t)(e),vec3u:(e,t)=>Ts(n=>n+t)(e),vec4f:(e,t)=>Ye(n=>n+t)(e),vec4h:(e,t)=>et(n=>n+t)(e),vec4i:(e,t)=>Zr(n=>n+t)(e),vec4u:(e,t)=>_s(n=>n+t)(e),mat2x2f:(e,t)=>bu(n=>n+t)(e),mat3x3f:(e,t)=>Tu(n=>n+t)(e),mat4x4f:(e,t)=>_u(n=>n+t)(e)},mulSxV:{vec2f:(e,t)=>Xe(n=>e*n)(t),vec2h:(e,t)=>Qe(n=>e*n)(t),vec2i:(e,t)=>Xr(n=>e*n)(t),vec2u:(e,t)=>bs(n=>e*n)(t),vec3f:(e,t)=>We(n=>e*n)(t),vec3h:(e,t)=>Ke(n=>e*n)(t),vec3i:(e,t)=>Jr(n=>e*n)(t),vec3u:(e,t)=>Ts(n=>e*n)(t),vec4f:(e,t)=>Ye(n=>e*n)(t),vec4h:(e,t)=>et(n=>e*n)(t),vec4i:(e,t)=>Zr(n=>e*n)(t),vec4u:(e,t)=>_s(n=>e*n)(t),mat2x2f:(e,t)=>bu(n=>e*n)(t),mat3x3f:(e,t)=>Tu(n=>e*n)(t),mat4x4f:(e,t)=>_u(n=>e*n)(t)},mulVxV:{vec2f:Jn((e,t)=>e*t),vec2h:$r((e,t)=>e*t),vec2i:Hr((e,t)=>e*t),vec2u:Qr((e,t)=>e*t),vec3f:Fn((e,t)=>e*t),vec3h:Mr((e,t)=>e*t),vec3i:Kr((e,t)=>e*t),vec3u:es((e,t)=>e*t),vec4f:$n((e,t)=>e*t),vec4h:zr((e,t)=>e*t),vec4i:ts((e,t)=>e*t),vec4u:ns((e,t)=>e*t),mat2x2f:(e,t)=>{let n=e.columns,r=t.columns;return xn(n[0].x*r[0].x+n[1].x*r[0].y,n[0].y*r[0].x+n[1].y*r[0].y,n[0].x*r[1].x+n[1].x*r[1].y,n[0].y*r[1].x+n[1].y*r[1].y)},mat3x3f:(e,t)=>{let n=e.columns,r=t.columns;return Bn(n[0].x*r[0].x+n[1].x*r[0].y+n[2].x*r[0].z,n[0].y*r[0].x+n[1].y*r[0].y+n[2].y*r[0].z,n[0].z*r[0].x+n[1].z*r[0].y+n[2].z*r[0].z,n[0].x*r[1].x+n[1].x*r[1].y+n[2].x*r[1].z,n[0].y*r[1].x+n[1].y*r[1].y+n[2].y*r[1].z,n[0].z*r[1].x+n[1].z*r[1].y+n[2].z*r[1].z,n[0].x*r[2].x+n[1].x*r[2].y+n[2].x*r[2].z,n[0].y*r[2].x+n[1].y*r[2].y+n[2].y*r[2].z,n[0].z*r[2].x+n[1].z*r[2].y+n[2].z*r[2].z)},mat4x4f:(e,t)=>{let n=e.columns,r=t.columns;return ve(n[0].x*r[0].x+n[1].x*r[0].y+n[2].x*r[0].z+n[3].x*r[0].w,n[0].y*r[0].x+n[1].y*r[0].y+n[2].y*r[0].z+n[3].y*r[0].w,n[0].z*r[0].x+n[1].z*r[0].y+n[2].z*r[0].z+n[3].z*r[0].w,n[0].w*r[0].x+n[1].w*r[0].y+n[2].w*r[0].z+n[3].w*r[0].w,n[0].x*r[1].x+n[1].x*r[1].y+n[2].x*r[1].z+n[3].x*r[1].w,n[0].y*r[1].x+n[1].y*r[1].y+n[2].y*r[1].z+n[3].y*r[1].w,n[0].z*r[1].x+n[1].z*r[1].y+n[2].z*r[1].z+n[3].z*r[1].w,n[0].w*r[1].x+n[1].w*r[1].y+n[2].w*r[1].z+n[3].w*r[1].w,n[0].x*r[2].x+n[1].x*r[2].y+n[2].x*r[2].z+n[3].x*r[2].w,n[0].y*r[2].x+n[1].y*r[2].y+n[2].y*r[2].z+n[3].y*r[2].w,n[0].z*r[2].x+n[1].z*r[2].y+n[2].z*r[2].z+n[3].z*r[2].w,n[0].w*r[2].x+n[1].w*r[2].y+n[2].w*r[2].z+n[3].w*r[2].w,n[0].x*r[3].x+n[1].x*r[3].y+n[2].x*r[3].z+n[3].x*r[3].w,n[0].y*r[3].x+n[1].y*r[3].y+n[2].y*r[3].z+n[3].y*r[3].w,n[0].z*r[3].x+n[1].z*r[3].y+n[2].z*r[3].z+n[3].z*r[3].w,n[0].w*r[3].x+n[1].w*r[3].y+n[2].w*r[3].z+n[3].w*r[3].w)}},mulMxV:{mat2x2f:(e,t)=>{let n=e.columns;return fn(n[0].x*t.x+n[1].x*t.y,n[0].y*t.x+n[1].y*t.y)},mat3x3f:(e,t)=>{let n=e.columns;return nn(n[0].x*t.x+n[1].x*t.y+n[2].x*t.z,n[0].y*t.x+n[1].y*t.y+n[2].y*t.z,n[0].z*t.x+n[1].z*t.y+n[2].z*t.z)},mat4x4f:(e,t)=>{let n=e.columns;return mn(n[0].x*t.x+n[1].x*t.y+n[2].x*t.z+n[3].x*t.w,n[0].y*t.x+n[1].y*t.y+n[2].y*t.z+n[3].y*t.w,n[0].z*t.x+n[1].z*t.y+n[2].z*t.z+n[3].z*t.w,n[0].w*t.x+n[1].w*t.y+n[2].w*t.z+n[3].w*t.w)}},mulVxM:{mat2x2f:(e,t)=>{let n=t.columns;return fn(e.x*n[0].x+e.y*n[0].y,e.x*n[1].x+e.y*n[1].y)},mat3x3f:(e,t)=>{let n=t.columns;return nn(e.x*n[0].x+e.y*n[0].y+e.z*n[0].z,e.x*n[1].x+e.y*n[1].y+e.z*n[1].z,e.x*n[2].x+e.y*n[2].y+e.z*n[2].z)},mat4x4f:(e,t)=>{let n=t.columns;return mn(e.x*n[0].x+e.y*n[0].y+e.z*n[0].z+e.w*n[0].w,e.x*n[1].x+e.y*n[1].y+e.z*n[1].z+e.w*n[1].w,e.x*n[2].x+e.y*n[2].y+e.z*n[2].z+e.w*n[2].w,e.x*n[3].x+e.y*n[3].y+e.z*n[3].z+e.w*n[3].w)}},div:{vec2f:Jn((e,t)=>e/t),vec2h:$r((e,t)=>e/t),vec2i:Hr(Yr),vec2u:Qr(Yr),vec3f:Fn((e,t)=>e/t),vec3h:Mr((e,t)=>e/t),vec3i:Kr(Yr),vec3u:es(Yr),vec4f:$n((e,t)=>e/t),vec4h:zr((e,t)=>e/t),vec4i:ts(Yr),vec4u:ns(Yr)},dot:{vec2f:mi,vec2h:mi,vec2i:mi,vec2u:mi,vec3f:yi,vec3h:yi,vec3i:yi,vec3u:yi,vec4f:gi,vec4h:gi,vec4i:gi,vec4u:gi},normalize:{vec2f:e=>{let t=Cr(e);return fn(e.x/t,e.y/t)},vec2h:e=>{let t=Cr(e);return Zn(e.x/t,e.y/t)},vec2i:e=>{let t=Cr(e);return as(e.x/t,e.y/t)},vec2u:e=>{let t=Cr(e);return Bs(e.x/t,e.y/t)},vec3f:e=>{let t=qr(e);return nn(e.x/t,e.y/t,e.z/t)},vec3h:e=>{let t=qr(e);return Nn(e.x/t,e.y/t,e.z/t)},vec3i:e=>{let t=qr(e);return os(e.x/t,e.y/t,e.z/t)},vec3u:e=>{let t=qr(e);return ks(e.x/t,e.y/t,e.z/t)},vec4f:e=>{let t=Wr(e);return mn(e.x/t,e.y/t,e.z/t,e.w/t)},vec4h:e=>{let t=Wr(e);return Hn(e.x/t,e.y/t,e.z/t,e.w/t)},vec4i:e=>{let t=Wr(e);return us(e.x/t,e.y/t,e.z/t,e.w/t)},vec4u:e=>{let t=Wr(e);return Os(e.x/t,e.y/t,e.z/t,e.w/t)}},cross:{vec3f:(e,t)=>nn(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x),vec3h:(e,t)=>Nn(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x)},mod:{vec2f:Jn((e,t)=>e%t),vec2h:$r((e,t)=>e%t),vec2i:Hr((e,t)=>e%t),vec2u:Qr((e,t)=>e%t),vec3f:Fn((e,t)=>e%t),vec3h:Mr((e,t)=>e%t),vec3i:Kr((e,t)=>e%t),vec3u:es((e,t)=>e%t),vec4f:$n((e,t)=>e%t),vec4h:zr((e,t)=>e%t),vec4i:ts((e,t)=>e%t),vec4u:ns((e,t)=>e%t)},floor:{vec2f:Xe(Math.floor),vec2h:Qe(Math.floor),vec3f:We(Math.floor),vec3h:Ke(Math.floor),vec4f:Ye(Math.floor),vec4h:et(Math.floor)},max:{vec2f:Jn(Math.max),vec2h:$r(Math.max),vec2i:Hr(Math.max),vec2u:Qr(Math.max),vec3f:Fn(Math.max),vec3h:Mr(Math.max),vec3i:Kr(Math.max),vec3u:es(Math.max),vec4f:$n(Math.max),vec4h:zr(Math.max),vec4i:ts(Math.max),vec4u:ns(Math.max)},min:{vec2f:Jn(Math.min),vec2h:$r(Math.min),vec2i:Hr(Math.min),vec2u:Qr(Math.min),vec3f:Fn(Math.min),vec3h:Mr(Math.min),vec3i:Kr(Math.min),vec3u:es(Math.min),vec4f:$n(Math.min),vec4h:zr(Math.min),vec4i:ts(Math.min),vec4u:ns(Math.min)},pow:{vec2f:(e,t)=>fn(e.x**t.x,e.y**t.y),vec2h:(e,t)=>Zn(e.x**t.x,e.y**t.y),vec3f:(e,t)=>nn(e.x**t.x,e.y**t.y,e.z**t.z),vec3h:(e,t)=>Nn(e.x**t.x,e.y**t.y,e.z**t.z),vec4f:(e,t)=>mn(e.x**t.x,e.y**t.y,e.z**t.z,e.w**t.w),vec4h:(e,t)=>Hn(e.x**t.x,e.y**t.y,e.z**t.z,e.w**t.w)},sign:{vec2f:Xe(Math.sign),vec2h:Qe(Math.sign),vec2i:Xr(Math.sign),vec3f:We(Math.sign),vec3h:Ke(Math.sign),vec3i:Jr(Math.sign),vec4f:Ye(Math.sign),vec4h:et(Math.sign),vec4i:Zr(Math.sign)},sqrt:{vec2f:Xe(Math.sqrt),vec2h:Qe(Math.sqrt),vec3f:We(Math.sqrt),vec3h:Ke(Math.sqrt),vec4f:Ye(Math.sqrt),vec4h:et(Math.sqrt)},mix:{vec2f:(e,t,n)=>typeof n=="number"?fn(e.x*(1-n)+t.x*n,e.y*(1-n)+t.y*n):fn(e.x*(1-n.x)+t.x*n.x,e.y*(1-n.y)+t.y*n.y),vec2h:(e,t,n)=>typeof n=="number"?Zn(e.x*(1-n)+t.x*n,e.y*(1-n)+t.y*n):Zn(e.x*(1-n.x)+t.x*n.x,e.y*(1-n.y)+t.y*n.y),vec3f:(e,t,n)=>typeof n=="number"?nn(e.x*(1-n)+t.x*n,e.y*(1-n)+t.y*n,e.z*(1-n)+t.z*n):nn(e.x*(1-n.x)+t.x*n.x,e.y*(1-n.y)+t.y*n.y,e.z*(1-n.z)+t.z*n.z),vec3h:(e,t,n)=>typeof n=="number"?Nn(e.x*(1-n)+t.x*n,e.y*(1-n)+t.y*n,e.z*(1-n)+t.z*n):Nn(e.x*(1-n.x)+t.x*n.x,e.y*(1-n.y)+t.y*n.y,e.z*(1-n.z)+t.z*n.z),vec4f:(e,t,n)=>typeof n=="number"?mn(e.x*(1-n)+t.x*n,e.y*(1-n)+t.y*n,e.z*(1-n)+t.z*n,e.w*(1-n)+t.w*n):mn(e.x*(1-n.x)+t.x*n.x,e.y*(1-n.y)+t.y*n.y,e.z*(1-n.z)+t.z*n.z,e.w*(1-n.w)+t.w*n.w),vec4h:(e,t,n)=>typeof n=="number"?Hn(e.x*(1-n)+t.x*n,e.y*(1-n)+t.y*n,e.z*(1-n)+t.z*n,e.w*(1-n)+t.w*n):Hn(e.x*(1-n.x)+t.x*n.x,e.y*(1-n.y)+t.y*n.y,e.z*(1-n.z)+t.z*n.z,e.w*(1-n.w)+t.w*n.w)},sin:{vec2f:Xe(Math.sin),vec2h:Qe(Math.sin),vec3f:We(Math.sin),vec3h:Ke(Math.sin),vec4f:Ye(Math.sin),vec4h:et(Math.sin)},cos:{vec2f:Xe(Math.cos),vec2h:Qe(Math.cos),vec3f:We(Math.cos),vec3h:Ke(Math.cos),vec4f:Ye(Math.cos),vec4h:et(Math.cos)},cosh:{vec2f:Xe(Math.cosh),vec2h:Qe(Math.cosh),vec3f:We(Math.cosh),vec3h:Ke(Math.cosh),vec4f:Ye(Math.cosh),vec4h:et(Math.cosh)},exp:{vec2f:Xe(Math.exp),vec2h:Qe(Math.exp),vec3f:We(Math.exp),vec3h:Ke(Math.exp),vec4f:Ye(Math.exp),vec4h:et(Math.exp)},exp2:{vec2f:Xe(e=>2**e),vec2h:Qe(e=>2**e),vec3f:We(e=>2**e),vec3h:Ke(e=>2**e),vec4f:Ye(e=>2**e),vec4h:et(e=>2**e)},log:{vec2f:Xe(Math.log),vec2h:Qe(Math.log),vec3f:We(Math.log),vec3h:Ke(Math.log),vec4f:Ye(Math.log),vec4h:et(Math.log)},log2:{vec2f:Xe(Math.log2),vec2h:Qe(Math.log2),vec3f:We(Math.log2),vec3h:Ke(Math.log2),vec4f:Ye(Math.log2),vec4h:et(Math.log2)},fract:{vec2f:Xe(e=>e-Math.floor(e)),vec2h:Qe(e=>e-Math.floor(e)),vec3f:We(e=>e-Math.floor(e)),vec3h:Ke(e=>e-Math.floor(e)),vec4f:Ye(e=>e-Math.floor(e)),vec4h:et(e=>e-Math.floor(e))},isCloseToZero:{vec2f:(e,t)=>Math.abs(e.x)<=t&&Math.abs(e.y)<=t,vec2h:(e,t)=>Math.abs(e.x)<=t&&Math.abs(e.y)<=t,vec3f:(e,t)=>Math.abs(e.x)<=t&&Math.abs(e.y)<=t&&Math.abs(e.z)<=t,vec3h:(e,t)=>Math.abs(e.x)<=t&&Math.abs(e.y)<=t&&Math.abs(e.z)<=t,vec4f:(e,t)=>Math.abs(e.x)<=t&&Math.abs(e.y)<=t&&Math.abs(e.z)<=t&&Math.abs(e.w)<=t,vec4h:(e,t)=>Math.abs(e.x)<=t&&Math.abs(e.y)<=t&&Math.abs(e.z)<=t&&Math.abs(e.w)<=t},neg:{vec2f:Xe(e=>-e),vec2h:Qe(e=>-e),vec2i:Xr(e=>-e),vec2u:bs(e=>-e),"vec2<bool>":e=>hn(!e.x,!e.y),vec3f:We(e=>-e),vec3h:Ke(e=>-e),vec3i:Jr(e=>-e),vec3u:Ts(e=>-e),"vec3<bool>":e=>pn(!e.x,!e.y,!e.z),vec4f:Ye(e=>-e),vec4h:et(e=>-e),vec4i:Zr(e=>-e),vec4u:_s(e=>-e),"vec4<bool>":e=>dn(!e.x,!e.y,!e.z,!e.w)},select:{vec2f:(e,t,n)=>fn(n.x?t.x:e.x,n.y?t.y:e.y),vec2h:(e,t,n)=>Zn(n.x?t.x:e.x,n.y?t.y:e.y),vec2i:(e,t,n)=>as(n.x?t.x:e.x,n.y?t.y:e.y),vec2u:(e,t,n)=>Bs(n.x?t.x:e.x,n.y?t.y:e.y),"vec2<bool>":(e,t,n)=>hn(n.x?t.x:e.x,n.y?t.y:e.y),vec3f:(e,t,n)=>nn(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z),vec3h:(e,t,n)=>Nn(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z),vec3i:(e,t,n)=>os(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z),vec3u:(e,t,n)=>ks(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z),"vec3<bool>":(e,t,n)=>pn(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z),vec4f:(e,t,n)=>mn(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z,n.w?t.w:e.w),vec4h:(e,t,n)=>Hn(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z,n.w?t.w:e.w),vec4i:(e,t,n)=>us(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z,n.w?t.w:e.w),vec4u:(e,t,n)=>Os(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z,n.w?t.w:e.w),"vec4<bool>":(e,t,n)=>dn(n.x?t.x:e.x,n.y?t.y:e.y,n.z?t.z:e.z,n.w?t.w:e.w)},tanh:{vec2f:Xe(Math.tanh),vec2h:Qe(Math.tanh),vec3f:We(Math.tanh),vec3h:Ke(Math.tanh),vec4f:Ye(Math.tanh),vec4h:et(Math.tanh)},bitcastU32toF32:{vec2u:e=>fn(Gn(e.x),Gn(e.y)),vec3u:e=>nn(Gn(e.x),Gn(e.y),Gn(e.z)),vec4u:e=>mn(Gn(e.x),Gn(e.y),Gn(e.z),Gn(e.w))},bitcastU32toI32:{vec2u:e=>as(Dn(e.x),Dn(e.y)),vec3u:e=>os(Dn(e.x),Dn(e.y),Dn(e.z)),vec4u:e=>us(Dn(e.x),Dn(e.y),Dn(e.z),Dn(e.w))}};function Oc(e,t){if(typeof e=="number"&&typeof t=="number")return e+t;if(typeof e=="number"&&Ze(t))return ee.addMixed[t.kind](t,e);if(Ze(e)&&typeof t=="number")return ee.addMixed[e.kind](e,t);if(Ze(e)&&Ze(t)||jn(e)&&jn(t))return ee.add[e.kind](e,t);throw new Error("Add/Sub called with invalid arguments.")}var ue=D({name:"add",signature:(...e)=>{let t=ct(e)??e;return{argTypes:t,returnType:sr(t[0])?t[1]:t[0]}},normalImpl:Oc,codegenImpl:(e,t)=>S`(${e} + ${t})`});function Jf(e,t){return Oc(e,Vc(-1,t))}var K=D({name:"sub",signature:(...e)=>{let t=ct(e)??e;return{argTypes:t,returnType:sr(t[0])?t[1]:t[0]}},normalImpl:Jf,codegenImpl:(e,t)=>S`(${e} - ${t})`});function Vc(e,t){if(typeof e=="number"&&typeof t=="number")return e*t;if(typeof e=="number"&&(Ze(t)||jn(t)))return ee.mulSxV[t.kind](e,t);if((Ze(e)||jn(e))&&typeof t=="number")return ee.mulSxV[e.kind](t,e);if(Ze(e)&&Ze(t))return ee.mulVxV[e.kind](e,t);if(ru(e)&&jn(t))return ee.mulVxM[t.kind](e,t);if(jn(e)&&ru(t))return ee.mulMxV[e.kind](e,t);if(jn(e)&&jn(t))return ee.mulVxV[e.kind](e,t);throw new Error("Mul called with invalid arguments.")}var be=D({name:"mul",signature:(...e)=>{let t=ct(e)??e,n=sr(t[0])?t[1]:sr(t[1])||t[0].type.startsWith("vec")?t[0]:t[1].type.startsWith("vec")?t[1]:t[0];return{argTypes:t,returnType:n}},normalImpl:Vc,codegenImpl:(e,t)=>S`(${e} * ${t})`});function Zf(e,t){if(typeof e=="number"&&typeof t=="number")return e/t;if(typeof e=="number"&&Ze(t)){let n=Di[t.kind][E].jsImpl;return ee.div[t.kind](n(e),t)}if(Ze(e)&&typeof t=="number"){let n=Di[e.kind][E].jsImpl;return ee.div[e.kind](e,n(t))}if(Ze(e)&&Ze(t))return ee.div[e.kind](e,t);throw new Error("Div called with invalid arguments.")}var No=D({name:"div",signature:(...e)=>{let t=ct(e,[$,ut,Pn])??e;return{argTypes:t,returnType:sr(t[0])?t[1]:t[0]}},normalImpl:Zf,codegenImpl:(e,t)=>S`(${e} / ${t})`,ignoreImplicitCastWarning:!0}),Hf=D({name:"mod",signature:(...e)=>{let t=ct(e)??e;return{argTypes:t,returnType:sr(t[0])?t[1]:t[0]}},normalImpl(e,t){if(typeof e=="number"&&typeof t=="number")return e%t;if(typeof e=="number"&&Ze(t)){let n=Di[t.kind];return ee.mod[t.kind](n(e),t)}if(Ze(e)&&typeof t=="number"){let n=Di[e.kind];return ee.mod[e.kind](e,n(t))}if(Ze(e)&&Ze(t))return ee.mod[e.kind](e,t);throw new Error("Mod called with invalid arguments, expected types: number or vector.")},codegenImpl:(e,t)=>S`(${e} % ${t})`});function Qf(e){return typeof e=="number"?-e:ee.neg[e.kind](e)}var js=D({name:"neg",signature:e=>({argTypes:[e],returnType:e}),normalImpl:Qf,codegenImpl:e=>S`-(${e})`});function Kf(e){return typeof e=="number"?Math.abs(e):ee.abs[e.kind](e)}var Je=D({name:"abs",signature:e=>({argTypes:[e],returnType:e}),normalImpl:Kf,codegenImpl:e=>S`abs(${e})`});function em(e){return typeof e=="number"?Math.acos(e):ee.acos[e.kind](e)}var ja=D({name:"acos",signature:e=>({argTypes:[e],returnType:e}),normalImpl:em,codegenImpl:e=>S`acos(${e})`});function tm(e){return typeof e=="number"?Math.acosh(e):ee.acosh[e.kind](e)}var nm=D({name:"acosh",signature:e=>({argTypes:[e],returnType:e}),normalImpl:tm,codegenImpl:e=>S`acosh(${e})`});function rm(e){return typeof e=="number"?Math.asin(e):ee.asin[e.kind](e)}var sm=D({name:"asin",signature:e=>({argTypes:[e],returnType:e}),normalImpl:rm,codegenImpl:e=>S`asin(${e})`});function im(e){return typeof e=="number"?Math.asinh(e):ee.asinh[e.kind](e)}var am=D({name:"asinh",signature:e=>({argTypes:[e],returnType:e}),normalImpl:im,codegenImpl:e=>S`asinh(${e})`});function om(e){return typeof e=="number"?Math.atan(e):ee.atan[e.kind](e)}var um=D({name:"atan",signature:e=>({argTypes:[e],returnType:e}),normalImpl:om,codegenImpl:e=>S`atan(${e})`});function lm(e){return typeof e=="number"?Math.atanh(e):ee.atanh[e.kind](e)}var cm=D({name:"atanh",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lm,codegenImpl:e=>S`atanh(${e})`});function hm(e,t){return typeof e=="number"&&typeof t=="number"?Math.atan2(e,t):ee.atan2[e.kind](e,t)}var pm=D({name:"atan2",signature:(...e)=>{let t=ct(e,[$,ut,Pn])??e;return{argTypes:t,returnType:t[0]}},normalImpl:hm,codegenImpl:(e,t)=>S`atan2(${e}, ${t})`});function dm(e){return typeof e=="number"?Math.ceil(e):ee.ceil[e.kind](e)}var Gc=D({name:"ceil",signature:e=>({argTypes:[e],returnType:e}),normalImpl:dm,codegenImpl:e=>S`ceil(${e})`});function fm(e,t,n){return typeof e=="number"?Math.min(Math.max(t,e),n):ee.clamp[e.kind](e,t,n)}var Or=D({name:"clamp",signature:(...e)=>{let t=ct(e)??e;return{argTypes:t,returnType:t[0]}},normalImpl:fm,codegenImpl:(e,t,n)=>S`clamp(${e}, ${t}, ${n})`});function mm(e){return typeof e=="number"?Math.cos(e):ee.cos[e.kind](e)}var Ft=D({name:"cos",signature:e=>({argTypes:[e],returnType:e}),normalImpl:mm,codegenImpl:e=>S`cos(${e})`});function ym(e){return typeof e=="number"?Math.cosh(e):ee.cosh[e.kind](e)}var gm=D({name:"cosh",signature:e=>({argTypes:[e],returnType:e}),normalImpl:ym,codegenImpl:e=>S`cosh(${e})`}),wm=D({name:"countLeadingZeros",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for countLeadingZeros not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`countLeadingZeros(${e})`}),xm=D({name:"countOneBits",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for countOneBits not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`countOneBits(${e})`}),vm=D({name:"countTrailingZeros",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for countTrailingZeros not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`countTrailingZeros(${e})`}),Dc=D({name:"cross",signature:(e,t)=>({argTypes:[e,t],returnType:e}),normalImpl:(e,t)=>ee.cross[e.kind](e,t),codegenImpl:(e,t)=>S`cross(${e}, ${t})`});function bm(e){if(typeof e=="number")return e*180/Math.PI;throw new on("CPU implementation for degrees on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var Tm=D({name:"degrees",signature:e=>({argTypes:[e],returnType:e}),normalImpl:bm,codegenImpl:e=>S`degrees(${e})`}),_m=D({name:"determinant",signature:e=>({argTypes:[e],returnType:$}),normalImpl:"CPU implementation for determinant not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`determinant(${e})`});function $m(e,t){return typeof e=="number"&&typeof t=="number"?Math.abs(e-t):Te(K(e,t))}var Mm=D({name:"distance",signature:(e,t)=>({argTypes:[e,t],returnType:fo(e)?ut:$}),normalImpl:$m,codegenImpl:(e,t)=>S`distance(${e}, ${t})`}),ae=D({name:"dot",signature:(e,t)=>({argTypes:[e,t],returnType:e.primitive}),normalImpl:(e,t)=>ee.dot[e.kind](e,t),codegenImpl:(e,t)=>S`dot(${e}, ${t})`}),zm=D({name:"dot4U8Packed",signature:(e,t)=>({argTypes:[J,J],returnType:J}),normalImpl:"CPU implementation for dot4U8Packed not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:(e,t)=>S`dot4U8Packed(${e}, ${t})`}),Em=D({name:"dot4I8Packed",signature:(e,t)=>({argTypes:[J,J],returnType:Ae}),normalImpl:"CPU implementation for dot4I8Packed not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:(e,t)=>S`dot4I8Packed(${e}, ${t})`});function Sm(e){return typeof e=="number"?Math.exp(e):ee.exp[e.kind](e)}var Rc=D({name:"exp",signature:e=>({argTypes:[e],returnType:e}),normalImpl:Sm,codegenImpl:e=>S`exp(${e})`});function Pm(e){return typeof e=="number"?2**e:ee.exp2[e.kind](e)}var Um=D({name:"exp2",signature:e=>({argTypes:[e],returnType:e}),normalImpl:Pm,codegenImpl:e=>S`exp2(${e})`}),Am=D({name:"extractBits",signature:(e,t,n)=>({argTypes:[e,J,J],returnType:e}),normalImpl:"CPU implementation for extractBits not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:(e,t,n)=>S`extractBits(${e}, ${t}, ${n})`}),Im=D({name:"faceForward",signature:(e,t,n)=>({argTypes:[e,t,n],returnType:e}),normalImpl:"CPU implementation for faceForward not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:(e,t,n)=>S`faceForward(${e}, ${t}, ${n})`}),Bm=D({name:"firstLeadingBit",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for firstLeadingBit not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`firstLeadingBit(${e})`}),km=D({name:"firstTrailingBit",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for firstTrailingBit not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`firstTrailingBit(${e})`});function Om(e){return typeof e=="number"?Math.floor(e):ee.floor[e.kind](e)}var Vr=D({name:"floor",signature:(...e)=>({argTypes:e,returnType:e[0]}),normalImpl:Om,codegenImpl:e=>S`floor(${e})`});function Vm(e,t,n){if(typeof e=="number")return e*t+n;throw new on("CPU implementation for fma on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var Gm=D({name:"fma",signature:(e,t,n)=>({argTypes:[e,t,n],returnType:e}),normalImpl:Vm,codegenImpl:(e,t,n)=>S`fma(${e}, ${t}, ${n})`});function Dm(e){return typeof e=="number"?e-Math.floor(e):ee.fract[e.kind](e)}var tr=D({name:"fract",signature:(...e)=>({argTypes:e,returnType:e[0]}),normalImpl:Dm,codegenImpl:e=>S`fract(${e})`}),Rm={f32:wt({fract:$,exp:Ae}),f16:wt({fract:ut,exp:Ae}),abstractFloat:wt({fract:Pn,exp:Zs}),vec2f:wt({fract:G,exp:Be}),vec3f:wt({fract:O,exp:Ot}),vec4f:wt({fract:k,exp:Le}),vec2h:wt({fract:Un,exp:Be}),vec3h:wt({fract:An,exp:Ot}),vec4h:wt({fract:In,exp:Le})},Nm=ce(e=>{throw new on("CPU implementation for frexp not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")},e=>{let t=Rm[e.dataType.type];if(!t)throw new Error(`Unsupported data type for frexp: ${e.dataType.type}. Supported types are f32, f16, abstractFloat, vec2f, vec3f, vec4f, vec2h, vec3h, vec4h.`);return B(S`frexp(${e})`,t)},"frexp"),Fm=D({name:"insertBits",signature:(e,t,n,r)=>({argTypes:[e,t,J,J],returnType:e}),normalImpl:"CPU implementation for insertBits not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:(e,t,n,r)=>S`insertBits(${e}, ${t}, ${n}, ${r})`});function Lm(e){if(typeof e=="number")return 1/Math.sqrt(e);throw new on("CPU implementation for inverseSqrt on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var jm=D({name:"inverseSqrt",signature:e=>({argTypes:[e],returnType:e}),normalImpl:Lm,codegenImpl:e=>S`inverseSqrt(${e})`}),Ym=D({name:"ldexp",signature:(e,t)=>{switch(e.type){case"abstractFloat":return{argTypes:[Pn,Zs],returnType:e};case"f32":case"f16":return{argTypes:[e,Ae],returnType:e};case"vec2f":case"vec2h":return{argTypes:[e,Be],returnType:e};case"vec3f":case"vec3h":return{argTypes:[e,Ot],returnType:e};case"vec4f":case"vec4h":return{argTypes:[e,Le],returnType:e};default:throw new Error(`Unsupported data type for ldexp: ${e.type}. Supported types are abstractFloat, f32, f16, vec2f, vec2h, vec3f, vec3h, vec4f, vec4h.`)}},normalImpl:"CPU implementation for ldexp not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:(e,t)=>S`ldexp(${e}, ${t})`});function Cm(e){return typeof e=="number"?Math.abs(e):ee.length[e.kind](e)}var Te=D({name:"length",signature:e=>({argTypes:[e],returnType:fo(e)?ut:$}),normalImpl:Cm,codegenImpl:e=>S`length(${e})`});function qm(e){return typeof e=="number"?Math.log(e):ee.log[e.kind](e)}var Ys=D({name:"log",signature:e=>({argTypes:[e],returnType:e}),normalImpl:qm,codegenImpl:e=>S`log(${e})`});function Wm(e){return typeof e=="number"?Math.log2(e):ee.log2[e.kind](e)}var Xm=D({name:"log2",signature:e=>({argTypes:[e],returnType:e}),normalImpl:Wm,codegenImpl:e=>S`log2(${e})`});function Jm(e,t){return typeof e=="number"?Math.max(e,t):ee.max[e.kind](e,t)}var re=D({name:"max",signature:(...e)=>{let t=ct(e)??e;return{argTypes:t,returnType:t[0]}},normalImpl:Jm,codegenImpl:(e,t)=>S`max(${e}, ${t})`});function Zm(e,t){return typeof e=="number"?Math.min(e,t):ee.min[e.kind](e,t)}var pe=D({name:"min",signature:(...e)=>{let t=ct(e)??e;return{argTypes:t,returnType:t[0]}},normalImpl:Zm,codegenImpl:(e,t)=>S`min(${e}, ${t})`});function Hm(e,t,n){if(typeof e=="number"){if(typeof n!="number"||typeof t!="number")throw new Error("When e1 and e2 are numbers, the blend factor must be a number.");return e*(1-n)+t*n}if(typeof e=="number"||typeof t=="number")throw new Error("e1 and e2 need to both be vectors of the same kind.");return ee.mix[e.kind](e,t,n)}var rn=D({name:"mix",signature:(e,t,n)=>({argTypes:[e,t,n],returnType:e}),normalImpl:Hm,codegenImpl:(e,t,n)=>S`mix(${e}, ${t}, ${n})`}),Qm={f32:wt({fract:$,whole:$}),f16:wt({fract:ut,whole:ut}),abstractFloat:wt({fract:Pn,whole:Pn}),vec2f:wt({fract:G,whole:G}),vec3f:wt({fract:O,whole:O}),vec4f:wt({fract:k,whole:k}),vec2h:wt({fract:Un,whole:Un}),vec3h:wt({fract:An,whole:An}),vec4h:wt({fract:In,whole:In})},Km=D({name:"modf",signature:e=>{let t=Qm[e.type];if(!t)throw new Error(`Unsupported data type for modf: ${e.type}. Supported types are f32, f16, abstractFloat, vec2f, vec3f, vec4f, vec2h, vec3h, vec4h.`);return{argTypes:[e],returnType:t}},normalImpl:"CPU implementation for modf not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`modf(${e})`}),an=D({name:"normalize",signature:e=>({argTypes:[e],returnType:e}),normalImpl:e=>ee.normalize[e.kind](e),codegenImpl:e=>S`normalize(${e})`});function e1(e,t){if(typeof e=="number"&&typeof t=="number")return e**t;if(Ze(e)&&Ze(t))return ee.pow[e.kind](e,t);throw new Error("Invalid arguments to pow()")}var wr=D({name:"pow",signature:(...e)=>{let t=ct(e,[$,ut,Pn])??e;return{argTypes:t,returnType:sr(t[0])?t[1]:t[0]}},normalImpl:e1,codegenImpl:(e,t)=>S`pow(${e}, ${t})`}),t1=D({name:"quantizeToF16",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for quantizeToF16 not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`quantizeToF16(${e})`});function n1(e){if(typeof e=="number")return e*Math.PI/180;throw new on("CPU implementation for radians on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var r1=D({name:"radians",signature:(...e)=>{let t=ct(e,[$,ut,Pn])??e;return{argTypes:t,returnType:t[0]}},normalImpl:n1,codegenImpl:e=>S`radians(${e})`}),Nc=D({name:"reflect",signature:(e,t)=>({argTypes:[e,t],returnType:e}),normalImpl:(e,t)=>K(e,be(2*ae(t,e),t)),codegenImpl:(e,t)=>S`reflect(${e}, ${t})`}),s1=ce((e,t,n)=>{throw new on("CPU implementation for refract not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")},(e,t,n)=>B(S`refract(${e}, ${t}, ${n})`,e.dataType),"refract",(e,t,n)=>[e.dataType,t.dataType,fo(e)?ut:$]),i1=D({name:"reverseBits",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for reverseBits not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`reverseBits(${e})`});function a1(e){if(typeof e=="number")return Math.round(e);throw new on("CPU implementation for round on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var o1=D({name:"round",signature:e=>({argTypes:[e],returnType:e}),normalImpl:a1,codegenImpl:e=>S`round(${e})`});function u1(e){if(typeof e=="number")return Math.max(0,Math.min(1,e));throw new on("CPU implementation for saturate on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var jt=D({name:"saturate",signature:e=>({argTypes:[e],returnType:e}),normalImpl:u1,codegenImpl:e=>S`saturate(${e})`});function l1(e){return typeof e=="number"?Math.sign(e):ee.sign[e.kind](e)}var or=D({name:"sign",signature:e=>({argTypes:[e],returnType:e}),normalImpl:l1,codegenImpl:e=>S`sign(${e})`});function c1(e){return typeof e=="number"?Math.sin(e):ee.sin[e.kind](e)}var un=D({name:"sin",signature:e=>({argTypes:[e],returnType:e}),normalImpl:c1,codegenImpl:e=>S`sin(${e})`});function h1(e){if(typeof e=="number")return Math.sinh(e);throw new on("CPU implementation for sinh on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var p1=D({name:"sinh",signature:e=>({argTypes:[e],returnType:e}),normalImpl:h1,codegenImpl:e=>S`sinh(${e})`});function d1(e,t,n){return typeof n=="number"?Er(e,t,n):ee.smoothstep[n.kind](e,t,n)}var Fc=D({name:"smoothstep",signature:(e,t,n)=>({argTypes:[e,t,n],returnType:n}),normalImpl:d1,codegenImpl:(e,t,n)=>S`smoothstep(${e}, ${t}, ${n})`});function f1(e){return typeof e=="number"?Math.sqrt(e):ee.sqrt[e.kind](e)}var gn=D({name:"sqrt",signature:e=>({argTypes:[e],returnType:e}),normalImpl:f1,codegenImpl:e=>S`sqrt(${e})`});function m1(e,t){if(typeof e=="number")return e<=t?1:0;throw new on("CPU implementation for step on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var Ya=D({name:"step",signature:(...e)=>{let t=ct(e,[$,ut,Pn])??e;return{argTypes:t,returnType:t[0]}},normalImpl:m1,codegenImpl:(e,t)=>S`step(${e}, ${t})`});function y1(e){if(typeof e=="number")return Math.tan(e);throw new on("CPU implementation for tan on vectors not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues")}var Ca=D({name:"tan",signature:e=>({argTypes:[e],returnType:e}),normalImpl:y1,codegenImpl:e=>S`tan(${e})`});function g1(e){return typeof e=="number"?Math.tanh(e):ee.tanh[e.kind](e)}var Lc=D({name:"tanh",signature:e=>({argTypes:[e],returnType:e}),normalImpl:g1,codegenImpl:e=>S`tanh(${e})`}),w1=D({name:"transpose",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for transpose not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`transpose(${e})`}),x1=D({name:"trunc",signature:e=>({argTypes:[e],returnType:e}),normalImpl:"CPU implementation for trunc not implemented yet. Please submit an issue at https://github.com/software-mansion/TypeGPU/issues",codegenImpl:e=>S`trunc(${e})`}),{NodeTypeCatalog:qe}=rf,v1=["==","!=","<","<=",">",">=","<<",">>","+","-","*","/","%","|","^","&","&&","||"],b1=["&&","||","==","!=","<","<=",">",">="],T1=["vec2f","vec3f","vec4f","vec2h","vec3h","vec4h","vec2i","vec3i","vec4i","vec2u","vec3u","vec4u","mat2x2f","mat3x3f","mat4x4f"],qa={add:ue,sub:K,mul:be,div:No};function $u(e,t,n){return n?b1.includes(t)?ke:t==="="?n:e:t==="!"||t==="~"?ke:e}var _1={"+":ue[E].gpuImpl,"-":K[E].gpuImpl,"*":be[E].gpuImpl,"/":No[E].gpuImpl,"**":wr[E].gpuImpl},$1=class{#e=void 0;initGenerator(t){this.#e=t}get ctx(){if(!this.#e)throw new Error("WGSL Generator has not yet been initialized. Please call initialize(ctx) before using the generator.");return this.#e}block([t,n]){this.ctx.pushBlockScope();try{this.ctx.indent();let r=n.map(s=>this.statement(s)).join(`
`);return this.ctx.dedent(),`{
${r}
${this.ctx.pre}}`}finally{this.ctx.popBlockScope()}}blockVariable(t,n){let r=B(this.ctx.makeNameValid(t),n);return this.ctx.defineVariable(t,r),r}identifier(t){if(!t)throw new Error("Cannot resolve an empty identifier");let n=this.ctx.getById(t);if(!n)throw new Error(`Identifier ${t} not found`);return n}typedExpression(t,n){let r=this.ctx.expectedType;this.ctx.expectedType=n;try{let s=this.expression(t);return Va(s,n)}finally{this.ctx.expectedType=r}}expression(t){if(typeof t=="string")return this.identifier(t);if(typeof t=="boolean")return B(t,ke);if(t[0]===qe.logicalExpr||t[0]===qe.binaryExpr||t[0]===qe.assignmentExpr){let[n,r,s,i]=t,p=this.expression(r),y=this.expression(i),v=_1[s];if(v)return v(p,y);let _=t[0]===qe.assignmentExpr?p.dataType.type==="ptr"?[p.dataType.inner]:[p.dataType]:void 0,[P,U]=As([p,y],_)??[p,y],N=this.ctx.resolve(P.value,P.dataType).value,j=this.ctx.resolve(U.value,U.dataType).value,L=$u(P.dataType,s,U.dataType);return B(v1.includes(s)?`(${N} ${s} ${j})`:`${N} ${s} ${j}`,L)}if(t[0]===qe.postUpdate){let[n,r,s]=t,i=this.expression(s),p=this.ctx.resolve(i.value,i.dataType).value;return B(`${p}${r}`,i.dataType)}if(t[0]===qe.unaryExpr){let[n,r,s]=t,i=this.expression(s),p=this.ctx.resolve(i.value,i.dataType).value,y=$u(i.dataType,r);return B(`${r}${p}`,y)}if(t[0]===qe.memberAccess){let[n,r,s]=t,i=this.expression(r);if(i.value===console)return B(new au(s),kt);if(T1.includes(i.dataType.type)&&s in qa)return{value:new su(s,i,qa[s][E].gpuImpl),dataType:kt};if(i.dataType.type==="unknown"){let p=i.value[s];return zi(p)}return Br(i.dataType)?B(`(*${this.ctx.resolve(i.value).value}).${s}`,Ra(i.dataType.inner,s)):Lt(i.dataType)&&s==="length"?i.dataType.elementCount===0?B(`arrayLength(&${this.ctx.resolve(i.value).value})`,J):B(String(i.dataType.elementCount),Zs):Ns(i.dataType)&&s==="columns"?B(new iu(i),kt):rr(i.dataType)&&Ze(i.value)?zi(i.value[s]):B(`${this.ctx.resolve(i.value).value}.${s}`,Ra(i.dataType,s))}if(t[0]===qe.indexAccess){let[n,r,s]=t,i=this.expression(r),p=this.expression(s),y=this.ctx.resolve(p.value,p.dataType).value;if(i.value instanceof iu)return B(S`${i.value.matrix}[${y}]`,ma(i.value.matrix.dataType));let v=this.ctx.resolve(i.value,i.dataType).value;if(i.dataType.type==="unknown"){if(Array.isArray(s)&&s[0]===qe.numericLiteral)return zi(i.value[s[1]]);throw new Error(`Unable to index a value of unknown type with index ${y}. If the value is an array, to address this, consider one of the following approaches: (1) declare the array using 'tgpu.const', (2) store the array in a buffer, or (3) define the array within the GPU function scope.`)}if(Ns(i.dataType))throw new Error("The only way of accessing matrix elements in TGSL is through the 'columns' property.");return Br(i.dataType)?B(`(*${v})[${y}]`,ma(i.dataType.inner)):B(`${v}[${y}]`,Dr(i.dataType)?ma(i.dataType):kt)}if(t[0]===qe.numericLiteral){let n=typeof t[1]=="string"?Ni(z1(t[1])):Ni(t[1]);if(!n)throw new Error(`Invalid numeric literal ${t[1]}`);return n}if(t[0]===qe.call){let[n,r,s]=t,i=this.expression(r);if(vt(i.value)||Lt(i.value)){if(s.length>1)throw new yn("Array and struct schemas should always be called with at most 1 argument");if(!s[0])return B(`${this.ctx.resolve(i.value).value}()`,i.value);let y=this.typedExpression(s[0],i.value);return B(this.ctx.resolve(y.value,i.value).value,i.value)}if(i.value===Na)throw new Error("Constants cannot be defined within TypeGPU function scope. To address this, move the constant definition outside the function scope.");if(i.value instanceof su){if(!s[0])throw new yn(`An infix operator '${i.value.name}' was called without any arguments`);let y=this.expression(s[0]);return i.value.operator(i.value.lhs,y)}if(!Ge(i.value)){let y=s.map(_=>this.expression(_)),v=this.ctx.shelllessRepo.get(i.value,y);if(v)return this.ctx.withResetIndentLevel(()=>{let _=this.ctx.resolve(v);return B(S`${_.value}(${y})`,_.dataType)});throw new Error(`Function '${W(i.value)??String(i.value)}' is not marked with the 'use gpu' directive and cannot be used in a shader`)}let p=i.value[E]?.argConversionHint??"keep";try{let y;if(Array.isArray(p))y=s.map((_,P)=>{let U=p[P];if(!U)throw new yn(`Function '${W(i.value)}' was called with too many arguments`);return this.typedExpression(_,U)});else{let _=s.map(P=>this.expression(P));p==="keep"?y=_:p==="unify"?y=As(_)??_:y=p(..._).map((P,U)=>[P,_[U]]).map(([P,U])=>Va(U,P))}if(i.value instanceof au)return this.ctx.generateLog(i.value.op,y);let v=i.value(...y);if(!yo(v))throw new Error("Functions running in codegen mode must return snippets");return v}catch(y){throw new Ms(y,[{toString:()=>W(i.value)}])}}if(t[0]===qe.objectExpr){let n=t[1],r=this.ctx.expectedType;if(!r||!vt(r))throw new yn(`No target type could be inferred for object with keys [${Object.keys(n).join(", ")}], please wrap the object in the corresponding schema.`);let s=Object.fromEntries(Object.entries(r.propTypes).map(([p,y])=>{let v=n[p];if(v===void 0)throw new yn(`Missing property ${p} in object literal for struct ${r}`);let _=this.typedExpression(v,y);return[p,_]})),i=Np(r,s);return B(S`${this.ctx.resolve(r).value}(${i})`,r)}if(t[0]===qe.arrayExpr){let[n,r]=t,s=this.ctx.expectedType,i,p;if(Lt(s)){if(i=s.elementType,p=r.map(v=>this.typedExpression(v,i)),p.length!==s.elementCount)throw new yn(`Cannot create value of type '${s}' from an array of length: ${p.length}`)}else{let v=r.map(P=>this.expression(P));if(v.length===0)throw new yn("Cannot infer the type of an empty array literal.");let _=As(v);if(!_)throw new yn("The given values cannot be automatically converted to a common type. Consider wrapping the array in an appropriate schema");p=_,i=Ls(p[0]?.dataType)}let y=`array<${this.ctx.resolve(i).value}, ${p.length}>`;return B(S`${y}(${p})`,Cn[E].jsImpl(i,p.length))}if(t[0]===qe.stringLiteral)return B(t[1],kt);if(t[0]===qe.preUpdate)throw new Error("Cannot use pre-updates in TGSL.");M1(t)}functionDefinition(t){return this.block(t)}statement(t){if(typeof t=="string")return`${this.ctx.pre}${this.ctx.resolve(this.identifier(t).value).value};`;if(typeof t=="boolean")return`${this.ctx.pre}${t?"true":"false"};`;if(t[0]===qe.return){let n=t[1];if(n!==void 0){let r=this.ctx.topFunctionReturnType,s=r?this.typedExpression(n,r):this.expression(n);return er(s.dataType.type!=="unknown"),this.ctx.reportReturnType(s.dataType),S`${this.ctx.pre}return ${s};`}return`${this.ctx.pre}return;`}if(t[0]===qe.if){let[n,r,s,i]=t,p=this.typedExpression(r,ke),y=p.value===!1?void 0:this.block(wi(s)),v=p.value===!0||!i?void 0:this.block(wi(i));return p.value===!0?`${this.ctx.pre}${y}`:p.value===!1?v?`${this.ctx.pre}${v}`:"":v?S`\
${this.ctx.pre}if (${p}) ${y}
${this.ctx.pre}else ${v}`:S`${this.ctx.pre}if (${p}) ${y}`}if(t[0]===qe.let||t[0]===qe.const){let[n,r,s]=t,i=s!==void 0?this.expression(s):void 0;if(!i)throw new Error(`Cannot create variable '${r}' without an initial value.`);if(ms(i.dataType))throw new Error(`Cannot create variable '${r}' with loose data type.`);let p=this.blockVariable(r,Ls(i.dataType));return S`${this.ctx.pre}var ${p.value} = ${i};`}if(t[0]===qe.block)return this.block(t);if(t[0]===qe.for){let[n,r,s,i,p]=t,[y,v,_]=this.ctx.withResetIndentLevel(()=>[r?this.statement(r):void 0,s?this.typedExpression(s,ke):void 0,i?this.statement(i):void 0]),P=y?y.slice(0,-1):"",U=_?_.slice(0,-1):"",N=this.block(wi(p));return S`${this.ctx.pre}for (${P}; ${v}; ${U}) ${N}`}if(t[0]===qe.while){let[n,r,s]=t,i=this.typedExpression(r,ke),p=this.ctx.resolve(i.value).value,y=this.block(wi(s));return`${this.ctx.pre}while (${p}) ${y}`}return t[0]===qe.continue?`${this.ctx.pre}continue;`:t[0]===qe.break?`${this.ctx.pre}break;`:`${this.ctx.pre}${this.ctx.resolve(this.expression(t).value).value};`}};function M1(e){throw new Error(`'${Jt(e)}' was not handled by the WGSL generator.`)}function z1(e){return/^0x[0-9a-f]+$/i.test(e)?Number.parseInt(e):/^0b[01]+$/i.test(e)?Number.parseInt(e.slice(2),2):Number.parseFloat(e)}function wi(e){return typeof e!="object"||e[0]!==qe.block?[qe.block,[e]]:e}var E1=new $1,jc=E1,Yc=Object.defineProperty,S1=(e,t,n)=>t in e?Yc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,P1=(e,t)=>{for(var n in t)Yc(e,n,{get:t[n],enumerable:!0})},we=(e,t,n)=>S1(e,typeof t!="symbol"?t+"":t,n),U1={};P1(U1,{BufferReader:()=>pr,BufferWriter:()=>Fr,MaxValue:()=>ot,Measurer:()=>nt,UnresolvedReferenceError:()=>Pr,ValidationError:()=>ca,arrayOf:()=>O1,bool:()=>G1,byte:()=>j1,chars:()=>ry,concat:()=>oy,dynamicArrayOf:()=>ly,f16:()=>K1,f32:()=>ty,f32Array:()=>My,f64Array:()=>zy,generic:()=>iy,genericEnum:()=>ay,i16:()=>C1,i16Array:()=>_y,i32:()=>J1,i32Array:()=>$y,i8:()=>F1,i8Array:()=>Ty,keyed:()=>py,object:()=>sy,optional:()=>fy,string:()=>R1,tupleOf:()=>gy,u16:()=>W1,u16Array:()=>vy,u32:()=>H1,u32Array:()=>by,u8:()=>Jc,u8Array:()=>wy,u8ClampedArray:()=>xy});var Pr=class Cc extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Cc.prototype)}},ca=class qc extends Error{constructor(t){super(t),Object.setPrototypeOf(this,qc.prototype)}},A1=class{constructor(){we(this,"size",Number.NaN),we(this,"unbounded",this),we(this,"isUnbounded",!0)}add(){return this}fork(){return this}},I1=new A1,nt=class Wc{constructor(){we(this,"size",0),we(this,"unbounded",I1),we(this,"isUnbounded",!1)}add(t){return this.size+=t,this}fork(){const t=new Wc;return t.size=this.size,t}},ot=Symbol("The biggest (in amount of bytes needed) value a schema can represent"),Tt=class{constructor(){we(this,"__unwrapped")}resolveReferences(e){}seekProperty(e,t){return null}},B1=class{constructor(e){this.key=e}},Vs={STRING:"string",ENUM:"enum"},k1=class extends Tt{constructor(e,t){super(),this._unstableElementSchema=e,this.length=t,we(this,"elementSchema"),this.elementSchema=e}resolveReferences(e){this.elementSchema=e.resolve(this._unstableElementSchema)}write(e,t){if(t.length!==this.length)throw new ca(`Expected array of length ${this.length}, got ${t.length}`);for(const n of t)this.elementSchema.write(e,n)}read(e){const t=[];for(let n=0;n<this.length;++n)t.push(this.elementSchema.read(e));return t}get maxSize(){return this.elementSchema.measure(ot).size*this.length}measure(e,t=new nt){for(let n=0;n<this.length;++n)this.elementSchema.measure(e===ot?ot:e[n],t);return t}};function O1(e,t){return new k1(e,t)}var V1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",1)}read(e){return e.readBool()}write(e,t){e.writeBool(t)}measure(e,t=new nt){return t.add(1)}},G1=new V1,Xc=class zs extends Tt{static get _encoder(){return zs._cachedEncoder||(zs._cachedEncoder=new TextEncoder),zs._cachedEncoder}read(t){return t.readString()}write(t,n){t.writeString(n)}measure(t,n=new nt){if(t===ot)return n.unbounded;const r=zs._encoder.encode(t);return n.add(r.byteLength+1)}};we(Xc,"_cachedEncoder");var D1=Xc,R1=new D1,N1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",1)}read(e){return e.readInt8()}write(e,t){e.writeInt8(t)}measure(e,t=new nt){return t.add(1)}},F1=new N1,L1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",1)}read(e){return e.readUint8()}write(e,t){e.writeUint8(t)}measure(e,t=new nt){return t.add(1)}},Jc=new L1,j1=Jc,Y1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",2)}read(e){return e.readInt16()}write(e,t){e.writeInt16(t)}measure(e,t=new nt){return t.add(2)}},C1=new Y1,q1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",2)}read(e){return e.readUint16()}write(e,t){e.writeUint16(t)}measure(e,t=new nt){return t.add(2)}},W1=new q1,X1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",4)}read(e){return e.readInt32()}write(e,t){e.writeInt32(t)}measure(e,t=new nt){return t.add(4)}},J1=new X1,Z1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",4)}read(e){return e.readUint32()}write(e,t){e.writeUint32(t)}measure(e,t=new nt){return t.add(4)}},H1=new Z1,Q1=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",2)}read(e){return e.readFloat16()}write(e,t){e.writeFloat16(t)}measure(e,t=new nt){return t.add(2)}},K1=new Q1,ey=class extends Tt{constructor(){super(...arguments),we(this,"maxSize",4)}read(e){return e.readFloat32()}write(e,t){e.writeFloat32(t)}measure(e,t=new nt){return t.add(4)}},ty=new ey,ny=class extends Tt{constructor(e){super(),this.length=e}write(e,t){if(t.length!==this.length)throw new ca(`Expected char-string of length ${this.length}, got ${t.length}`);for(let n=0;n<t.length;++n)e.writeUint8(t.charCodeAt(n))}read(e){let t="";for(let n=0;n<this.length;++n)t+=String.fromCharCode(e.readByte());return t}measure(e,t=new nt){return t.add(this.length)}};function ry(e){return new ny(e)}function hr(e){return Object.entries(e)}function Zc(e,t){const n={};for(const[r,s]of hr(t))n[r]=e.resolve(s);return n}var Fo=class extends Tt{constructor(e){super(),this._properties=e,we(this,"properties"),this.properties=e}resolveReferences(e){this.properties=Zc(e,this._properties)}write(e,t){for(const[n,r]of hr(this.properties))r.write(e,t[n])}read(e){const t={};for(const[n,r]of hr(this.properties))t[n]=r.read(e);return t}get maxSize(){const e=new nt;for(const t of Object.values(this.properties))t.measure(ot,e);return e.size}measure(e,t=new nt){for(const[n,r]of hr(this.properties))r.measure(e===ot?ot:e[n],t);return t}seekProperty(e,t){let n=0;for(const[r,s]of hr(this.properties)){if(r===t)return{bufferOffset:n,schema:s};n+=s.measure(e).size}return null}};function sy(e){return new Fo(e)}var Hc=class extends Tt{constructor(e,t,n){super(),this.keyedBy=e,this._subTypeMap=n,we(this,"_baseObject"),we(this,"subTypeMap"),this._baseObject=new Fo(t),this.subTypeMap=n}resolveReferences(e){this._baseObject.resolveReferences(e),this.subTypeMap=Zc(e,this._subTypeMap)}write(e,t){const n=t.type,r=this.subTypeMap[n]||null;if(r===null)throw new Error(`Unknown sub-type '${n.toString()}' in among '${JSON.stringify(Object.keys(this.subTypeMap))}'`);this.keyedBy===Vs.ENUM?e.writeUint8(t.type):e.writeString(t.type),this._baseObject.write(e,t);for(const[s,i]of hr(r.properties))i.write(e,t[s])}read(e){const t=this.keyedBy===Vs.ENUM?e.readByte():e.readString(),n=this.subTypeMap[t]||null;if(n===null)throw new Error(`Unknown sub-type '${t}' in among '${JSON.stringify(Object.keys(this.subTypeMap))}'`);const r=this._baseObject.read(e);if(r.type=t,n!==null)for(const[s,i]of hr(n.properties))r[s]=i.read(e);return r}measure(e,t=new nt){if(this._baseObject.measure(e,t),this.keyedBy===Vs.ENUM)t.add(1);else if(e!==ot)t.add(e.type.length+1);else return t.unbounded;if(e===ot){const n=Object.values(this.subTypeMap).map(r=>{const s=t.fork();for(const i of Object.values(r.properties))i.measure(ot,s);return[r,s.size]}).reduce((r,s)=>r[1]>s[1]?r:s)[0];for(const r of Object.values(n.properties))r.measure(ot,t)}else{const n=e.type,r=this.subTypeMap[n]||null;if(r===null)throw new Error(`Unknown sub-type '${n.toString()}', expected one of '${JSON.stringify(Object.keys(this.subTypeMap))}'`);for(const[s,i]of hr(r.properties))i.measure(e[s],t)}return t}};function iy(e,t){return new Hc(Vs.STRING,e,t)}function ay(e,t){return new Hc(Vs.ENUM,e,t)}function oy(e){return new Fo(Object.fromEntries(e.flatMap(({properties:t})=>Object.entries(t))))}var uy=class extends Tt{constructor(e){super(),this._unstableElementType=e,we(this,"elementType"),this.elementType=e}resolveReferences(e){this.elementType=e.resolve(this._unstableElementType)}write(e,t){e.writeUint32(t.length);for(const n of t)this.elementType.write(e,n)}read(e){const t=[],n=e.readUint32();for(let r=0;r<n;++r)t.push(this.elementType.read(e));return t}get maxSize(){return this.measure(ot).size}measure(e,t=new nt){if(e===ot)return t.unbounded;t.add(4);for(const n of e)this.elementType.measure(n,t);return t}seekProperty(e,t){if(typeof t=="symbol")return null;const n=Number.parseInt(String(t),10);if(Number.isNaN(n))return null;if(e===ot)return{bufferOffset:this.elementType.measure(ot).size*n,schema:this.elementType};if(n>=e.length)return null;const r=new nt;for(let s=0;s<n;++s)this.elementType.measure(e[s],r);return{bufferOffset:r.size,schema:this.elementType}}};function ly(e){return new uy(e)}var Qc=class{constructor(e){we(this,"__unwrapped"),we(this,"ref"),this.ref=new B1(e)}resolveReferences(){throw new Pr("Tried to resolve a reference directly. Do it through a RefResolver instead.")}read(){throw new Pr("Tried to read a reference directly. Resolve it instead.")}write(){throw new Pr("Tried to write a reference directly. Resolve it instead.")}measure(){throw new Pr("Tried to measure size of a reference directly. Resolve it instead.")}seekProperty(){throw new Pr("Tried to seek property of a reference directly. Resolve it instead.")}},cy=class{constructor(){we(this,"registry",{})}hasKey(e){return this.registry[e]!==void 0}register(e,t){this.registry[e]=t}resolve(e){if(e instanceof Qc){const n=e.ref.key;if(this.registry[n]!==void 0)return this.registry[n];throw new Pr(`Couldn't resolve reference to ${n}. Unknown key.`)}return e.resolveReferences(this),e}},hy=class{constructor(e,t){this.key=e,we(this,"__unwrapped"),we(this,"__keyDefinition"),we(this,"innerType"),this.innerType=t(new Qc(e)),this.resolveReferences(new cy)}resolveReferences(e){e.hasKey(this.key)||(e.register(this.key,this.innerType),this.innerType.resolveReferences(e))}read(e){return this.innerType.read(e)}write(e,t){this.innerType.write(e,t)}get maxSize(){return this.measure(ot).size}measure(e,t=new nt){return this.innerType.measure(e,t)}seekProperty(e,t){return this.innerType.seekProperty(e,t)}};function py(e,t){return new hy(e,t)}var dy=class extends Tt{constructor(e){super(),this._innerUnstableSchema=e,we(this,"innerSchema"),this.innerSchema=e}resolveReferences(e){this.innerSchema=e.resolve(this._innerUnstableSchema)}write(e,t){t!=null?(e.writeBool(!0),this.innerSchema.write(e,t)):e.writeBool(!1)}read(e){if(e.readBool())return this.innerSchema.read(e)}get maxSize(){return this.measure(ot).size}measure(e,t=new nt){return e!==void 0&&this.innerSchema.measure(e,t),t.add(1)}};function fy(e){return new dy(e)}function my(e,t){return t.map(n=>e.resolve(n))}var yy=class extends Tt{constructor(e){super(),this._unstableSchemas=e,we(this,"schemas"),this.schemas=e}resolveReferences(e){this.schemas=my(e,this._unstableSchemas)}write(e,t){if(t.length!==this.schemas.length)throw new ca(`Expected tuple of length ${this.schemas.length}, got ${t.length}`);for(let n=0;n<this.schemas.length;++n)this.schemas[n].write(e,t[n])}read(e){const t=[];for(let n=0;n<this.schemas.length;++n)t.push(this.schemas[n].read(e));return t}get maxSize(){return this.measure(ot).size}measure(e,t=new nt){for(let n=0;n<this.schemas.length;++n)this.schemas[n].measure(e===ot?ot:e[n],t);return t}};function gy(e){return new yy(e)}var ur=class extends Tt{constructor(e,t){super(),this.length=e,this._arrayConstructor=t,we(this,"byteLength"),this.byteLength=e*t.BYTES_PER_ELEMENT}write(e,t){e.writeSlice(t)}read(e){const t=new ArrayBuffer(this.byteLength),n=new this._arrayConstructor(t,0,this.length);return e.readSlice(n,0,this.byteLength),n}measure(e,t=new nt){return t.add(this.byteLength)}},wy=e=>new ur(e,Uint8Array),xy=e=>new ur(e,Uint8ClampedArray),vy=e=>new ur(e,Uint16Array),by=e=>new ur(e,Uint32Array),Ty=e=>new ur(e,Int8Array),_y=e=>new ur(e,Int16Array),$y=e=>new ur(e,Int32Array),My=e=>new ur(e,Float32Array),zy=e=>new ur(e,Float64Array);function Ey(){const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return t[0]=1,e[0]===0}function Kc(){return Ey()?"big":"little"}function Lo(e){let t=0,n=e;return n&&"buffer"in n&&"byteOffset"in n&&(t+=n.byteOffset,n=n.buffer),{buffer:n,byteOffset:t,byteLength:e.byteLength}}var eh=class{constructor(e,t){we(this,"dataView"),we(this,"littleEndian"),we(this,"byteOffset",0),we(this,"endianness");const{byteOffset:n=0,endianness:r="system"}=t??{};this.byteOffset=n;const s=Kc();this.endianness=r==="system"?s:r,this.littleEndian=this.endianness==="little";const i=Lo(e);this.byteOffset+=i.byteOffset,this.dataView=new DataView(i.buffer)}get currentByteOffset(){return this.byteOffset}seekTo(e){this.byteOffset=e}skipBytes(e){this.byteOffset+=e}};function Sy(e){if(e===0)return 0;if(Number.isNaN(e))return 32256;if(!Number.isFinite(e))return e>0?31744:64512;const t=e<0?1:0,n=Math.abs(e),r=Math.floor(Math.log2(n)),s=n/2**r-1,i=r+15,p=Math.floor(s*1024);return t<<15|i<<10|p}function Py(e){const t=(e&32768)>>15,n=(e&31744)>>10,r=e&1023;return n===0?t===0?r/1024:-r/1024:n===31?r===0?t===0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Number.NaN:(t===0?1:-1)*(1+r/1024)*2**(n-15)}var pr=class extends eh{constructor(){super(...arguments),we(this,"_cachedTextDecoder")}get _textDecoder(){return this._cachedTextDecoder||(this._cachedTextDecoder=new TextDecoder(void 0,{fatal:!0})),this._cachedTextDecoder}readBool(){return this.dataView.getUint8(this.byteOffset++)!==0}readByte(){return this.dataView.getUint8(this.byteOffset++)}readInt8(){return this.dataView.getInt8(this.byteOffset++)}readUint8(){return this.dataView.getUint8(this.byteOffset++)}readInt16(){const e=this.dataView.getInt16(this.byteOffset,this.littleEndian);return this.byteOffset+=2,e}readUint16(){const e=this.dataView.getUint16(this.byteOffset,this.littleEndian);return this.byteOffset+=2,e}readInt32(){const e=this.dataView.getInt32(this.byteOffset,this.littleEndian);return this.byteOffset+=4,e}readUint32(){const e=this.dataView.getUint32(this.byteOffset,this.littleEndian);return this.byteOffset+=4,e}readFloat16(){const e=this.dataView.getUint16(this.byteOffset,this.littleEndian);return this.byteOffset+=2,Py(e)}readFloat32(){const e=this.dataView.getFloat32(this.byteOffset,this.littleEndian);return this.byteOffset+=4,e}readString(){let e=0;for(;this.byteOffset+e<this.dataView.byteLength&&this.dataView.getUint8(this.byteOffset+e++)!==0;);const t=this._textDecoder.decode(new Uint8Array(this.dataView.buffer,this.byteOffset,e-1));return this.byteOffset+=e,t}readSlice(e,t,n){const r=Lo(e),s=new Uint8Array(r.buffer,r.byteOffset+t);for(let i=0;i<n;++i)s[i]=this.dataView.getUint8(this.byteOffset++)}},Fr=class extends eh{constructor(){super(...arguments),we(this,"_cachedTextEncoder")}get _textEncoder(){return this._cachedTextEncoder||(this._cachedTextEncoder=new TextEncoder),this._cachedTextEncoder}writeBool(e){this.dataView.setUint8(this.byteOffset++,e?1:0)}writeByte(e){this.dataView.setUint8(this.byteOffset++,e)}writeInt8(e){this.dataView.setInt8(this.byteOffset++,e)}writeUint8(e){this.dataView.setUint8(this.byteOffset++,e)}writeInt16(e){this.dataView.setInt16(this.byteOffset,e,this.littleEndian),this.byteOffset+=2}writeUint16(e){this.dataView.setUint16(this.byteOffset,e,this.littleEndian),this.byteOffset+=2}writeInt32(e){this.dataView.setInt32(this.byteOffset,e,this.littleEndian),this.byteOffset+=4}writeUint32(e){this.dataView.setUint32(this.byteOffset,e,this.littleEndian),this.byteOffset+=4}writeFloat16(e){this.dataView.setUint16(this.byteOffset,Sy(e),this.littleEndian),this.byteOffset+=2}writeFloat32(e){this.dataView.setFloat32(this.byteOffset,e,this.littleEndian),this.byteOffset+=4}writeString(e){const t=this._textEncoder.encodeInto(e,new Uint8Array(this.dataView.buffer,this.byteOffset));this.byteOffset+=t.written,this.dataView.setUint8(this.byteOffset++,0)}writeSlice(e){const t=Lo(e),n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);for(const r of n)this.dataView.setUint8(this.byteOffset++,r)}},th=D({name:"bitcastU32toF32",normalImpl:(e=>typeof e=="number"?Gn(e):ee.bitcastU32toF32[e.kind](e)),codegenImpl:e=>S`bitcast<f32>(${e})`,signature:(...e)=>{let t=ct(e,[J])??e;return{argTypes:t,returnType:rr(t[0])?t[0].type==="vec2u"?G:t[0].type==="vec3u"?O:k:$}}}),nh=D({name:"bitcastU32toI32",normalImpl:(e=>typeof e=="number"?Dn(e):ee.bitcastU32toI32[e.kind](e)),codegenImpl:e=>S`bitcast<i32>(${e})`,signature:(...e)=>{let t=ct(e,[J])??e;return{argTypes:t,returnType:rr(t[0])?t[0].type==="vec2u"?Be:t[0].type==="vec3u"?Ot:Le:Ae}}}),rh=ce(e=>{let t=new ArrayBuffer(4);new Fr(t).writeUint32(e);let n=new pr(t);return G(n.readFloat16(),n.readFloat16())},e=>B(S`unpack2x16float(${e})`,G),"unpack2x16float"),Uy=ce(e=>{let t=new ArrayBuffer(4),n=new Fr(t);n.writeFloat16(e.x),n.writeFloat16(e.y);let r=new pr(t);return J(r.readUint32())},e=>B(S`pack2x16float(${e})`,J),"pack2x16float"),Ay=ce(e=>{let t=new ArrayBuffer(4);new Fr(t).writeUint32(e);let n=new pr(t);return k(n.readUint8()/255,n.readUint8()/255,n.readUint8()/255,n.readUint8()/255)},e=>B(S`unpack4x8unorm(${e})`,k),"unpack4x8unorm"),Iy=ce(e=>{let t=new ArrayBuffer(4),n=new Fr(t);n.writeUint8(e.x*255),n.writeUint8(e.y*255),n.writeUint8(e.z*255),n.writeUint8(e.w*255);let r=new pr(t);return J(r.readUint32())},e=>B(S`pack4x8unorm(${e})`,J),"pack4x8unorm");function ws(e){return e.type.includes("2")?br:e.type.includes("3")?Tr:_r}var sh=D({name:"allEq",signature:(...e)=>({argTypes:e,returnType:ke}),normalImpl:(e,t)=>Yo(si(e,t)),codegenImpl:(e,t)=>S`all(${e} == ${t})`}),si=(e,t)=>ee.eq[e.kind](e,t),By=D({name:"eq",signature:(...e)=>({argTypes:e,returnType:ws(e[0])}),normalImpl:si,codegenImpl:(e,t)=>S`(${e} == ${t})`}),ky=D({name:"ne",signature:(...e)=>({argTypes:e,returnType:ws(e[0])}),normalImpl:(e,t)=>nr(si(e,t)),codegenImpl:(e,t)=>S`(${e} != ${t})`}),ha=(e,t)=>ee.lt[e.kind](e,t),Oy=D({name:"lt",signature:(...e)=>({argTypes:e,returnType:ws(e[0])}),normalImpl:ha,codegenImpl:(e,t)=>S`(${e} < ${t})`}),Vy=D({name:"le",signature:(...e)=>({argTypes:e,returnType:ws(e[0])}),normalImpl:(e,t)=>jo(ha(e,t),si(e,t)),codegenImpl:(e,t)=>S`(${e} <= ${t})`}),Gy=D({name:"gt",signature:(...e)=>({argTypes:e,returnType:ws(e[0])}),normalImpl:(e,t)=>ih(nr(ha(e,t)),nr(si(e,t))),codegenImpl:(e,t)=>S`(${e} > ${t})`}),Dy=D({name:"ge",signature:(...e)=>({argTypes:e,returnType:ws(e[0])}),normalImpl:(e,t)=>nr(ha(e,t)),codegenImpl:(e,t)=>S`(${e} >= ${t})`}),nr=e=>ee.neg[e.kind](e),Ry=D({name:"not",signature:(...e)=>({argTypes:e,returnType:e[0]}),normalImpl:nr,codegenImpl:e=>S`!(${e})`}),jo=(e,t)=>ee.or[e.kind](e,t),Ny=D({name:"or",signature:(...e)=>({argTypes:e,returnType:e[0]}),normalImpl:jo,codegenImpl:(e,t)=>S`(${e} | ${t})`}),ih=(e,t)=>nr(jo(nr(e),nr(t))),Fy=D({name:"and",signature:(...e)=>({argTypes:e,returnType:e[0]}),normalImpl:ih,codegenImpl:(e,t)=>S`(${e} & ${t})`}),Yo=e=>ee.all[e.kind](e),Ly=D({name:"all",signature:(...e)=>({argTypes:e,returnType:ke}),normalImpl:Yo,codegenImpl:e=>S`all(${e})`}),jy=D({name:"any",signature:(...e)=>({argTypes:e,returnType:ke}),normalImpl:e=>!Yo(nr(e)),codegenImpl:e=>S`any(${e})`}),Yy=D({name:"isCloseTo",signature:(...e)=>({argTypes:e,returnType:ke}),normalImpl:(e,t,n=.01)=>typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<n:Ze(e)&&Ze(t)?ee.isCloseToZero[e.kind](K[E].jsImpl(e,t),n):!1,codegenImpl:(e,t,n=B(.01,$))=>fi(e)&&fi(t)?S`(abs(f32(${e}) - f32(${t})) <= ${n})`:!fi(e)&&!fi(t)?S`all(abs(${e} - ${t}) <= (${e} - ${e}) + ${n})`:"false"});function Cy(e,t,n){return typeof n=="boolean"?n?t:e:ee.select[e.kind](e,t,n)}var Cs=D({name:"select",signature:(e,t,n)=>{let[r,s]=ct([e,t])??[e,t];return{argTypes:[r,s,n],returnType:r}},normalImpl:Cy,codegenImpl:(e,t,n)=>S`select(${e}, ${t}, ${n})`}),xs={r8unorm:{channelType:$,vectorType:k,texelSize:1,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only","read-write"]},r8snorm:{channelType:$,vectorType:k,texelSize:1,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only"]},r8uint:{channelType:J,vectorType:Ce,texelSize:1,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},r8sint:{channelType:Ae,vectorType:Le,texelSize:1,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rg8unorm:{channelType:$,vectorType:k,texelSize:2,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only"]},rg8snorm:{channelType:$,vectorType:k,texelSize:2,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only"]},rg8uint:{channelType:J,vectorType:Ce,texelSize:2,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rg8sint:{channelType:Ae,vectorType:Le,texelSize:2,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rgba8unorm:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only","read-write"]},"rgba8unorm-srgb":{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:null},rgba8snorm:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rgba8uint:{channelType:J,vectorType:Ce,texelSize:4,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rgba8sint:{channelType:Ae,vectorType:Le,texelSize:4,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},bgra8unorm:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only"]},"bgra8unorm-srgb":{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:null},r16unorm:{channelType:$,vectorType:k,texelSize:2,sampleTypes:["unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},r16snorm:{channelType:$,vectorType:k,texelSize:2,sampleTypes:["unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},r16uint:{channelType:J,vectorType:Ce,texelSize:2,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},r16sint:{channelType:Ae,vectorType:Le,texelSize:2,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},r16float:{channelType:$,vectorType:k,texelSize:2,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only","read-write"]},rg16unorm:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rg16snorm:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rg16uint:{channelType:J,vectorType:Ce,texelSize:4,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rg16sint:{channelType:Ae,vectorType:Le,texelSize:4,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rg16float:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only"]},rgba16unorm:{channelType:$,vectorType:k,texelSize:8,sampleTypes:["unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rgba16snorm:{channelType:$,vectorType:k,texelSize:8,sampleTypes:["unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rgba16uint:{channelType:J,vectorType:Ce,texelSize:8,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rgba16sint:{channelType:Ae,vectorType:Le,texelSize:8,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rgba16float:{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only","read-write"]},r32uint:{channelType:J,vectorType:Ce,texelSize:4,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},r32sint:{channelType:Ae,vectorType:Le,texelSize:4,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},r32float:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rg32uint:{channelType:J,vectorType:Ce,texelSize:8,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only"]},rg32sint:{channelType:Ae,vectorType:Le,texelSize:8,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only"]},rg32float:{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rgba32uint:{channelType:J,vectorType:Ce,texelSize:16,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rgba32sint:{channelType:Ae,vectorType:Le,texelSize:16,sampleTypes:["sint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rgba32float:{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!1,canResolve:!1,storageBindings:["write-only","read-only","read-write"]},rgb10a2uint:{channelType:J,vectorType:Ce,texelSize:4,sampleTypes:["uint"],aspects:["color"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:["write-only","read-only"]},rgb10a2unorm:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only"]},rg11b10ufloat:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!0,canBlend:!0,canMultisample:!0,canResolve:!0,storageBindings:["write-only","read-only"]},rgb9e5ufloat:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},stencil8:{channelType:J,vectorType:Ce,texelSize:1,sampleTypes:["uint"],aspects:["stencil"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:null},depth16unorm:{channelType:$,vectorType:k,texelSize:2,sampleTypes:["depth","unfilterable-float"],aspects:["depth"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:null},depth24plus:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["depth","unfilterable-float"],aspects:["depth"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:null},"depth24plus-stencil8":{channelType:$,vectorType:k,texelSize:4,sampleTypes:["depth","unfilterable-float"],aspects:["depth","stencil"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:null},depth32float:{channelType:$,vectorType:k,texelSize:4,sampleTypes:["depth","unfilterable-float"],aspects:["depth"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:null},"depth32float-stencil8":{channelType:$,vectorType:k,texelSize:4,sampleTypes:["depth","unfilterable-float"],aspects:["depth","stencil"],canRenderAttachment:!0,canBlend:!1,canMultisample:!0,canResolve:!1,storageBindings:null},"bc1-rgba-unorm":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc1-rgba-unorm-srgb":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc2-rgba-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc2-rgba-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc3-rgba-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc3-rgba-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc4-r-unorm":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc4-r-snorm":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc5-rg-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc5-rg-snorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc6h-rgb-ufloat":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc6h-rgb-float":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc7-rgba-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"bc7-rgba-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"etc2-rgb8unorm":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"etc2-rgb8unorm-srgb":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"etc2-rgb8a1unorm":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"etc2-rgb8a1unorm-srgb":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"etc2-rgba8unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"etc2-rgba8unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"eac-r11unorm":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"eac-r11snorm":{channelType:$,vectorType:k,texelSize:8,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"eac-rg11unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"eac-rg11snorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-4x4-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-4x4-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-5x4-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-5x4-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-5x5-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-5x5-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-6x5-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-6x5-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-6x6-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-6x6-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-8x5-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-8x5-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-8x6-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-8x6-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-8x8-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-8x8-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x5-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x5-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x6-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x6-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x8-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x8-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x10-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-10x10-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-12x10-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-12x10-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-12x12-unorm":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null},"astc-12x12-unorm-srgb":{channelType:$,vectorType:k,texelSize:16,sampleTypes:["float","unfilterable-float"],aspects:["color"],canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1,storageBindings:null}};function ah(e,t){let n=xs[e];if(!n)throw new Error(`Unknown texture format: ${e}`);let r={...n};switch(e){case"r32float":case"rg32float":case"rgba32float":t.features.has("float32-filterable")||(r={...r,sampleTypes:n.sampleTypes.filter(s=>s!=="float")}),t.features.has("float32-blendable")||(r={...r,canBlend:!1});break;case"bgra8unorm":t.features.has("bgra8unorm-storage")||(r={...r,storageBindings:null});break;case"rg11b10ufloat":t.features.has("rg11b10ufloat-renderable")||(r={...r,canRenderAttachment:!1,canBlend:!1,canMultisample:!1,canResolve:!1});break}if(r.storageBindings){let s=t.features.has("texture-formats-tier1"),i=t.features.has("texture-formats-tier2"),p=[...r.storageBindings],y=["r8unorm","r8uint","r8sint","r16uint","r16sint","r16float","rgba8unorm","rgba8uint","rgba8sint","rgba16uint","rgba16sint","rgba16float","r32uint","r32sint","r32float","rgba32uint","rgba32sint","rgba32float"],v=["r8snorm","rg8unorm","rg8snorm","rg8uint","rg8sint","rgba8snorm","r16unorm","r16snorm","rg16unorm","rg16snorm","rg16uint","rg16sint","rg16float","rgba16unorm","rgba16snorm","rgb10a2uint","rgb10a2unorm","rg11b10ufloat"];y.includes(e)&&!i&&(p=p.filter(_=>_!=="read-write")),v.includes(e)&&!s&&(p=p.filter(_=>_!=="write-only"&&_!=="read-only")),r={...r,storageBindings:p.length>0?p:null}}return r}var Co=["f16","clip_distances","dual_source_blending","subgroups","primitive_index"],oh={f16:"shader-f16",clip_distances:"clip-distances",dual_source_blending:"dual-source-blending",subgroups:"subgroups",primitive_index:"primitive-index"};function qy(e){return new Wy(e)}var Wy=class{constructor(t){this.declaration=t}[E]=!0;externalsToApply=[];$uses(t){return this.externalsToApply.push(t),this}[he](t){let n={};for(let s of this.externalsToApply)Is(n,s);let r=ta(t,n,this.declaration);return t.addDeclaration(r),B("",at)}toString(){return`declare: ${this.declaration}`}};function uh(e){let t={argTypes:e.in&&Object.keys(e.in).length!==0?[ti(e.in)]:[],returnType:at,workgroupSize:[e.workgroupSize[0]??1,e.workgroupSize[1]??1,e.workgroupSize[2]??1],isEntry:!0},n=(r,...s)=>Xy(t,e.workgroupSize,na(r,...s));return Object.assign(Object.assign(n,t),{does:n})}function Xy(e,t,n){let r=ei(n,`@compute @workgroup_size(${t.join(", ")}) `),s=e.argTypes[0];return{shell:e,$uses(i){return r.applyExternals(i),this},[E]:!0,[st]:r,$name(i){return Fe(r,i),Qi(s)&&s.$name(`${i}_Input`),this},[he](i){return r.resolve(i,e.argTypes,e.returnType)},toString(){return`computeFn:${W(r)??"<unnamed>"}`}}}function Ve(e,t){let n={[E]:!0,argTypes:e,returnType:t??at,isEntry:!1};return Object.assign((r,...s)=>Zy(n,na(r,...s)),n)}function lh(e){return Ge(e)&&e?.resourceType==="function"}function Jy([e,t]){return`${W(e)??"<unnamed>"}=${t}`}function Zy(e,t){let n=ei(t,""),r={shell:e,resourceType:"function",$uses(p){return n.applyExternals(p),this},[st]:n,$name(p){return Fe(n,p),this},with(p,y){return ch(i,[[ea(p)?p.slot:p,y]])},[he](p){return typeof t=="string"&&(sf(t,e.argTypes,n.applyExternals),yc(t,e.returnType,n.applyExternals)),n.resolve(p,e.argTypes,e.returnType)}},s=ce((...p)=>Vp(()=>{try{if(typeof t=="string")throw new Error("Cannot execute on the CPU functions constructed with raw WGSL");let y=p.map((_,P)=>kr(e.argTypes[P],_)),v=t(...y);return kr(e.returnType,v)}catch(y){throw y instanceof ou?y.appendToTrace(i):new ou(y,[i])}}),(...p)=>B(new hh(i,p),e.returnType),"tgpuFnCall",e.argTypes),i=Object.assign(s,r);return i[E].implementation=t,Object.defineProperty(i,"toString",{value(){return`fn:${W(n)??"<unnamed>"}`}}),i}function ch(e,t){let n={resourceType:"function",shell:e.shell,[Ar]:{inner:e,pairs:t},$uses(i){return e.$uses(i),this},[st]:e,$name(i){return e.$name(i),this},with(i,p){return ch(s,[...t,[ea(i)?i.slot:i,p]])}},r=ce((...i)=>e(...i),(...i)=>B(new hh(s,i),e.shell.returnType),"tgpuFnCall",e.shell.argTypes),s=Object.assign(r,n);return s[E].implementation=e[E].implementation,Object.defineProperty(s,"toString",{value(){return`fn:${W(e)??"<unnamed>"}[${t.map(Jy).join(", ")}]`}}),s[E].implementation=e[E].implementation,s}var hh=class{[E]=!0;[Xt];[st];#e;#t;constructor(t,n){this.#e=t,this.#t=n,this[st]=t,this[Xt]=B(this,this.#e.shell.returnType)}[he](t){return t.withResetIndentLevel(()=>B(S`${t.resolve(this.#e).value}(${this.#t})`,this.#e.shell.returnType))}toString(){return`call:${W(this)??"<unnamed>"}`}};function Hy(e){let t={in:e.in,out:e.out,returnType:ti(e.out),isEntry:!0},n=(r,...s)=>Qy(t,na(r,...s));return Object.assign(Object.assign(n,t),{does:n})}function Qy(e,t){let n=ei(t,"@fragment "),r=e.returnType;return typeof t=="string"&&yc(t,r,s=>n.applyExternals(s)),{shell:e,outputType:r,$uses(s){return n.applyExternals(s),this},[E]:!0,[st]:n,$name(s){return Fe(n,s),Qi(r)&&r.$name(`${s}_Output`),this},[he](s){let i=e.in?ti(e.in,s.varyingLocations).$name(`${W(this)??""}_Input`):void 0;return i&&n.applyExternals({In:i}),n.applyExternals({Out:r}),n.resolve(s,i?[i]:[],e.returnType)},toString(){return`fragmentFn:${W(n)??"<unnamed>"}`}}}var ph=new Set(["alias","break","case","const","const_assert","continue","continuing","default","diagnostic","discard","else","enable","false","fn","for","if","let","loop","override","requires","return","struct","switch","true","var","while","NULL","Self","abstract","active","alignas","alignof","as","asm","asm_fragment","async","attribute","auto","await","become","cast","catch","class","co_await","co_return","co_yield","coherent","column_major","common","compile","compile_fragment","concept","const_cast","consteval","constexpr","constinit","crate","debugger","decltype","delete","demote","demote_to_helper","do","dynamic_cast","enum","explicit","export","extends","extern","external","fallthrough","filter","final","finally","friend","from","fxgroup","get","goto","groupshared","highp","impl","implements","import","inline","instanceof","interface","layout","lowp","macro","macro_rules","match","mediump","meta","mod","module","move","mut","mutable","namespace","new","nil","noexcept","noinline","nointerpolation","non_coherent","noncoherent","noperspective","null","nullptr","of","operator","package","packoffset","partition","pass","patch","pixelfragment","precise","precision","premerge","priv","protected","pub","public","readonly","ref","regardless","register","reinterpret_cast","require","resource","restrict","self","set","shared","sizeof","smooth","snorm","static","static_assert","static_cast","std","subroutine","super","target","template","this","thread_local","throw","trait","try","type","typedef","typeid","typename","typeof","union","unless","unorm","unsafe","unsized","use","using","varying","virtual","volatile","wgsl","where","with","writeonly","yield"]);function dh(e){if(e==="_"||e.startsWith("__")||/\s/.test(e))throw new Error(`Invalid identifier '${e}'. Choose an identifier without whitespaces or leading underscores.`);let t=e.split("_")[0];return!ph.has(t)}var fh=class{makeValid(t){return dh(t)?t:this.makeUnique(t)}},Ky=class extends fh{lastUniqueId=0;makeUnique(t){let n;return t?(n=t.replaceAll(/\s/g,"_"),n=n.replaceAll(/[^\w\d]/g,"")):n="item",`${n}_${this.lastUniqueId++}`}},eg=class extends fh{_usedNames=new Set(ph);makeUnique(t){if(t===void 0)throw new Error("Unnamed item found when using a strict name registry");let n=0,r=t;for(;this._usedNames.has(r);)n++,r=`${t}_${n}`;return this._usedNames.add(r),r}};function tg(e,t){let n=ei(t,"");return{[E]:!0,[st]:n,resourceType:"shellless-impl",[he](r){return n.resolve(r,e,void 0)},toString(){return`fn*:${W(n)??"<unnamed>"}`}}}var ng=class{cache=new Map;get(t,n){let r=Ki(t);if(!r?.ast)return;if(!n&&r.ast.params.length>0)throw new Error(`Cannot resolve '${W(t)}' directly, because it expects arguments. Either call it from another function, or wrap it in a shell`);let s=(n??[]).map(y=>Ls(y.dataType)),i=this.cache.get(t);if(i){let y=i.find(v=>v.argTypes.every((_,P)=>_===s[P]));if(y)return y.value}else i=[],this.cache.set(t,i);let p=tg(s,t);return i.push({argTypes:s,value:p}),p}},rg=class{[E];constructor(t){this[E]={nameRegistry:t,shelllessRepo:new ng,memoizedResolves:new WeakMap,memoizedDerived:new WeakMap,listeners:{name:new Set}}}on(t,n){if(t==="name"){let r=this[E].listeners.name;return r.add(n),()=>r.delete(n)}throw new Error(`Unsupported event: ${t}`)}};function sg(e,t){let n=e.nameRegistry.makeUnique(W(t));for(let r of e.listeners.name)r({target:t,name:n});return n}function ii(e){let{names:t="random"}=e||{};return new rg(t==="strict"?new eg:new Ky)}function pa(e){return typeof e?.format=="string"}function ig(e,t){let n=[];if(Dr(e)){if(!pa(t))throw new Error("Shader expected a single attribute, not a record of attributes to be passed in.");return n.push(t._layout),{usedVertexLayouts:n,bufferDefinitions:[{arrayStride:t._layout.stride,stepMode:t._layout.stepMode,attributes:[{format:t.format,offset:t.offset,shaderLocation:yr(e)??0}]}]}}let r=[],s=new WeakMap,i=0;for(let[p,y]of Object.entries(e)){if(Nr(y))continue;let v=t[p];if(!v)throw new Error(`An attribute by the name of '${p}' was not provided to the shader.`);let _=v._layout,P=s.get(_);P||(n.push(_),P=[],r.push({arrayStride:_.stride,stepMode:_.stepMode,attributes:P}),s.set(_,P)),i=yr(y)??i,P.push({format:v.format,offset:v.offset,shaderLocation:i++})}return{usedVertexLayouts:n,bufferDefinitions:r}}var ag=["bool","f32","f16","i32","u32","vec2f","vec3f","vec4f","vec2h","vec3h","vec4h","vec2i","vec3i","vec4i","vec2u","vec3u","vec4u","vec2<bool>","vec3<bool>","vec4<bool>","mat2x2f","mat3x3f","mat4x4f","texture_external"];function og(e){return ag.includes(e.type)}function Wa(e,[t,n]){if(!dh(t))throw new Error(`Property key '${t}' is a reserved WGSL word. Choose a different name.`);return`  ${Vo(n)}${t}: ${e.resolve(n).value},
`}function ug(e,t){if(t[E].isAbstruct)throw new Error("Cannot resolve abstract struct types to WGSL.");let n=e.getUniqueName(t);return e.addDeclaration(`struct ${n} {
${Object.entries(t.propTypes).map(r=>Wa(e,r)).join("")}}`),n}function lg(e,t){let n=e.getUniqueName(t);return e.addDeclaration(`struct ${n} {
${Object.entries(t.propTypes).map(r=>pa(r[1])?Wa(e,[r[0],ar[r[1].format]]):Wa(e,r)).join("")}
}`),n}function cg(e,t){let n=e.resolve(t.elementType).value;return t.elementCount===0?`array<${n}>`:`array<${n}, ${t.elementCount}>`}function hg(e,t){let n=e.resolve(pa(t.elementType)?ar[t.elementType.format]:t.elementType).value;return t.elementCount===0?`array<${n}>`:`array<${n}, ${t.elementCount}>`}function mh(e,t){if(ms(t))return t.type==="unstruct"?lg(e,t):t.type==="disarray"?hg(e,t):t.type==="loose-decorated"?e.resolve(pa(t.inner)?ar[t.inner.format]:t.inner).value:e.resolve(ar[t.type]).value;if(og(t))return t.type;if(t.type==="struct")return ug(e,t);if(t.type==="array")return cg(e,t);if(t.type==="atomic")return`atomic<${mh(e,t.inner)}>`;if(t.type==="decorated")return e.resolve(t.inner).value;if(t.type==="ptr")return t.addressSpace==="storage"?`ptr<storage, ${e.resolve(t.inner).value}, ${t.access==="read-write"?"read_write":t.access}>`:`ptr<${t.addressSpace}, ${e.resolve(t.inner).value}>`;if(t.type==="abstractInt"||t.type==="abstractFloat"||t.type==="void"||t.type==="u16")throw new Error(`${t.type} has no representation in WGSL`);if(La(t))return`${t.type}<${t.format}, ${ni[t.access]}>`;if(Bc(t))return t.type.startsWith("texture_depth")?t.type:`${t.type}<${t.sampleType.type}>`;if(Bf(t)||If(t))return t.type;hs(t,"resolveData")}var yh=class Xa{constructor(t){this.bindings=t}with(t,n){return new Xa([...this.bindings,[ea(t)?t.slot:t,n]])}pipe(t){let n=t(this);return new Xa([...this.bindings,...n.bindings])}};function*pg(e){let t=0;for(;;)e.has(t)||(yield t),t++}function dg(e,t){let n="size"in e?e.size:e.currentByteOffset,r=t-1,s=n&r;"skipBytes"in e?e.skipBytes(t-s&r):e.add(t-s&r)}var mt=dg,Mu=new WeakMap;function gh(e){let t=Mu.get(e);if(t)return t;let n=new nt,r={},s;for(let i in e.propTypes){let p=e.propTypes[i];if(p===void 0)throw new Error(`Property ${i} is undefined in struct`);let y=n.size;mt(n,En(e)?wn(p):tt(p)),s&&(s.padding=n.size-y);let v=Me(p);r[i]={offset:n.size,size:v},s=r[i],n.add(v)}return s&&(s.padding=sn(Me(e),tt(e))-n.size),Mu.set(e,r),r}var fg=(()=>{try{return new Function("return true"),!0}catch{return!1}})(),ya=new WeakMap,xi={u32:"u32",vec2u:"u32",vec3u:"u32",vec4u:"u32",u16:"u16",i32:"i32",vec2i:"i32",vec3i:"i32",vec4i:"i32",f32:"f32",vec2f:"f32",vec3f:"f32",vec4f:"f32",f16:"f16",vec2h:"f16",vec3h:"f16",vec4h:"f16",mat2x2f:"f32",mat3x3f:"f32",mat4x4f:"f32"},mg={uint8:"u8",uint8x2:"u8",uint8x4:"u8",sint8:"i8",sint8x2:"i8",sint8x4:"i8",unorm8:"u8",unorm8x2:"u8",unorm8x4:"u8",snorm8:"i8",snorm8x2:"i8",snorm8x4:"i8",uint16:"u16",uint16x2:"u16",uint16x4:"u16",sint16:"i16",sint16x2:"i16",sint16x4:"i16",unorm16:"u16",unorm16x2:"u16",unorm16x4:"u16",snorm16:"i16",snorm16x2:"i16",snorm16x4:"i16",float16:"f16",float16x2:"f16",float16x4:"f16",float32:"f32",float32x2:"f32",float32x3:"f32",float32x4:"f32",uint32:"u32",uint32x2:"u32",uint32x3:"u32",uint32x4:"u32",sint32:"i32",sint32x2:"i32",sint32x3:"i32",sint32x4:"i32"},vi={u32:"setUint32",i32:"setInt32",f32:"setFloat32",u16:"setUint16",i16:"setInt16",f16:"setFloat16",u8:"setUint8",i8:"setInt8"},yg={unorm8:e=>`Math.round(${e} * 255)`,unorm8x2:e=>`Math.round(${e} * 255)`,unorm8x4:e=>`Math.round(${e} * 255)`,snorm8:e=>`Math.round(${e} * 127)`,snorm8x2:e=>`Math.round(${e} * 127)`,snorm8x4:e=>`Math.round(${e} * 127)`,unorm16:e=>`Math.round(${e} * 65535)`,unorm16x2:e=>`Math.round(${e} * 65535)`,unorm16x4:e=>`Math.round(${e} * 65535)`,snorm16:e=>`Math.round(${e} * 32767)`,snorm16x2:e=>`Math.round(${e} * 32767)`,snorm16x4:e=>`Math.round(${e} * 32767)`},zu={"unorm10-10-10-2":{writeFunction:"setUint32",generator:(e,t)=>`output.setUint32(${e}, ((${t}.x*1023&0x3FF)<<22)|((${t}.y*1023&0x3FF)<<12)|((${t}.z*1023&0x3FF)<<2)|(${t}.w*3&3), littleEndian);
`},"unorm8x4-bgra":{writeFunction:"setUint8",generator:(e,t)=>{let n=["z","y","x","w"],r="";for(let s=0;s<4;s++)r+=`output.setUint8((${e} + ${s}), Math.round(${t}.${n[s]} * 255), littleEndian);
`;return r}}};function Ei(e,t,n,r=0){let s=["i","j","k"][r]||`i${r}`;if(ki(e)||zn(e))return Ei(e.inner,t,n,r);if(vt(e)||En(e)){let p=gh(e),y="";for(let[v,_]of Object.entries(p)){let P=e.propTypes[v];P&&(y+=Ei(P,`(${t} + ${_.offset})`,`${n}.${v}`,r))}return y}if(Lt(e)||ir(e)){let p=sn(Me(e.elementType),tt(e)),y="";return y+=`for (let ${s} = 0; ${s} < ${e.elementCount}; ${s}++) {
`,y+=Ei(e.elementType,`(${t} + ${s} * ${p})`,`${n}[${s}]`,r+1),y+=`}
`,y}if(rr(e)){let p=xi[e.type],y="",v=vi[p],_=["x","y","z","w"],P=Ea(e)?2:Sa(e)?3:4;for(let U=0;U<P;U++)y+=`output.${v}((${t} + ${U*4}), ${n}.${_[U]}, littleEndian);
`;return y}if(Ns(e)){let p=xi[e.type],y=vi[p],v=Al(e)?2:Il(e)?3:4,_=v*v,P=sn(v*4,8),U="";for(let N=0;N<_;N++){let j=Math.floor(N/v),L=N%v,Z=j*P+L*4;U+=`output.${y}((${t} + ${Z}), ${n}.columns[${j}].${["x","y","z","w"][L]}, littleEndian);
`}return U}if(dc(e)){let p=e.type;if(p in zu)return zu[p].generator(t,n);let y=mg[p],v=vi[y],_=ar[p],P=Ul(_)?4:Sa(_)?3:Ea(_)?2:1,U=y==="u8"||y==="i8"?1:y==="u16"||y==="i16"||y==="f16"?2:4,N=["x","y","z","w"],j=yg[p],L="";for(let Z=0;Z<P;Z++){let Q=P===1?n:`${n}.${N[Z]}`,se=j?j(Q):Q;L+=`output.${v}((${t} + ${Z*U}), ${se}, littleEndian);
`}return L}if(!Object.hasOwn(xi,e.type))throw new Error(`Primitive ${e.type} is unsupported by compiled writer`);let i=xi[e.type];return`output.${vi[i]}(${t}, ${n}, littleEndian);
`}function Eu(e){if(!fg){console.warn("This environment does not allow eval - using default writer as fallback");return}if(ya.has(e))return ya.get(e);try{let t=Ei(e,"offset","value",0),n=new Function("output","offset","value","littleEndian=true",t);return ya.set(e,n),n}catch(t){console.warn(`Failed to compile writer for schema: ${e}
Reason: ${t instanceof Error?t.message:String(t)}
Falling back to default writer`)}}var ss={bool(){throw new Error("Booleans are not host-shareable")},f32(e,t,n){e.writeFloat32(n)},f16(e,t,n){e.writeFloat16(n)},i32(e,t,n){e.writeInt32(n)},u32(e,t,n){e.writeUint32(n)},u16(e,t,n){e.writeUint16(n)},vec2f(e,t,n){e.writeFloat32(n.x),e.writeFloat32(n.y)},vec2h(e,t,n){e.writeFloat16(n.x),e.writeFloat16(n.y)},vec2i(e,t,n){e.writeInt32(n.x),e.writeInt32(n.y)},vec2u(e,t,n){e.writeUint32(n.x),e.writeUint32(n.y)},"vec2<bool>"(){throw new Error("Booleans are not host-shareable")},vec3f(e,t,n){e.writeFloat32(n.x),e.writeFloat32(n.y),e.writeFloat32(n.z)},vec3h(e,t,n){e.writeFloat16(n.x),e.writeFloat16(n.y),e.writeFloat16(n.z)},vec3i(e,t,n){e.writeInt32(n.x),e.writeInt32(n.y),e.writeInt32(n.z)},vec3u(e,t,n){e.writeUint32(n.x),e.writeUint32(n.y),e.writeUint32(n.z)},"vec3<bool>"(){throw new Error("Booleans are not host-shareable")},vec4f(e,t,n){e.writeFloat32(n.x),e.writeFloat32(n.y),e.writeFloat32(n.z),e.writeFloat32(n.w)},vec4h(e,t,n){e.writeFloat16(n.x),e.writeFloat16(n.y),e.writeFloat16(n.z),e.writeFloat16(n.w)},vec4i(e,t,n){e.writeInt32(n.x),e.writeInt32(n.y),e.writeInt32(n.z),e.writeInt32(n.w)},vec4u(e,t,n){e.writeUint32(n.x),e.writeUint32(n.y),e.writeUint32(n.z),e.writeUint32(n.w)},"vec4<bool>"(){throw new Error("Booleans are not host-shareable")},mat2x2f(e,t,n){for(let r=0;r<n.length;++r)e.writeFloat32(n[r])},mat3x3f(e,t,n){for(let r=0;r<n.length;++r)e.writeFloat32(n[r])},mat4x4f(e,t,n){for(let r=0;r<n.length;++r)e.writeFloat32(n[r])},struct(e,t,n){let r=tt(t);mt(e,r);for(let[s,i]of Object.entries(t.propTypes))mt(e,tt(i)),Fi(e,i,n[s]);mt(e,r)},array(e,t,n){if(t.elementCount===0)throw new Error("Cannot write using a runtime-sized schema.");let r=tt(t);mt(e,r);let s=e.currentByteOffset;for(let i=0;i<Math.min(t.elementCount,n.length);i++)mt(e,r),Fi(e,t.elementType,n[i]);e.seekTo(s+Me(t))},ptr(){throw new Error("Pointers are not host-shareable")},atomic(e,t,n){ss[t.inner.type]?.(e,t,n)},decorated(e,t,n){let r=wn(t);mt(e,r);let s=e.currentByteOffset;ss[t.inner?.type]?.(e,t.inner,n),e.seekTo(s+Me(t))},uint8(e,t,n){e.writeUint8(n)},uint8x2(e,t,n){e.writeUint8(n.x),e.writeUint8(n.y)},uint8x4(e,t,n){e.writeUint8(n.x),e.writeUint8(n.y),e.writeUint8(n.z),e.writeUint8(n.w)},sint8(e,t,n){e.writeInt8(n)},sint8x2(e,t,n){e.writeInt8(n.x),e.writeInt8(n.y)},sint8x4(e,t,n){e.writeInt8(n.x),e.writeInt8(n.y),e.writeInt8(n.z),e.writeInt8(n.w)},unorm8(e,t,n){e.writeUint8(Math.round(n*255))},unorm8x2(e,t,n){e.writeUint8(Math.round(n.x*255)),e.writeUint8(Math.round(n.y*255))},unorm8x4(e,t,n){e.writeUint8(Math.round(n.x*255)),e.writeUint8(Math.round(n.y*255)),e.writeUint8(Math.round(n.z*255)),e.writeUint8(Math.round(n.w*255))},snorm8(e,t,n){e.writeInt8(Math.round(n*127))},snorm8x2(e,t,n){e.writeInt8(Math.round(n.x*127)),e.writeInt8(Math.round(n.y*127))},snorm8x4(e,t,n){e.writeInt8(Math.round(n.x*127)),e.writeInt8(Math.round(n.y*127)),e.writeInt8(Math.round(n.z*127)),e.writeInt8(Math.round(n.w*127))},uint16(e,t,n){e.writeUint16(n)},uint16x2(e,t,n){e.writeUint16(n.x),e.writeUint16(n.y)},uint16x4(e,t,n){e.writeUint16(n.x),e.writeUint16(n.y),e.writeUint16(n.z),e.writeUint16(n.w)},sint16(e,t,n){e.writeInt16(n)},sint16x2(e,t,n){e.writeInt16(n.x),e.writeInt16(n.y)},sint16x4(e,t,n){e.writeInt16(n.x),e.writeInt16(n.y),e.writeInt16(n.z),e.writeInt16(n.w)},unorm16(e,t,n){e.writeUint16(n*65535)},unorm16x2(e,t,n){e.writeUint16(n.x*65535),e.writeUint16(n.y*65535)},unorm16x4(e,t,n){e.writeUint16(n.x*65535),e.writeUint16(n.y*65535),e.writeUint16(n.z*65535),e.writeUint16(n.w*65535)},snorm16(e,t,n){e.writeInt16(Math.round(n*32767))},snorm16x2(e,t,n){e.writeInt16(Math.round(n.x*32767)),e.writeInt16(Math.round(n.y*32767))},snorm16x4(e,t,n){e.writeInt16(Math.round(n.x*32767)),e.writeInt16(Math.round(n.y*32767)),e.writeInt16(Math.round(n.z*32767)),e.writeInt16(Math.round(n.w*32767))},float16(e,t,n){e.writeFloat16(n)},float16x2(e,t,n){e.writeFloat16(n.x),e.writeFloat16(n.y)},float16x4(e,t,n){e.writeFloat16(n.x),e.writeFloat16(n.y),e.writeFloat16(n.z),e.writeFloat16(n.w)},float32(e,t,n){e.writeFloat32(n)},float32x2(e,t,n){e.writeFloat32(n.x),e.writeFloat32(n.y)},float32x3(e,t,n){e.writeFloat32(n.x),e.writeFloat32(n.y),e.writeFloat32(n.z)},float32x4(e,t,n){e.writeFloat32(n.x),e.writeFloat32(n.y),e.writeFloat32(n.z),e.writeFloat32(n.w)},uint32(e,t,n){e.writeUint32(n)},uint32x2(e,t,n){e.writeUint32(n.x),e.writeUint32(n.y)},uint32x3(e,t,n){e.writeUint32(n.x),e.writeUint32(n.y),e.writeUint32(n.z)},uint32x4(e,t,n){e.writeUint32(n.x),e.writeUint32(n.y),e.writeUint32(n.z),e.writeUint32(n.w)},sint32(e,t,n){e.writeInt32(n)},sint32x2(e,t,n){e.writeInt32(n.x),e.writeInt32(n.y)},sint32x3(e,t,n){e.writeInt32(n.x),e.writeInt32(n.y),e.writeInt32(n.z)},sint32x4(e,t,n){e.writeInt32(n.x),e.writeInt32(n.y),e.writeInt32(n.z),e.writeInt32(n.w)},"unorm10-10-10-2"(e,t,n){let r=0;r|=(n.x*1023&1023)<<22,r|=(n.y*1023&1023)<<12,r|=(n.z*1023&1023)<<2,r|=n.w*3&3,e.writeUint32(r)},"unorm8x4-bgra"(e,t,n){e.writeUint8(n.z*255),e.writeUint8(n.y*255),e.writeUint8(n.x*255),e.writeUint8(n.w*255)},disarray(e,t,n){let r=tt(t);mt(e,r);let s=e.currentByteOffset;for(let i=0;i<Math.min(t.elementCount,n.length);i++)mt(e,r),ss[t.elementType?.type]?.(e,t.elementType,n[i]);e.seekTo(s+Me(t))},unstruct(e,t,n){let r=t.propTypes;for(let[s,i]of Object.entries(r))ss[i.type]?.(e,i,n[s])},"loose-decorated"(e,t,n){let r=wn(t);mt(e,r);let s=e.currentByteOffset,i=ss[t.inner?.type];return i?.(e,t.inner,n),e.seekTo(s+Me(t)),n}};function Fi(e,t,n){let r=ss[t.type];if(!r)throw new Error(`Cannot write data of type '${t.type}'.`);r(e,t,n)}var gg={bool(){throw new Error("Booleans are not host-shareable")},f32(e){return e.readFloat32()},f16(e){return e.readFloat16()},i32(e){return e.readInt32()},u32(e){return e.readUint32()},u16(e){return e.readUint16()},vec2f(e){return G(e.readFloat32(),e.readFloat32())},vec3f(e){return O(e.readFloat32(),e.readFloat32(),e.readFloat32())},vec4f(e){return k(e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32())},vec2h(e){return Un(e.readFloat16(),e.readFloat16())},vec3h(e){return An(e.readFloat16(),e.readFloat16(),e.readFloat16())},vec4h(e){return In(e.readFloat16(),e.readFloat16(),e.readFloat16(),e.readFloat16())},vec2i(e){return Be(e.readInt32(),e.readInt32())},vec3i(e){return Ot(e.readInt32(),e.readInt32(),e.readInt32())},vec4i(e){return Le(e.readInt32(),e.readInt32(),e.readInt32(),e.readInt32())},vec2u(e){return xt(e.readUint32(),e.readUint32())},vec3u(e){return rt(e.readUint32(),e.readUint32(),e.readUint32())},vec4u(e){return Ce(e.readUint32(),e.readUint32(),e.readUint32(),e.readUint32())},"vec2<bool>"(){throw new Error("Booleans are not host-shareable")},"vec3<bool>"(){throw new Error("Booleans are not host-shareable")},"vec4<bool>"(){throw new Error("Booleans are not host-shareable")},mat2x2f(e){return xn(e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32())},mat3x3f(e){let t=()=>{let n=e.readFloat32();return e.readFloat32(),n};return Bn(e.readFloat32(),e.readFloat32(),t(),e.readFloat32(),e.readFloat32(),t(),e.readFloat32(),e.readFloat32(),t())},mat4x4f(e){return ve(e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32())},struct(e,t){let n=tt(t);mt(e,n);let r={},s=t.propTypes;for(let[i,p]of Object.entries(s))mt(e,tt(p)),r[i]=Ln(e,p);return mt(e,n),r},array(e,t){if(t.elementCount===0)throw new Error("Cannot read using a runtime-sized schema.");let n=tt(t),r=[];for(let s=0;s<t.elementCount;s++){mt(e,n);let i=t.elementType,p=Ln(e,i);r.push(p)}return mt(e,n),r},ptr(){throw new Error("Pointers are not host-shareable")},atomic(e,t){return Ln(e,t.inner)},decorated(e,t){let n=wn(t);mt(e,n);let r=e.currentByteOffset,s=Ln(e,t.inner);return e.seekTo(r+Me(t)),s},uint8:e=>e.readUint8(),uint8x2:e=>xt(e.readUint8(),e.readUint8()),uint8x4:e=>Ce(e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8()),sint8:e=>e.readInt8(),sint8x2:e=>Be(e.readInt8(),e.readInt8()),sint8x4:e=>Le(e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8()),unorm8:e=>e.readUint8()/255,unorm8x2:e=>G(e.readUint8()/255,e.readUint8()/255),unorm8x4:e=>k(e.readUint8()/255,e.readUint8()/255,e.readUint8()/255,e.readUint8()/255),snorm8:e=>e.readInt8()/127,snorm8x2:e=>G(e.readInt8()/127,e.readInt8()/127),snorm8x4:e=>k(e.readInt8()/127,e.readInt8()/127,e.readInt8()/127,e.readInt8()/127),uint16:e=>e.readUint16(),uint16x2:e=>xt(e.readUint16(),e.readUint16()),uint16x4:e=>Ce(e.readUint16(),e.readUint16(),e.readUint16(),e.readUint16()),sint16:e=>e.readInt16(),sint16x2:e=>Be(e.readInt16(),e.readInt16()),sint16x4:e=>Le(e.readInt16(),e.readInt16(),e.readInt16(),e.readInt16()),unorm16:e=>e.readUint16()/65535,unorm16x2:e=>G(e.readUint16()/65535,e.readUint16()/65535),unorm16x4:e=>k(e.readUint16()/65535,e.readUint16()/65535,e.readUint16()/65535,e.readUint16()/65535),snorm16:e=>e.readInt16()/32767,snorm16x2:e=>G(e.readInt16()/32767,e.readInt16()/32767),snorm16x4:e=>k(e.readInt16()/32767,e.readInt16()/32767,e.readInt16()/32767,e.readInt16()/32767),float16(e){return e.readFloat16()},float16x2:e=>G(e.readFloat16(),e.readFloat16()),float16x4:e=>k(e.readFloat16(),e.readFloat16(),e.readFloat16(),e.readFloat16()),float32:e=>e.readFloat32(),float32x2:e=>G(e.readFloat32(),e.readFloat32()),float32x3:e=>O(e.readFloat32(),e.readFloat32(),e.readFloat32()),float32x4:e=>k(e.readFloat32(),e.readFloat32(),e.readFloat32(),e.readFloat32()),uint32:e=>e.readUint32(),uint32x2:e=>xt(e.readUint32(),e.readUint32()),uint32x3:e=>rt(e.readUint32(),e.readUint32(),e.readUint32()),uint32x4:e=>Ce(e.readUint32(),e.readUint32(),e.readUint32(),e.readUint32()),sint32:e=>e.readInt32(),sint32x2:e=>Be(e.readInt32(),e.readInt32()),sint32x3:e=>Ot(e.readInt32(),e.readInt32(),e.readInt32()),sint32x4:e=>Le(e.readInt32(),e.readInt32(),e.readInt32(),e.readInt32()),"unorm10-10-10-2"(e){let t=e.readUint32(),n=(t>>22)/1023,r=(t>>12&1023)/1023,s=(t>>2&1023)/1023,i=(t&3)/3;return k(n,r,s,i)},"unorm8x4-bgra"(e){let t=e.readByte()/255,n=e.readByte()/255,r=e.readByte()/255,s=e.readByte()/255;return k(r,n,t,s)},unstruct(e,t){let n={},r=t.propTypes;for(let[s,i]of Object.entries(r))n[s]=Ln(e,i);return n},disarray(e,t){let n=tt(t),r=[];for(let s=0;s<t.elementCount;s++)mt(e,n),r.push(Ln(e,t.elementType));return mt(e,n),r},"loose-decorated"(e,t){mt(e,wn(t));let n=e.currentByteOffset,r=Ln(e,t.inner);return e.seekTo(n+Me(t)),r}};function Ln(e,t){let n=gg[t.type];if(!n)throw new Error(`Cannot read data of type '${t.type}'.`);return n(e,t)}function wg(e,t){let n=Me(e);if(n===0||t===void 0||t===null)return[];let r=new ArrayBuffer(n),s=new Fr(r),i=[];function p(_,P,U,N){if(P!=null){if(vt(_)||En(_)){let j=gh(_);for(let[L,Z]of Object.entries(j)){let Q=_.propTypes[L];if(!Q)continue;let se=P[L];se!==void 0&&p(Q,se,U+Z.offset,Z.padding??N)}return}if(Lt(_)||ir(_)){let j=_,L=sn(Me(j.elementType),tt(j.elementType));if(!Array.isArray(P))throw new Error("Partial value for array must be an array");let Z=P??[];Z.sort((Q,se)=>Q.idx-se.idx);for(let{idx:Q,value:se}of Z)p(j.elementType,se,U+Q*L,L-Me(j.elementType))}else{let j=Me(_);s.seekTo(U),Fi(s,_,P),i.push({start:U,end:U+j,padding:N})}}}if(p(e,t,0),i.length===0)return[];let y=[],v=i[0];for(let _=1;_<i.length;_++){let P=i[_];if(!P||!v)throw new Error("Internal error: missing segment");P.start===v.end+(v.padding??0)?(v.end=P.end,v.padding=P.padding):(y.push({data:new Uint8Array(r,v.start,v.end-v.start)}),v=P)}if(!v)throw new Error("Internal error: missing segment");return y.push({data:new Uint8Array(r,v.start,v.end-v.start)}),y}function Li(e){return!!e?.usableAsStorage}var Su=class wh extends Error{constructor(t){super(`Resource '${W(t)??"<unnamed>"}' cannot be bound as 'storage'. Use .$usage('storage') to allow it.`),Object.setPrototypeOf(this,wh.prototype)}};function xh(e){return!!e.usableAsUniform}var vh={uniform:"uniform",mutable:"storage, read_write",readonly:"storage, read"},qo=class{constructor(e,t){this.usage=e,this.buffer=t,this[E]={dataType:t.dataType},this[st]=t}resourceType="buffer-usage";[E];[st];$name(e){return this.buffer.$name(e),this}[he](e){let t=this.buffer.dataType,n=e.getUniqueName(this),{group:r,binding:s}=e.allocateFixedEntry(this.usage==="uniform"?{uniform:t}:{storage:t,access:this.usage},this.buffer),i=vh[this.usage];return e.addDeclaration(`@group(${r}) @binding(${s}) var<${i}> ${n}: ${e.resolve(t).value};`),B(n,t)}toString(){return`${this.usage}:${W(this)??"<unnamed>"}`}get[Ne](){let e=this.buffer.dataType;return new Proxy({[E]:!0,get[Xt](){return B(this,e)},[he]:t=>t.resolve(this),toString:()=>`${this.usage}:${W(this)??"<unnamed>"}.$`},On)}get $(){let e=Vi(),t=Oi();if(e.type==="normal")throw new lu(t?`Cannot access ${String(this.buffer)}. TypeGPU functions that depends on GPU resources need to be part of a compute dispatch, draw call or simulation`:".$ and .value are inaccessible during normal JS execution. Try `.read()`");return e.type==="codegen"?this[Ne]:e.type==="simulate"?(e.buffers.has(this.buffer)||e.buffers.set(this.buffer,kr(this.buffer.dataType,this.buffer.initial)),e.buffers.get(this.buffer)):hs(e,"bufferUsage.ts#TgpuFixedBufferImpl/$")}get value(){return this.$}set $(e){let t=Vi(),n=Oi();if(t.type==="normal")throw new lu(n?`Cannot access ${String(this.buffer)}. TypeGPU functions that depends on GPU resources need to be part of a compute dispatch, draw call or simulation`:".$ and .value are inaccessible during normal JS execution. Try `.write()`");if(t.type==="codegen")throw new Error("Unreachable bufferUsage.ts#TgpuFixedBufferImpl/$");if(t.type==="simulate"){t.buffers.set(this.buffer,e);return}hs(t,"bufferUsage.ts#TgpuFixedBufferImpl/$")}set value(e){this.$=e}},Pu=class{constructor(e,t,n){this.usage=e,this.dataType=t,this[E]={dataType:t},this.#e=n,Fe(this,n.key)}[E];resourceType="buffer-usage";#e;[he](e){let t=this.dataType,n=e.getUniqueName(this),r=e.allocateLayoutEntry(this.#e.layout),s=vh[this.usage];return e.addDeclaration(`@group(${r}) @binding(${this.#e.idx}) var<${s}> ${n}: ${e.resolve(t).value};`),B(n,t)}toString(){return`${this.usage}:${W(this)??"<unnamed>"}`}get[Ne](){let e=this.dataType;return new Proxy({[E]:!0,get[Xt](){return B(this,e)},[he]:t=>t.resolve(this),toString:()=>`${this.usage}:${W(this)??"<unnamed>"}.$`},On)}get $(){if(kn())return this[Ne];throw new Error("Direct access to buffer values is possible only as part of a compute dispatch or draw call. Try .read() or .write() instead")}get value(){return this.$}},Uu=new WeakMap;function xg(e){if(!Li(e))throw new Error(`Cannot pass ${e} to asMutable, as it is not allowed to be used as storage. To allow it, call .$usage('storage') when creating the buffer.`);let t=Uu.get(e);return t||(t=new qo("mutable",e),Uu.set(e,t)),t}var Au=new WeakMap;function vg(e){if(!Li(e))throw new Error(`Cannot pass ${e} to asReadonly, as it is not allowed to be used as storage. To allow it, call .$usage('storage') when creating the buffer.`);let t=Au.get(e);return t||(t=new qo("readonly",e),Au.set(e,t)),t}var Iu=new WeakMap;function bg(e){if(!xh(e))throw new Error(`Cannot pass ${e} to asUniform, as it is not allowed to be used as a uniform. To allow it, call .$usage('uniform') when creating the buffer.`);let t=Iu.get(e);return t||(t=new qo("uniform",e),Iu.set(e,t)),t}var Tg={uniform:bg,mutable:xg,readonly:vg};function bi(e,t,n){return zt(t)?new Bu(e,t,n):new Bu(e,t,n,["storage","uniform"])}function Gs(e){return e.resourceType==="buffer"}var _g=Kc(),Bu=class{constructor(t,n,r,s){this.dataType=n,this.initialOrBuffer=r,this._disallowedUsages=s,this.#e=t.device,Oa(r)?(this._ownBuffer=!1,this._buffer=r):(this._ownBuffer=!0,this.initial=r)}[E]=!0;resourceType="buffer";flags=GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC;#e;_buffer=null;_ownBuffer;_destroyed=!1;_hostBuffer;initial;usableAsUniform=!1;usableAsStorage=!1;usableAsVertex=!1;usableAsIndex=!1;get buffer(){if(this._destroyed)throw new Error("This buffer has been destroyed");return this._buffer||(this._buffer=this.#e.createBuffer({size:Me(this.dataType),usage:this.flags,mappedAtCreation:!!this.initial,label:W(this)??"<unnamed>"}),this.initial&&(this._writeToTarget(this._buffer.getMappedRange(),this.initial),this._buffer.unmap())),this._buffer}get destroyed(){return this._destroyed}$name(t){return Fe(this,t),this._buffer&&(this._buffer.label=t),this}$usage(...t){for(let n of t){if(this._disallowedUsages?.includes(n))throw new Error(`Buffer of type ${this.dataType.type} cannot be used as ${n}`);this.flags|=n==="uniform"?GPUBufferUsage.UNIFORM:0,this.flags|=n==="storage"?GPUBufferUsage.STORAGE:0,this.flags|=n==="vertex"?GPUBufferUsage.VERTEX:0,this.flags|=n==="index"?GPUBufferUsage.INDEX:0,this.usableAsUniform=this.usableAsUniform||n==="uniform",this.usableAsStorage=this.usableAsStorage||n==="storage",this.usableAsVertex=this.usableAsVertex||n==="vertex",this.usableAsIndex=this.usableAsIndex||n==="index"}return this}$addFlags(t){if(!this._ownBuffer)throw new Error("Cannot add flags to a buffer that is not managed by TypeGPU.");return t&GPUBufferUsage.MAP_READ?(this.flags=GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ,this):t&GPUBufferUsage.MAP_WRITE?(this.flags=GPUBufferUsage.COPY_SRC|GPUBufferUsage.MAP_WRITE,this):(this.flags|=t,this)}compileWriter(){Eu(this.dataType)}_writeToTarget(t,n){let r=Eu(this.dataType);if(r)try{r(new DataView(t),0,n,_g==="little");return}catch(s){console.error(`Error when using compiled writer for buffer ${W(this)??"<unnamed>"} - this is likely a bug, please submit an issue at https://github.com/software-mansion/TypeGPU/issues
Using fallback writer instead.`,s)}Fi(new Fr(t),this.dataType,n)}write(t){let n=this.buffer;if(n.mapState==="mapped"){let s=n.getMappedRange();this._writeToTarget(s,t);return}let r=Me(this.dataType);this._hostBuffer||(this._hostBuffer=new ArrayBuffer(r)),this._writeToTarget(this._hostBuffer,t),this.#e.queue.writeBuffer(n,0,this._hostBuffer,0,r)}writePartial(t){let n=this.buffer,r=wg(this.dataType,t);if(n.mapState==="mapped"){let s=n.getMappedRange(),i=new Uint8Array(s);for(let p of r)i.set(p.data,p.data.byteOffset)}else for(let s of r)this.#e.queue.writeBuffer(n,s.data.byteOffset,s.data,0,s.data.byteLength)}clear(){let t=this.buffer;if(t.mapState==="mapped"){new Uint8Array(t.getMappedRange()).fill(0);return}let n=this.#e.createCommandEncoder();n.clearBuffer(t),this.#e.queue.submit([n.finish()])}copyFrom(t){if(this.buffer.mapState==="mapped")throw new Error("Cannot copy to a mapped buffer.");let n=Me(this.dataType),r=this.#e.createCommandEncoder();r.copyBufferToBuffer(t.buffer,0,this.buffer,0,n),this.#e.queue.submit([r.finish()])}async read(){let t=this.buffer;if(t.mapState==="mapped"){let i=t.getMappedRange();return Ln(new pr(i),this.dataType)}if(t.usage&GPUBufferUsage.MAP_READ){await t.mapAsync(GPUMapMode.READ);let i=t.getMappedRange(),p=Ln(new pr(i),this.dataType);return t.unmap(),p}let n=(globalThis.__TYPEGPU_AUTONAME__??(i=>i))(this.#e.createBuffer({size:Me(this.dataType),usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),"r"),r=this.#e.createCommandEncoder();r.copyBufferToBuffer(t,0,n,0,Me(this.dataType)),this.#e.queue.submit([r.finish()]),await n.mapAsync(GPUMapMode.READ,0,Me(this.dataType));let s=Ln(new pr(n.getMappedRange()),this.dataType);return n.unmap(),n.destroy(),s}as(t){return Tg[t]?.(this)}destroy(){this._destroyed||(this._destroyed=!0,this._ownBuffer&&this._buffer?.destroy())}toString(){return`buffer:${W(this)??"<unnamed>"}`}};function $g(e,t){return new _h(Do(),e,t)}function Mg(e,t){return new _h(Ro(),e,t)}function bh(e){let t=e;return t?.resourceType==="sampler"&&!!t[E]}function Th(e){let t=e;return t?.resourceType==="sampler-comparison"&&!!t[E]}var zg=class{constructor(t,n){this.schema=t,this.#e=n,this.resourceType=t.type==="sampler_comparison"?"sampler-comparison":"sampler",Fe(this,n.key)}[E]={unwrap:void 0};resourceType;#e;[he](t){let n=t.getUniqueName(this),r=t.allocateLayoutEntry(this.#e.layout);return t.addDeclaration(`@group(${r}) @binding(${this.#e.idx}) var ${n}: ${t.resolve(this.schema).value};`),B(n,this.schema)}get[Ne](){let t=this.schema;return new Proxy({[E]:!0,get[Xt](){return B(this,t)},[he]:n=>n.resolve(this),toString:()=>`${this.toString()}.$`},On)}get $(){if(kn())return this[Ne];throw new Error("Direct access to sampler values is possible only as part of a compute dispatch or draw call.")}get value(){return this.$}toString(){return`${this.resourceType}:${W(this)??"<unnamed>"}`}},_h=class{constructor(t,n,r){this.schema=t,this.#n=n,this.#r=r,this.resourceType=t.type==="sampler_comparison"?"sampler-comparison":"sampler",this[E]={unwrap:()=>(this.#t||(this.#t=this.#r.device.createSampler({...this.#n,label:W(this)??"<unnamed>"})),this.#t)},this.#e=n.minFilter==="linear"||n.magFilter==="linear"||n.mipmapFilter==="linear"}[E];resourceType;#e;#t=null;#n;#r;[he](t){let n=t.getUniqueName(this),{group:r,binding:s}=t.allocateFixedEntry(this.schema.type==="sampler_comparison"?{sampler:"comparison"}:{sampler:this.#e?"filtering":"non-filtering"},this);return t.addDeclaration(`@group(${r}) @binding(${s}) var ${n}: ${t.resolve(this.schema).value};`),B(n,this.schema)}get[Ne](){let t=this.schema;return new Proxy({[E]:!0,get[Xt](){return B(this,t)},[he]:n=>n.resolve(this),toString:()=>`${this.toString()}.$`},On)}get $(){if(kn())return this[Ne];throw new Error("Direct access to sampler values is possible only as part of a compute dispatch or draw call.")}get value(){return this.$}$name(t){return Fe(this,t),this}toString(){return`${this.resourceType}:${W(this)??"<unnamed>"}`}},Eg=class{constructor(t,n){this.schema=t,this.#e=n,Fe(this,n.key)}resourceType="external-texture";[E]=!0;#e;[he](t){let n=t.getUniqueName(this),r=t.allocateLayoutEntry(this.#e.layout);return t.addDeclaration(`@group(${r}) @binding(${this.#e.idx}) var ${n}: ${t.resolve(this.schema).value};`),B(n,Ic())}get[Ne](){let t=this.schema;return new Proxy({[E]:!0,get[Xt](){return B(this,t)},[he]:n=>n.resolve(this),toString:()=>`textureExternal:${W(this)??"<unnamed>"}.$`},On)}get $(){if(kn())return this[Ne];throw new Error("Direct access to texture views values is possible only as part of a compute dispatch or draw call. Try .read() or .write() instead")}get value(){return this.$}toString(){return`textureExternal:${W(this)??"<unnamed>"}`}};function Ja(e){let{videoWidth:t,videoHeight:n}=e;if(t&&n)return{width:t,height:n};let{naturalWidth:r,naturalHeight:s}=e;if(r&&s)return{width:r,height:s};let{codedWidth:i,codedHeight:p}=e;if(i&&p)return{width:i,height:p};let{width:y,height:v}=e||HTMLCanvasElement||OffscreenCanvas||HTMLImageElement||ImageData;if(!y||!v)throw new Error("Cannot determine dimensions of the provided image source.");return{width:y,height:v}}var Za=new WeakMap;function $h(e){let t=Za.get(e);return t||(t=new Map,Za.set(e,t)),t}function Sg(e){let t=Za.get(e);t&&t.clear()}function Pg(e,t,n=0,r){if(t.dimension!=="2d")throw new Error("Cannot generate mipmaps for non-2D textures: only 2D textures are currently supported.");let s=r??t.mipLevelCount-n,i=ah(t.format,e);if(![...i.sampleTypes].some(p=>p==="float"||p==="unfilterable-float"))throw new Error(`Cannot generate mipmaps for format '${t.format}': only float and unfilterable-float formats are currently supported.`);if(!i.canRenderAttachment)throw new Error(`Cannot generate mipmaps for format '${t.format}': format does not support render attachments.`);for(let p=0;p<t.depthOrArrayLayers;p++)for(let y=n;y<n+s-1;y++){let v=y,_=y+1;Ig(e,t,v,_,p)}}function Ug(e,t,n,r){if(t.dimension==="3d")throw new Error("Cannot resample to 3D textures: only 2D textures are currently supported.");let s=xs[t.format];if(![...s.sampleTypes].some(i=>i==="float"||i==="unfilterable-float"))throw new Error(`Cannot resample to format '${t.format}': only float and unfilterable-float formats are currently supported.`);if(!s.canRenderAttachment)throw new Error(`Cannot resample to format '${t.format}': format does not support render attachments.`);return Ag(e,t,n,r)}function Ag(e,t,n,r=0){let s=[...xs[t.format].sampleTypes].includes("float"),i=`${s?"filterable":"unfilterable"}`,p=$h(e),y=p.get(i);if(!y){let Q=e.createShaderModule({code:`
struct VertexOutput {
  @builtin(position) pos: vec4f,
  @location(0) uv: vec2f,
}

@vertex
fn vs_main(@builtin(vertex_index) vertexIndex: u32) -> VertexOutput {
  let pos = array<vec2f, 3>(vec2f(-1, -1), vec2f(3, -1), vec2f(-1, 3));
  let uv = array<vec2f, 3>(vec2f(0, 1), vec2f(2, 1), vec2f(0, -1));

  var output: VertexOutput;
  output.pos = vec4f(pos[vertexIndex], 0, 1);
  output.uv = uv[vertexIndex];
  return output;
}
      `}),se=(globalThis.__TYPEGPU_AUTONAME__??(Ee=>Ee))(e.createSampler({magFilter:s?"linear":"nearest",minFilter:s?"linear":"nearest"}),"R"),ze=e.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:s?"filtering":"non-filtering"}}]}),oe=e.createPipelineLayout({bindGroupLayouts:[ze]}),_e=e.createShaderModule({code:`
@group(0) @binding(0) var inputTexture: texture_2d<f32>;
@group(0) @binding(1) var inputSampler: sampler;

@fragment
fn fs_main(@location(0) uv: vec2f) -> @location(0) vec4f {
  ${s?"return textureSample(inputTexture, inputSampler, uv);":`let texelCoord = vec2u(uv * vec2f(textureDimensions(inputTexture)));
        return textureLoad(inputTexture, texelCoord, 0);`}
}
      `});y={vertexShader:Q,fragmentShader:_e,bindGroupLayout:ze,pipelineLayout:oe,sampler:se},p.set(i,y)}let v=(globalThis.__TYPEGPU_AUTONAME__??(Q=>Q))(e.createTexture({size:[...Object.values(Ja(n))],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST}),"l"),{width:_,height:P}=Ja(n);e.queue.copyExternalImageToTexture({source:n},{texture:v},[_,P,1]);let U=(globalThis.__TYPEGPU_AUTONAME__??(Q=>Q))(e.createTexture({size:[t.width,t.height,1],format:t.format,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),"f"),N=e.createRenderPipeline({layout:y.pipelineLayout,vertex:{module:y.vertexShader},fragment:{module:y.fragmentShader,targets:[{format:t.format}]},primitive:{topology:"triangle-list"}}),j=e.createBindGroup({layout:y.bindGroupLayout,entries:[{binding:0,resource:v.createView()},{binding:1,resource:y.sampler}]}),L=e.createCommandEncoder(),Z=L.beginRenderPass({colorAttachments:[{view:U.createView(),loadOp:"clear",storeOp:"store"}]});Z.setPipeline(N),Z.setBindGroup(0,j),Z.draw(3),Z.end(),L.copyTextureToTexture({texture:U},{texture:t,origin:{x:0,y:0,z:r}},{width:t.width,height:t.height,depthOrArrayLayers:1}),e.queue.submit([L.finish()]),v.destroy(),U.destroy()}function Ig(e,t,n,r,s){let i=[...ah(t.format,e).sampleTypes].includes("float"),p=`${i?"filterable":"unfilterable"}`,y=$h(e),v=y.get(p);if(!v){let Z=e.createShaderModule({code:`
struct VertexOutput {
  @builtin(position) pos: vec4f,
  @location(0) uv: vec2f,
}

@vertex
fn vs_main(@builtin(vertex_index) vertexIndex: u32) -> VertexOutput {
  let pos = array<vec2f, 3>(vec2f(-1, -1), vec2f(3, -1), vec2f(-1, 3));
  let uv = array<vec2f, 3>(vec2f(0, 1), vec2f(2, 1), vec2f(0, -1));

  var output: VertexOutput;
  output.pos = vec4f(pos[vertexIndex], 0, 1);
  output.uv = uv[vertexIndex];
  return output;
}
      `}),Q=e.createShaderModule({code:`
@group(0) @binding(0) var inputTexture: texture_2d<f32>;
@group(0) @binding(1) var inputSampler: sampler;

@fragment
fn fs_main(@location(0) uv: vec2f) -> @location(0) vec4f {
  return textureSample(inputTexture, inputSampler, uv);
}
      `}),se=(globalThis.__TYPEGPU_AUTONAME__??(_e=>_e))(e.createSampler({magFilter:i?"linear":"nearest",minFilter:i?"linear":"nearest"}),"R"),ze=e.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:i?"float":"unfilterable-float"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:i?"filtering":"non-filtering"}}]}),oe=e.createPipelineLayout({bindGroupLayouts:[ze]});v={vertexShader:Z,fragmentShader:Q,bindGroupLayout:ze,pipelineLayout:oe,sampler:se},y.set(p,v)}let _=e.createRenderPipeline({layout:v.pipelineLayout,vertex:{module:v.vertexShader},fragment:{module:v.fragmentShader,targets:[{format:t.format}]},primitive:{topology:"triangle-list"}}),P=t.createView({baseMipLevel:n,dimension:"2d",mipLevelCount:1,...s!==void 0&&{baseArrayLayer:s,arrayLayerCount:1}}),U=t.createView({baseMipLevel:r,dimension:"2d",mipLevelCount:1,...s!==void 0&&{baseArrayLayer:s,arrayLayerCount:1}}),N=e.createBindGroup({layout:v.bindGroupLayout,entries:[{binding:0,resource:P},{binding:1,resource:v.sampler}]}),j=e.createCommandEncoder(),L=j.beginRenderPass({colorAttachments:[{view:U,loadOp:"clear",storeOp:"store"}]});L.setPipeline(_),L.setBindGroup(0,N),L.draw(3),L.end(),e.queue.submit([j.finish()])}function Bg(e){return{dimension:e.dimension??"2d",sampleType:xs[e.format].channelType,multisampled:(e.sampleCount??1)!==1}}function kg(e){return e==="depth24plus-stencil8"||e==="depth32float-stencil8"?["depth","stencil"]:e==="depth16unorm"||e==="depth24plus"||e==="depth32float"?["depth"]:e==="stencil8"?["stencil"]:["color"]}function Og(e,t){return new Vg(e,t)}function qs(e){return e?.resourceType==="texture"&&!!e[E]}function ji(e){return e?.resourceType==="texture-view"&&!!e[E]}var Vg=class{constructor(t,n){this.props=t;let r=t.format;this.#i=n,this.#e=xs[r],this.#t=t.size[0]*(t.size[1]??1)*(t.size[2]??1)*this.#e.texelSize,this.aspects=kg(r),this[E]={unwrap:()=>{if(this.#n)throw new Error("This texture has been destroyed");return this.#s||(this.#s=n.device.createTexture({label:W(this)??"<unnamed>",format:t.format,size:t.size,usage:this.#r,dimension:t.dimension??"2d",viewFormats:t.viewFormats??[],mipLevelCount:t.mipLevelCount??1,sampleCount:t.sampleCount??1})),this.#s}}}[E];resourceType="texture";aspects;usableAsSampled=!1;usableAsStorage=!1;usableAsRender=!1;#e;#t;#n=!1;#r=GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;#s=null;#i;$name(t){return Fe(this,t),this}$usage(...t){let n=t.includes("storage"),r=t.includes("sampled"),s=t.includes("render");return this.#r|=r?GPUTextureUsage.TEXTURE_BINDING:0,this.#r|=n?GPUTextureUsage.STORAGE_BINDING:0,this.#r|=s?GPUTextureUsage.RENDER_ATTACHMENT:0,this.usableAsStorage||=n,this.usableAsSampled||=r,this.usableAsRender||=s,this}createView(t,n){return new Gg(t??Fa(Bg(this.props)),this,n)}#a(t=0){let n=2**t,[r,s,i]=[Math.max(1,Math.floor((this.props.size[0]??1)/n)),Math.max(1,Math.floor((this.props.size[1]??1)/n)),Math.max(1,Math.floor((this.props.size[2]??1)/n))];this.#i.device.queue.writeTexture({texture:this[E].unwrap(),mipLevel:t},new Uint8Array(r*s*i*this.#e.texelSize),{bytesPerRow:this.#e.texelSize*r,rowsPerImage:s},[r,s,i])}clear(t="all"){if(t==="all"){let n=this.props.mipLevelCount??1;for(let r=0;r<n;r++)this.#a(r)}else this.#a(t)}generateMipmaps(t=0,n){if(this.usableAsRender===!1)throw new Error("generateMipmaps called without specifying 'render' usage. Add it via the $usage('render') method.");let r=n??(this.props.mipLevelCount??1)-t;if(r<=1){console.warn(`generateMipmaps is a no-op: would generate ${r} mip levels (base: ${t}, total: ${this.props.mipLevelCount??1})`);return}if(t>=(this.props.mipLevelCount??1))throw new Error(`Base mip level ${t} is out of range. Texture has ${this.props.mipLevelCount??1} mip levels.`);Pg(this.#i.device,this[E].unwrap(),t,r)}write(t,n=0){if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){this.#u(t,n);return}let r=this.props.dimension??"2d";if(!Array.isArray(t)){this.#o(t,r==="3d"?0:void 0);return}let s=this.props.size[2]??1;t.length>s&&console.warn(`Too many image sources provided. Expected ${s} layers, got ${t.length}. Extra sources will be ignored.`);for(let i=0;i<Math.min(t.length,s);i++){let p=t[i];p&&this.#o(p,i)}}#u(t,n){let r=Math.max(1,this.props.size[0]>>n),s=Math.max(1,(this.props.size[1]??1)>>n),i=Math.max(1,(this.props.size[2]??1)>>n),p=r*s*i*this.#e.texelSize,y=t.byteLength??t.byteLength;if(y!==p)throw new Error(`Buffer size mismatch. Expected ${p} bytes for mip level ${n}, got ${y} bytes.`);this.#i.device.queue.writeTexture({texture:this[E].unwrap(),mipLevel:n},t,{bytesPerRow:this.#e.texelSize*r,rowsPerImage:s},[r,s,i])}#o(t,n){let r=this.props.size[0],s=this.props.size[1]??1,{width:i,height:p}=Ja(t);if(i!==r||p!==s){Ug(this.#i.device,this[E].unwrap(),t,n);return}this.#i.device.queue.copyExternalImageToTexture({source:t},{texture:this[E].unwrap(),...n!==void 0&&{origin:{x:0,y:0,z:n}}},n!==void 0?[r,s,1]:this.props.size)}copyFrom(t){if(t.props.format!==this.props.format)throw new Error(`Texture format mismatch. Source texture has format ${t.props.format}, target texture has format ${this.props.format}`);if(t.props.size[0]!==this.props.size[0]||(t.props.size[1]??1)!==(this.props.size[1]??1)||(t.props.size[2]??1)!==(this.props.size[2]??1))throw new Error(`Texture size mismatch. Source texture has size ${t.props.size.join("x")}, target texture has size ${this.props.size.join("x")}`);let n=this.#i.device.createCommandEncoder();n.copyTextureToTexture({texture:t[E].unwrap()},{texture:this[E].unwrap()},t.props.size),this.#i.device.queue.submit([n.finish()])}get destroyed(){return this.#n}destroy(){this.#n||(this.#n=!0,this.#s?.destroy())}},Gg=class{constructor(t,n,r){this.schema=t,this.#e=n,this.#n=r,this[E]={unwrap:()=>{if(!this.#t){let s=this.schema,i;La(s)?i={label:W(this)??"<unnamed>",format:this.#n?.format??s.format,dimension:s.dimension}:i={label:W(this)??"<unnamed>",format:this.#n?.format??this.#e.props.format,dimension:s.dimension},this.#n?.mipLevelCount!==void 0&&(i.mipLevelCount=this.#n.mipLevelCount),this.#n?.arrayLayerCount!==void 0&&(i.arrayLayerCount=this.#n.arrayLayerCount),this.#t=this.#e[E].unwrap().createView(i)}return this.#t}}}[E];resourceType="texture-view";#e;#t;#n;$name(t){return Fe(this,t),this.#t&&(this.#t.label=t),this}get[Ne](){let t=this.schema;return new Proxy({[E]:!0,get[Xt](){return B(this,t)},[he]:n=>n.resolve(this),toString:()=>`${this.toString()}.$`},On)}get $(){if(kn())return this[Ne];throw new Error("Direct access to texture view values is possible only as part of a compute dispatch or draw call. Try .read() or .write() instead")}get value(){return this.$}toString(){return`textureView:${W(this)??"<unnamed>"}`}[he](t){let n=t.getUniqueName(this),{group:r,binding:s}=t.allocateFixedEntry(La(this.schema)?{storageTexture:this.schema}:{texture:this.schema,sampleType:this.#n?.sampleType??this.schema.bindingSampleType[0]},this);return t.addDeclaration(`@group(${r}) @binding(${s}) var ${n}: ${t.resolve(this.schema).value};`),B(n,this.schema)}},ku=class{constructor(e,t){this.schema=e,this.#e=t,Fe(this,t.key)}[E]={unwrap:void 0};resourceType="texture-view";#e;toString(){return`textureView:${W(this)??"<unnamed>"}`}[he](e){let t=e.getUniqueName(this),n=e.allocateLayoutEntry(this.#e.layout);return e.addDeclaration(`@group(${n}) @binding(${this.#e.idx}) var ${t}: ${e.resolve(this.schema).value};`),B(t,this.schema)}get[Ne](){let e=this.schema;return new Proxy({[E]:!0,get[Xt](){return B(this,e)},[he]:t=>t.resolve(this),toString:()=>`${this.toString()}.$`},On)}get $(){if(kn())return this[Ne];throw new Error("Direct access to texture views values is possible only as part of a compute dispatch or draw call. Try .read() or .write() instead")}get value(){return this.$}};function Dg(e){return!!e?.usableAsSampled}var Rg=class Mh extends Error{constructor(t){super(`Resource '${W(t)??"<unnamed>"}' cannot be bound as 'sampled'. Use .$usage('sampled') to allow it.`),Object.setPrototypeOf(this,Mh.prototype)}};function Ng(e){let t={};for(let[n,r]of Object.entries(e)){if(r===null){t[n]=null;continue}if("texture"in r&&typeof r.texture=="string"){let s=r.texture;t[n]={...r,texture:Fa({dimension:r.viewDimension??"2d",sampleType:s==="sint"?Ae:s==="uint"?J:$,multisampled:r.multisampled??!1})}}else if("storageTexture"in r&&typeof r.storageTexture=="string"){let s={readonly:"read-only",writeonly:"write-only",mutable:"read-write"};t[n]={...r,storageTexture:Fa({access:s[r.access??"writeonly"],format:r.storageTexture,dimension:r.viewDimension??"2d"})}}else"externalTexture"in r&&Object.keys(r.externalTexture).length===0?t[n]={...r,externalTexture:{type:"texture_external",dimension:"2d"}}:t[n]=r}return t}function zh(e){let t=Ng(e);return new Lg(t)}function Eh(e){return!!e&&e.resourceType==="bind-group-layout"}function Yi(e){return!!e&&e.resourceType==="bind-group"}var Fg=class Sh extends Error{constructor(t,n){super(`Bind group '${t??"<unnamed>"}' is missing a required binding '${n}'`),Object.setPrototypeOf(this,Sh.prototype)}},Ou=["compute","fragment"],$s=["compute","vertex","fragment"],Lg=class{constructor(t){this.entries=t;let n=0;for(let[r,s]of Object.entries(t)){if(s===null){n++;continue}let i={layout:this,key:r,idx:n};if("uniform"in s&&(this.bound[r]=new Pu("uniform",s.uniform,i)),"storage"in s){let p="type"in s.storage?s.storage:s.storage(0);this.bound[r]=new Pu(s.access??"readonly",p,i)}"texture"in s&&(this.bound[r]=new ku(s.texture,i)),"storageTexture"in s&&(this.bound[r]=new ku(s.storageTexture,i)),"externalTexture"in s&&(this.bound[r]=new Eg(s.externalTexture,i)),"sampler"in s&&(this.bound[r]=new zg(s.sampler==="comparison"?Ro():Do(),i)),Object.defineProperty(this.value,r,{get:()=>this.bound[r].value}),n++}}[E]=!0;_index;resourceType="bind-group-layout";bound={};value={};$=this.value;get[Ne](){return this.$}toString(){return`bindGroupLayout:${W(this)??"<unnamed>"}`}get index(){return this._index}$name(t){return Fe(this,t),this}$idx(t){return this._index=t,this}unwrap(t){return t.device.createBindGroupLayout({label:W(this)??"<unnamed>",entries:Object.values(this.entries).map((n,r)=>{if(n===null)return null;let s=n.visibility,i={binding:r,visibility:0};if("uniform"in n)s=s??$s,i.buffer={type:"uniform"};else if("storage"in n)s=s??(n.access==="mutable"?Ou:$s),i.buffer={type:n.access==="mutable"?"storage":"read-only-storage"};else if("sampler"in n)s=s??$s,i.sampler={type:n.sampler};else if("texture"in n){s=s??$s;let{multisampled:p,dimension:y,bindingSampleType:v}=n.texture;i.texture={sampleType:n.sampleType??v[0],viewDimension:y,multisampled:p}}else if("storageTexture"in n){s=s??Ou;let{dimension:p,access:y,format:v}=n.storageTexture;i.storageTexture={access:y,format:v,viewDimension:p}}else"externalTexture"in n&&(s=s??$s,i.externalTexture={});return s?.includes("compute")&&(i.visibility|=GPUShaderStage.COMPUTE),s?.includes("vertex")&&(i.visibility|=GPUShaderStage.VERTEX),s?.includes("fragment")&&(i.visibility|=GPUShaderStage.FRAGMENT),i}).filter(n=>n!==null)})}},Ph=class{constructor(e,t){this.layout=e,this.entries=t;for(let n of Object.keys(e.entries))if(e.entries[n]!==null&&!(n in t))throw new Fg(W(e),n)}resourceType="bind-group";unwrap(e){return e.device.createBindGroup({label:W(this.layout)??"<unnamed>",layout:e.unwrap(this.layout),entries:Object.entries(this.layout.entries).map(([t,n],r)=>{if(n===null)return null;let s=this.entries[t];if(s===void 0)throw new Error(`'${t}' is a resource required to populate bind group layout '${W(this.layout)??"<unnamed>"}'.`);if("uniform"in n){let i;if(Gs(s)){if(!xh(s))throw new Ap(s);i={buffer:e.unwrap(s)}}else i={buffer:s};return{binding:r,resource:i}}if("storage"in n){let i;if(Gs(s)){if(!Li(s))throw new Su(s);i={buffer:e.unwrap(s)}}else i={buffer:s};return{binding:r,resource:i}}if("texture"in n){let i;if(qs(s)){if(!Dg(s))throw new Rg(s);i=e.unwrap(s.createView(n.texture))}else ji(s)?i=e.unwrap(s):i=s;return{binding:r,resource:i}}if("storageTexture"in n){let i;if(qs(s)){if(!Li(s))throw new Su(s);i=e.unwrap(s.createView(n.storageTexture))}else ji(s)?i=e.unwrap(s):i=s;return{binding:r,resource:i}}if("sampler"in n)return Th(s)||bh(s)?{binding:r,resource:e.unwrap(s)}:{binding:r,resource:s};if("externalTexture"in n)return{binding:r,resource:s};throw new Error(`Malformed bind group entry: ${Jt(s)}`)}).filter(t=>t!==null)})}};function Ci(e){return new jg(e)}var jg=class{constructor(t=void 0){this.defaultValue=t}[E]=!0;resourceType="slot";$name(t){return Fe(this,t),this}areEqual(t,n){return Object.is(t,n)}toString(){return`slot:${W(this)??"<unnamed>"}`}get[Ne](){let t=gr();if(!t)throw new Error("Cannot access tgpu.slot's value outside of resolution.");return ua(t.unwrap(this))}get value(){return this[Ne]}get $(){return this.value}};function qi(e,t){return new Uh("private",e,t)}function Vu(e){return new Uh("workgroup",e)}var Uh=class{[E]={};#e;#t;#n;constructor(e,t,n){this.#e=e,this.#t=t,this.#n=n}[he](e){let t=e.getUniqueName(this),n=`var<${this.#e}> ${t}: ${e.resolve(this.#t).value}`;return this.#n?e.addDeclaration(`${n} = ${e.resolve(this.#n,this.#t).value};`):e.addDeclaration(`${n};`),B(t,this.#t)}$name(e){return Fe(this,e),this}toString(){return`var:${W(this)??"<unnamed>"}`}get[Ne](){let e=this.#t;return new Proxy({[E]:!0,get[Xt](){return B(this,e)},[he]:t=>t.resolve(this),toString:()=>`var:${W(this)??"<unnamed>"}.$`},On)}get $(){let e=Vi(),t=Oi();if(e.type==="normal")throw new uu(t?`Cannot access variable '${W(this)??"<unnamed>"}'. TypeGPU functions that depends on GPU resources need to be part of a compute dispatch, draw call or simulation`:"TypeGPU variables are inaccessible during normal JS execution. If you wanted to simulate GPU behavior, try `tgpu.simulate()`");return e.type==="codegen"?this[Ne]:e.type==="simulate"?(e.vars[this.#e].has(this)||e.vars[this.#e].set(this,this.#n),e.vars[this.#e].get(this)):hs(e,"tgpuVariable.ts#TgpuVarImpl/$")}set $(e){let t=Vi(),n=Oi();if(t.type==="normal")throw new uu(n?`Cannot access ${String(this)}. TypeGPU functions that depends on GPU resources need to be part of a compute dispatch, draw call or simulation`:"TypeGPU variables are inaccessible during normal JS execution. If you wanted to simulate GPU behavior, try `tgpu.simulate()`");if(t.type==="codegen")throw new Error("Unreachable tgpuVariable.ts#TgpuVarImpl/$");if(t.type==="simulate"){t.vars[this.#e].set(this,e);return}hs(t,"tgpuVariable.ts#TgpuVarImpl/$")}get value(){return this.$}set value(e){this.$=e}},Ah=qi(J,0).$name("dataBlockIndex"),Ih=qi(J,0).$name("dataByteIndex"),Bh=Ci().$name("dataBuffer"),Yg=Ve([],J)`() {
  let i = dataByteIndex;
  dataByteIndex = dataByteIndex + 1u;
  return i;
}`.$uses({dataByteIndex:Ih}).$name("nextByteIndex"),q="dataBuffer[dataBlockIndex].serializedData[nextByteIndex()]",kh={f32:Ve([$])`(n) => {
  ${q} = bitcast<u32>(n);
}`,f16:Ve([ut])`(n) => {
  ${q} = pack2x16float(vec2f(f32(n), 0.0));
}`,i32:Ve([Ae])`(n) => {
  ${q} = bitcast<u32>(n);
}`,u32:Ve([J])`(n) => {
  ${q} = n;
}`,bool:Ve([ke])`(b) => {
  ${q} = u32(b);
}`,vec2f:Ve([G])`(v) => {
  ${q} = bitcast<u32>(v.x);
  ${q} = bitcast<u32>(v.y);
}`,vec3f:Ve([O])`(v) => {
  ${q} = bitcast<u32>(v.x);
  ${q} = bitcast<u32>(v.y);
  ${q} = bitcast<u32>(v.z);
}`,vec4f:Ve([k])`(v) => {
  ${q} = bitcast<u32>(v.x);
  ${q} = bitcast<u32>(v.y);
  ${q} = bitcast<u32>(v.z);
  ${q} = bitcast<u32>(v.w);
}`,vec2h:Ve([Un])`(v) => {
  ${q} = pack2x16float(vec2f(f32(v.x), f32(v.y)));
}`,vec3h:Ve([An])`(v) => {
  ${q} = pack2x16float(vec2f(f32(v.x), f32(v.y)));
  ${q} = pack2x16float(vec2f(f32(v.z), 0.0));
}`,vec4h:Ve([In])`(v) => {
  ${q} = pack2x16float(vec2f(f32(v.x), f32(v.y)));
  ${q} = pack2x16float(vec2f(f32(v.z), f32(v.w)));
}`,vec2i:Ve([Be])`(v) => {
  ${q} = bitcast<u32>(v.x);
  ${q} = bitcast<u32>(v.y);
}`,vec3i:Ve([Ot])`(v) => {
  ${q} = bitcast<u32>(v.x);
  ${q} = bitcast<u32>(v.y);
  ${q} = bitcast<u32>(v.z);
}`,vec4i:Ve([Le])`(v) => {
  ${q} = bitcast<u32>(v.x);
  ${q} = bitcast<u32>(v.y);
  ${q} = bitcast<u32>(v.z);
  ${q} = bitcast<u32>(v.w);
}`,vec2u:Ve([xt])`(v) => {
  ${q} = v.x;
  ${q} = v.y;
}`,vec3u:Ve([rt])`(v) => {
  ${q} = v.x;
  ${q} = v.y;
  ${q} = v.z;
}`,vec4u:Ve([Ce])`(v) => {
  ${q} = v.x;
  ${q} = v.y;
  ${q} = v.z;
  ${q} = v.w;
}`,"vec2<bool>":Ve([br])`(v) => {
  ${q} = u32(v.x);
  ${q} = u32(v.y);
}`,"vec3<bool>":Ve([Tr])`(v) => {
  ${q} = u32(v.x);
  ${q} = u32(v.y);
  ${q} = u32(v.z);
}`,"vec4<bool>":Ve([_r])`(v) => {
  ${q} = u32(v.x);
  ${q} = u32(v.y);
  ${q} = u32(v.z);
  ${q} = u32(v.w);
}`,mat2x2f:Ve([xn])`(m) => {
  ${q} = bitcast<u32>(m[0][0]);
  ${q} = bitcast<u32>(m[0][1]);
  ${q} = bitcast<u32>(m[1][0]);
  ${q} = bitcast<u32>(m[1][1]);
}`,mat3x3f:Ve([Bn])`(m) => {
  ${q} = bitcast<u32>(m[0][0]);
  ${q} = bitcast<u32>(m[0][1]);
  ${q} = bitcast<u32>(m[0][2]);
  ${q} = 0u;
  ${q} = bitcast<u32>(m[1][0]);
  ${q} = bitcast<u32>(m[1][1]);
  ${q} = bitcast<u32>(m[1][2]);
  ${q} = 0u;
  ${q} = bitcast<u32>(m[2][0]);
  ${q} = bitcast<u32>(m[2][1]);
  ${q} = bitcast<u32>(m[2][2]);
  ${q} = 0u;
}`,mat4x4f:Ve([ve])`(m) => {
  ${q} = bitcast<u32>(m[0][0]);
  ${q} = bitcast<u32>(m[0][1]);
  ${q} = bitcast<u32>(m[0][2]);
  ${q} = bitcast<u32>(m[0][3]);
  ${q} = bitcast<u32>(m[1][0]);
  ${q} = bitcast<u32>(m[1][1]);
  ${q} = bitcast<u32>(m[1][2]);
  ${q} = bitcast<u32>(m[1][3]);
  ${q} = bitcast<u32>(m[2][0]);
  ${q} = bitcast<u32>(m[2][1]);
  ${q} = bitcast<u32>(m[2][2]);
  ${q} = bitcast<u32>(m[2][3]);
  ${q} = bitcast<u32>(m[3][0]);
  ${q} = bitcast<u32>(m[3][1]);
  ${q} = bitcast<u32>(m[3][2]);
  ${q} = bitcast<u32>(m[3][3]);
}`};for(let[e,t]of Object.entries(kh))t.$name(`serialize${e[0].toLocaleUpperCase()}${e.slice(1)}`).$uses({dataBlockIndex:Ah,nextByteIndex:Yg,dataBuffer:Bh});function Oh(e){return`(${e.map((t,n)=>`_arg_${n}`).join(", ")})`}function Vh(e,t){let n=kh[e.type];if(n)return n.with(Bh,t);if(vt(e)){let r=Object.keys(e.propTypes),s=Object.values(e.propTypes),i=Gh(s,t);return Ve([e])`(arg) {\n  propsSerializer(${r.map(p=>`arg.${p}`).join(", ")});\n}`.$uses({propsSerializer:i}).$name(`${W(e)??"struct"}Serializer`)}if(Lt(e)){let r=e.elementType,s=e.elementCount,i=Vh(r,t);return Ve([e])`(arg) {\n${Array.from({length:s},(p,y)=>`  elementSerializer(arg[${y}]);`).join(`
`)}\n}`.$uses({elementSerializer:i}).$name("arraySerializer")}throw new Error(`Cannot serialize data of type ${e.type}`)}function Gh(e,t){let n={},r=Ve(e),s=Oh(e),i=e.map((p,y)=>(n[`serializer${y}`]=Vh(p,t),`  serializer${y}(_arg_${y});`)).join(`
`);return r`${s} {\n${i}\n}`.$uses(n).$name("compoundSerializer")}function Cg(e,t,n,r,s){let i=t.map(Me).reduce((v,_)=>v+_,0);if(i>s.logSizeLimit)throw new Error(`Logged data needs to fit in ${s.logSizeLimit} bytes (one of the logs requires ${i} bytes). Consider increasing the limit by passing appropriate options to tgpu.init().`);let p=Gh(t,n).$name(`log${e}serializer`),y=Oh(t);return Ve(t)`${y} {
  dataBlockIndex = atomicAdd(&indexBuffer, 1);
  if (dataBlockIndex >= ${s.logCountLimit}) {
    return;
  }
  dataBuffer[dataBlockIndex].id = ${e};
  dataByteIndex = 0;

  compoundSerializer${y};
}`.$uses({indexBuffer:r,dataBuffer:n,dataBlockIndex:Ah,dataByteIndex:Ih,compoundSerializer:p}).$name(`log${e}`)}var qg=["log","debug","info","warn","error","clear"],Wg={logCountLimit:64,logSizeLimit:252,messagePrefix:" GPU "},Dh=B("/* console.log() */",at),Xg=class{get logResources(){}generateLog(){return console.warn("'console.log' is currently only supported in compute pipelines."),Dh}},Jg=class{#e;#t;#n=1;#r;#s;constructor(t){this.#e={...Wg,...t[E].logOptions},this.#t=new Map;let n=Wn({id:J,serializedData:Cn(J,Math.ceil(this.#e.logSizeLimit/4))}).$name("SerializedLogData");this.#s=t.createMutable(Cn(n,this.#e.logCountLimit)).$name("dataBuffer"),this.#r=t.createMutable(kc(J)).$name("indexBuffer")}generateLog(t,n,r){if(!qg.includes(n))return console.warn(`Unsupported log method '${n}' was used in TGSL.`),Dh;let s=Uf(r),i=this.#n++,p=s.filter(_=>_.dataType!==kt),y=Cg(i,p.map(_=>_.dataType),this.#s,this.#r,this.#e),v=s.map(_=>_.dataType===kt?_.value:_.dataType);return this.#t.set(i,{op:n,argTypes:v}),B(S`${t.resolve(y).value}(${p})`,at)}get logResources(){return this.#n===1?void 0:{dataBuffer:this.#s,indexBuffer:this.#r,options:this.#e,logIdToMeta:this.#t}}},Rh="#CATCHALL#",Zg=class{_stack=[];_itemDepth=0;get itemDepth(){return this._itemDepth}get topItem(){let t=this._stack[this._stack.length-1];if(!t||t.type!=="item")throw new Error("Internal error, expected item layer to be on top.");return t}get topFunctionScope(){return this._stack.findLast(t=>t.type==="functionScope")}pushItem(){this._itemDepth++,this._stack.push({type:"item",usedSlots:new Set})}popItem(){this.pop("item")}pushSlotBindings(t){this._stack.push({type:"slotBinding",bindingMap:new WeakMap(t)})}popSlotBindings(){this.pop("slotBinding")}pushFunctionScope(t,n,r,s){let i={type:"functionScope",args:t,argAliases:n,returnType:r,externalMap:s,reportedReturnTypes:new Set};return this._stack.push(i),i}popFunctionScope(){this.pop("functionScope")}pushBlockScope(){this._stack.push({type:"blockScope",declarations:new Map})}popBlockScope(){this.pop("blockScope")}pop(t){let n=this._stack[this._stack.length-1];if(!n||t&&n.type!==t)throw new Error(`Internal error, expected a ${t} layer to be on top.`);this._stack.pop(),t==="item"&&this._itemDepth--}readSlot(t){for(let n=this._stack.length-1;n>=0;--n){let r=this._stack[n];if(r?.type==="item")r.usedSlots.add(t);else if(r?.type==="slotBinding"){let s=r.bindingMap.get(t);if(s!==void 0)return s}else if(!(r?.type==="functionScope"||r?.type==="blockScope"))throw new Error("Unknown layer type.")}return t.defaultValue}getSnippetById(t){for(let n=this._stack.length-1;n>=0;--n){let r=this._stack[n];if(r?.type==="functionScope"){let s=r.args.find(p=>p.value===t);if(s!==void 0)return s;if(r.argAliases[t])return r.argAliases[t];let i=r.externalMap[t];return i!=null?zi(i):void 0}if(r?.type==="blockScope"){let s=r.declarations.get(t);if(s!==void 0)return s}}}defineBlockVariable(t,n){if(n.dataType.type==="unknown")throw Error(`Tried to define variable '${t}' of unknown type`);for(let r=this._stack.length-1;r>=0;--r){let s=this._stack[r];if(s?.type==="blockScope"){s.declarations.set(t,n);return}}throw new Error("No block scope found to define a variable in.")}},Si=["","  ","    ","      ","        ","          ","            ","              ","                "],ga=Si.length-1,Hg=class{identLevel=0;get pre(){return Si[this.identLevel]??Si[ga].repeat(this.identLevel/ga)+Si[this.identLevel%ga]}indent(){let t=this.pre;return this.identLevel++,t}dedent(){return this.identLevel--,this.pre}withResetLevel(t){let n=this.identLevel;this.identLevel=0;try{return t()}finally{this.identLevel=n}}},Nh=class{#e;#t;_indentController=new Hg;_itemStateStack=new Zg;#n=[];_declarations=[];_varyingLocations;#r=new WeakSet;#s;get varyingLocations(){return this._varyingLocations}[E]={itemStateStack:this._itemStateStack};bindGroupLayoutsToPlaceholderMap=new Map;_nextFreeLayoutPlaceholderIdx=0;fixedBindings=[];enableExtensions;expectedType;constructor(e){this.enableExtensions=e.enableExtensions,this.#t=e.shaderGenerator??jc,this.#s=e.root?new Jg(e.root):new Xg,this.#e=e.namespace[E]}getUniqueName(e){return sg(this.#e,e)}makeNameValid(e){return this.#e.nameRegistry.makeValid(e)}get pre(){return this._indentController.pre}get topFunctionReturnType(){let e=this._itemStateStack.topFunctionScope;return er(e),e.returnType}get shelllessRepo(){return this.#e.shelllessRepo}indent(){return this._indentController.indent()}dedent(){return this._indentController.dedent()}withResetIndentLevel(e){return this._indentController.withResetLevel(e)}getById(e){let t=this._itemStateStack.getSnippetById(e);return t===void 0?null:t}defineVariable(e,t){this._itemStateStack.defineBlockVariable(e,t)}reportReturnType(e){let t=this._itemStateStack.topFunctionScope;er(t),t.reportedReturnTypes.add(e)}pushBlockScope(){this._itemStateStack.pushBlockScope()}popBlockScope(){this._itemStateStack.popBlockScope()}generateLog(e,t){return this.#s.generateLog(this,e,t)}get logResources(){return this.#s.logResources}fnToWgsl(e){let t=this._itemStateStack.pushFunctionScope(e.args,e.argAliases,e.returnType,e.externalMap);try{this.#t.initGenerator(this);let n=this.#t.functionDefinition(e.body),r=e.returnType;if(!r){let s=[...t.reportedReturnTypes];if(s.length===0)r=at;else{let i=xo(s);i&&!i.hasImplicitConversions&&(r=i.targetType)}if(!r)throw new Error(`Expected function to have a single return type, got [${s.join(", ")}]. Cast explicitly to the desired type.`);r=Ls(r)}return{head:Qg(this,e.args,r),body:n,returnType:r}}finally{this._itemStateStack.popFunctionScope()}}addDeclaration(e){this._declarations.push(e)}allocateLayoutEntry(e){let t=this.bindGroupLayoutsToPlaceholderMap,n=t.get(e);return n||(n=`#BIND_GROUP_LAYOUT_${this._nextFreeLayoutPlaceholderIdx++}#`,t.set(e,n)),n}allocateFixedEntry(e,t){let n=this.fixedBindings.length;return this.fixedBindings.push({layoutEntry:e,resource:t}),{group:Rh,binding:n}}readSlot(e){let t=this._itemStateStack.readSlot(e);if(t===void 0)throw new Up(e);return t}withSlots(e,t){this._itemStateStack.pushSlotBindings(e);try{return t()}finally{this._itemStateStack.popSlotBindings()}}withVaryingLocations(e,t){this._varyingLocations=e;try{return t()}finally{this._varyingLocations=void 0}}unwrap(e){if(ka(e))return this.withSlots(e[Ar].pairs,()=>this.unwrap(e[Ar].inner));let t=e;for(;;)if(Ia(t))t=this.readSlot(t);else if(Ba(t))t=this._getOrCompute(t);else break;return t}_getOrCompute(e){let t=this.#e.memoizedDerived.get(e)??[];this._itemStateStack.pushItem();try{for(let s of t)if([...s.slotToValueMap.entries()].every(([i,p])=>i.areEqual(this._itemStateStack.readSlot(i),p)))return s.result;this.pushMode(new Wl);let n;try{n=e["~compute"]()}finally{this.popMode("normal")}let r=new Map;for(let s of this._itemStateStack.topItem.usedSlots)r.set(s,this._itemStateStack.readSlot(s));return t.push({slotToValueMap:r,result:n}),this.#e.memoizedDerived.set(e,t),n}catch(n){throw n instanceof Ms?n.appendToTrace(e):new Ms(n,[e])}finally{this._itemStateStack.popItem()}}_getOrInstantiate(e){let t=this.#e.memoizedResolves.get(e)??[];this._itemStateStack.pushItem();try{for(let s of t)if([...s.slotToValueMap.entries()].every(([i,p])=>i.areEqual(this._itemStateStack.readSlot(i),p)))return s.result;let n;if(Dr(e))n=B(mh(this,e),at);else if(Ba(e)||Ia(e))n=this.resolve(this.unwrap(e));else if(Xl(e))n=e[he](this);else if(Ps(e)){let s=this.#e.shelllessRepo.get(e,void 0);if(!s)throw new Error(`Couldn't resolve ${e.name}. Make sure it's a function that accepts no arguments, or call it from another TypeGPU function.`);return this.withResetIndentLevel(()=>this.resolve(s))}else throw new TypeError(`Unresolvable internal value: ${Jt(e)}`);let r=new Map;for(let s of this._itemStateStack.topItem.usedSlots)r.set(s,this._itemStateStack.readSlot(s));return t.push({slotToValueMap:r,result:n}),this.#e.memoizedResolves.set(e,t),n}catch(n){throw n instanceof Ms?n.appendToTrace(e):new Ms(n,[e])}finally{this._itemStateStack.popItem()}}resolve(e,t){if(lh(e)||Ps(e)){if(this.#r.has(e)&&!this.#e.memoizedResolves.has(e))throw new Error(`Recursive function ${e} detected. Recursion is not allowed on the GPU.`);this.#r.add(e)}if(ka(e))return this.withSlots(e[Ar].pairs,()=>this.resolve(e[Ar].inner,t));if(Ge(e)||Ps(e)){if(this._itemStateStack.itemDepth===0)try{this.pushMode(new Bp);let n=Jl(this,()=>this._getOrInstantiate(e));return B(`${[...this._declarations].join(`

`)}${n.value}`,at)}finally{this.popMode("codegen")}return this._getOrInstantiate(e)}if(typeof e=="number"){let n=t??Ni(e).dataType;if(er(n.type!=="unknown"),n.type==="abstractInt")return B(`${e}`,n);if(n.type==="u32")return B(`${e}u`,n);if(n.type==="i32")return B(`${e}i`,n);let r=e.toExponential(),s=n.type==="abstractFloat"&&Number.isInteger(e)?`${e}.`:`${e}`,i=r.length<s.length?r:s;return n.type==="f32"?B(`${i}f`,n):n.type==="f16"?B(`${i}h`,n):B(i,n)}if(typeof e=="boolean")return B(e?"true":"false",ke);if(typeof e=="string")return B(e,at);if(t&&Lt(t)){if(!Array.isArray(e))throw new yn(`Cannot coerce ${e} into value of type '${t}'`);if(t.elementCount!==e.length)throw new yn(`Cannot create value of type '${t}' from an array of length: ${e.length}`);let n=this.resolve(t.elementType);return B(S`array<${n}, ${t.elementCount}>(${e.map(r=>B(r,t.elementType))})`,t)}if(Array.isArray(e))return B(S`array(${e.map(n=>this.resolve(n))})`,kt);if(t&&vt(t))return B(S`${this.resolve(t)}(${Object.entries(t.propTypes).map(([n,r])=>B(e[n],r))})`,t);throw new yn(`Value ${e} (as json: ${Jt(e)}) is not resolvable${t?` to type ${t.type}`:""}`)}pushMode(e){this.#n.push(e)}popMode(e){let t=this.#n.pop();e!==void 0&&er(t?.type===e)}get mode(){return this.#n[this.#n.length-1]??Zl}};function Wo(e,t){let n=new Nh(t),r=(t.config?n.withSlots(t.config(new yh([])).bindings,()=>n.resolve(e)):n.resolve(e)).value,s=n.bindGroupLayoutsToPlaceholderMap,i=[],p=new Set([...s.keys()].map(U=>U.index).filter(U=>U!==void 0)),y=pg(p),v=n.fixedBindings.map((U,N)=>[String(N),U.layoutEntry]),_=()=>{let U=y.next().value,N=zh(Object.fromEntries(v));return i[U]=N,r=r.replaceAll(Rh,String(U)),[U,new Ph(N,Object.fromEntries(n.fixedBindings.map((j,L)=>[String(L),j.resource])))]},P=v.length>0?_():void 0;for(let[U,N]of s.entries()){let j=U.index??y.next().value;i[j]=U,r=r.replaceAll(N,String(j))}return t.enableExtensions&&t.enableExtensions.length>0&&(r=`${t.enableExtensions.map(U=>`enable ${U};`).join(`
`)}

${r}`),{code:r,usedBindGroupLayouts:i,catchall:P,logResources:n.logResources}}function Qg(e,t,n){let r=t.map(s=>`${s.value}: ${e.resolve(s.dataType).value}`).join(", ");return n.type!=="void"?`(${r}) -> ${Vo(n)}${e.resolve(n).value} `:`(${r}) `}function Fh(e){let t=e;return t?.resourceType==="compute-pipeline"&&!!t[E]}function Lh(e){let t=e;return t?.resourceType==="render-pipeline"&&!!t[E]}function Kg(e){return Lh(e)||Fh(e)}function jh(e){let{externals:t,shaderGenerator:n,template:r,names:s="random",config:i,enableExtensions:p}=e,y={};Is(y,t??{});let v={[E]:!0,[he](P){return B(ta(P,y,r??""),at)},toString:()=>"<root>"},_=Object.values(t).filter(Kg);if(_.length>1)throw new Error(`Found ${_.length} pipelines but can only resolve one at a time.`);return Wo(v,{namespace:typeof s=="string"?ii({names:s}):s,enableExtensions:p,shaderGenerator:n,config:i,root:_[0]?.[E].branch})}function ew(e){return jh(e).code}function tw(e){let t=gr()??new Nh({namespace:ii(),shaderGenerator:jc}),n=[1,1,1],r=[1,1,1],s=[n[0]*r[0],n[1]*r[1],n[2]*r[2]],i=new Map,p=Array.from({length:n[0]},()=>Array.from({length:n[1]},()=>Array.from({length:n[2]},()=>new Map))),y=Array.from({length:s[0]},()=>Array.from({length:s[1]},()=>Array.from({length:s[2]},()=>new Map))),v=Array.from({length:s[0]},(_,P)=>Array.from({length:s[1]},(U,N)=>Array.from({length:s[2]},(j,L)=>{let Z=Math.floor(P/r[0]),Q=Math.floor(N/r[1]),se=Math.floor(L/r[2]);return new kp(i,{private:y[P][N][L],workgroup:p[Z][Q][se]})})));t.pushMode(v[0][0][0]);try{return{value:Jl(t,e),buffers:i,privateVars:y,workgroupVars:p}}finally{t.popMode("simulate")}}function nw(e,t,n,r){return new rw(e,t,n,r)}function Xo(e){let t=e;return t?.resourceType==="query-set"&&!!t[E]}var rw=class{constructor(t,n,r,s){this.type=n,this.count=r,this.rawQuerySet=s,this.#e=t.device,this._ownQuerySet=!s,this._querySet=s||null}resourceType="query-set";#e;_querySet=null;_ownQuerySet;_destroyed=!1;_available=!0;_readBuffer=null;_resolveBuffer=null;get querySet(){if(this._destroyed)throw new Error("This QuerySet has been destroyed.");return this.rawQuerySet?this.rawQuerySet:this._querySet?this._querySet:(this._querySet=this.#e.createQuerySet({type:this.type,count:this.count}),this._querySet)}get destroyed(){return this._destroyed}get available(){return this._available}get[E](){let t=this;return{get readBuffer(){return t._readBuffer||(t._readBuffer=t.#e.createBuffer({size:t.count*BigUint64Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})),t._readBuffer},get resolveBuffer(){return t._resolveBuffer||(t._resolveBuffer=t.#e.createBuffer({size:t.count*BigUint64Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC})),t._resolveBuffer}}}$name(t){return Fe(this,t),this._querySet&&(this._querySet.label=t),this}resolve(){if(this._destroyed)throw new Error("This QuerySet has been destroyed.");if(!this._available)throw new Error("This QuerySet is busy resolving or reading.");let t=this.#e.createCommandEncoder();t.resolveQuerySet(this.querySet,0,this.count,this[E].resolveBuffer,0),this.#e.queue.submit([t.finish()])}async read(){if(!this._resolveBuffer)throw new Error("QuerySet must be resolved before reading.");this._available=!1;try{let t=this.#e.createCommandEncoder();t.copyBufferToBuffer(this[E].resolveBuffer,0,this[E].readBuffer,0,this.count*BigUint64Array.BYTES_PER_ELEMENT),this.#e.queue.submit([t.finish()]);let n=this[E].readBuffer;await n.mapAsync(GPUMapMode.READ);let r=new BigUint64Array(n.getMappedRange().slice());return n.unmap(),Array.from(r)}finally{this._available=!0}}destroy(){this._destroyed||(this._destroyed=!0,this._querySet&&this._ownQuerySet&&this._querySet.destroy(),this._readBuffer?.destroy(),this._resolveBuffer?.destroy(),this._readBuffer=this._resolveBuffer=null)}},Gu=class{constructor(e){this._make=e}_map=new WeakMap;getOrMake(e,...t){if(this._map.has(e))return this._map.get(e);let n=this._make(e,...t);return this._map.set(e,n),n}},wa=class{constructor(e,t){this.resourceType=e,this.buffer=t,this[st]=t,this.#e=this.buffer.as(this.resourceType)}[E]=!0;[st];#e;$name(e){return Fe(this[st],e),this}write(e){this.buffer.write(e)}writePartial(e){this.buffer.writePartial(e)}read(){return this.buffer.read()}get[Ne](){return this.#e.$}get $(){return this.#e.$}get value(){return this.$}[he](e){return e.resolve(this.#e)}},ye=e=>th(e??0),Vn=e=>nh(e??0),rs=e=>rh(e??0),sw={f32:e=>ye(e[0]),f16:e=>rs(e[0]).x,i32:e=>Vn(e[0]),u32:e=>e[0]??0,bool:e=>!!e[0],vec2f:e=>G(ye(e[0]),ye(e[1])),vec3f:e=>O(ye(e[0]),ye(e[1]),ye(e[2])),vec4f:e=>k(ye(e[0]),ye(e[1]),ye(e[2]),ye(e[3])),vec2h(e){let t=rs(e[0]);return Un(t.x,t.y)},vec3h(e){let t=rs(e[0]),n=rs(e[1]);return An(t.x,t.y,n.x)},vec4h(e){let t=rs(e[0]),n=rs(e[1]);return In(t.x,t.y,n.x,n.y)},vec2i:e=>Be(Vn(e[0]),Vn(e[1])),vec3i:e=>Ot(Vn(e[0]),Vn(e[1]),Vn(e[2])),vec4i:e=>Le(Vn(e[0]),Vn(e[1]),Vn(e[2]),Vn(e[3])),vec2u:e=>xt(e[0]??0,e[1]??0),vec3u:e=>rt(e[0]??0,e[1]??0,e[2]??0),vec4u:e=>Ce(e[0]??0,e[1]??0,e[2]??0,e[3]??0),"vec2<bool>":e=>br(!!e[0],!!e[1]),"vec3<bool>":e=>Tr(!!e[0],!!e[1],!!e[2]),"vec4<bool>":e=>_r(!!e[0],!!e[1],!!e[2],!!e[3]),mat2x2f:e=>xn(ye(e[0]),ye(e[1]),ye(e[2]),ye(e[3])),mat3x3f:e=>Bn(ye(e[0]),ye(e[1]),ye(e[2]),ye(e[4]),ye(e[5]),ye(e[6]),ye(e[8]),ye(e[9]),ye(e[10])),mat4x4f:e=>ve(ye(e[0]),ye(e[1]),ye(e[2]),ye(e[3]),ye(e[4]),ye(e[5]),ye(e[6]),ye(e[7]),ye(e[8]),ye(e[9]),ye(e[10]),ye(e[11]),ye(e[12]),ye(e[13]),ye(e[14]),ye(e[15]))};function iw(e,t){let n=sw[t.type];if(n)return n(e);if(vt(t)){let r=Object.keys(t.propTypes),s=Object.values(t.propTypes),i=Ha(e,s);return Object.fromEntries(r.map((p,y)=>[p,i[y]]))}if(Lt(t)){let r=t.elementType,s=t.elementCount;return Ha(e,Array.from({length:s},()=>r))}throw new Error(`Cannot deserialize data of type ${t.type}`)}function Ha(e,t){let n=0;return t.map(r=>{if(!zt(r))return r;let s=Math.ceil(Me(r)/4),i=iw(e.subarray(n,n+s),r);return n+=s,i})}function aw(e,t){return Ha(e,t).map(Ga)}function Qa(e){let{indexBuffer:t,dataBuffer:n,logIdToMeta:r,options:s}=e;n.read().then(i=>{i.filter(p=>p.id).forEach(({id:p,serializedData:y})=>{let{argTypes:v,op:_}=r.get(p),P=aw(new Uint32Array(y),v);P.length===0&&P.push(""),console[_](`%c${s.messagePrefix}%c ${P[0]}`,"background: #936ff5; color: white;","color: inherit; background: none",...P.slice(1))})}),t.read().then(i=>{i>s.logCountLimit&&console.warn(`Log count limit per dispatch (${s.logCountLimit}) exceeded by ${i-s.logCountLimit} calls. Consider increasing the limit by passing appropriate options to tgpu.init().`)}),n.buffer.clear(),t.buffer.clear()}function Yh(e,t,n){if(!n.enabledFeatures.has("timestamp-query"))throw new Error('Performance callback requires the "timestamp-query" feature to be enabled on GPU device.');return e.timestampWrites?{...e,performanceCallback:t}:{...e,performanceCallback:t,hasAutoQuerySet:!0,timestampWrites:{querySet:(globalThis.__TYPEGPU_AUTONAME__??(r=>r))(n.createQuerySet("timestamp",2),"querySet"),beginningOfPassWriteIndex:0,endOfPassWriteIndex:1}}}function Ch(e,t,n){if(!n.enabledFeatures.has("timestamp-query"))throw new Error('Timestamp writes require the "timestamp-query" feature to be enabled on GPU device.');e.hasAutoQuerySet&&e.timestampWrites&&e.timestampWrites.querySet.destroy();let r={querySet:t.querySet};return t.beginningOfPassWriteIndex!==void 0&&(r.beginningOfPassWriteIndex=t.beginningOfPassWriteIndex),t.endOfPassWriteIndex!==void 0&&(r.endOfPassWriteIndex=t.endOfPassWriteIndex),{...e,hasAutoQuerySet:!1,timestampWrites:r}}function qh(e,t){if(!e.timestampWrites)return{};let{querySet:n,beginningOfPassWriteIndex:r,endOfPassWriteIndex:s}=e.timestampWrites,i={querySet:Xo(n)?t.unwrap(n):n};return r!==void 0&&(i.beginningOfPassWriteIndex=r),s!==void 0&&(i.endOfPassWriteIndex=s),{timestampWrites:i}}function Ka({root:e,priors:t}){let n=t.timestampWrites?.querySet,r=t.performanceCallback;if(!n)throw new Error("Cannot dispatch workgroups with performance callback without a query set.");if(!Xo(n))throw new Error("Performance callback with raw GPUQuerySet is not supported. Use TgpuQuerySet instead.");let s=e.device.createCommandEncoder();s.resolveQuerySet(e.unwrap(n),0,n.count,n[E].resolveBuffer,0),e.device.queue.submit([s.finish()]),e.device.queue.onSubmittedWorkDone().then(async()=>{if(!n.available)return;let i=await n.read(),p=i[t.timestampWrites?.beginningOfPassWriteIndex??0],y=i[t.timestampWrites?.endOfPassWriteIndex??1];if(p===void 0||y===void 0)throw new Error("QuerySet did not return valid timestamps.");await r(p,y)})}function ow(e,t,n){return new uw(new lw(e,t,n),{})}var uw=class Es{constructor(t,n){this._core=t,this._priors=n,this[E]={get rawPipeline(){return t.unwrap().pipeline},get priors(){return n},get branch(){return t.branch}},this[st]=t}[E];resourceType="compute-pipeline";[st];[he](t){return t.resolve(this._core)}toString(){return`computePipeline:${W(this)??"<unnamed>"}`}get rawPipeline(){return this._core.unwrap().pipeline}with(t,n){return Yi(t)?new Es(this._core,{...this._priors,bindGroupLayoutMap:new Map([...this._priors.bindGroupLayoutMap??[],[t.layout,t]])}):new Es(this._core,{...this._priors,bindGroupLayoutMap:new Map([...this._priors.bindGroupLayoutMap??[],[t,n]])})}withPerformanceCallback(t){let n=Yh(this._priors,t,this._core.branch);return new Es(this._core,n)}withTimestampWrites(t){let n=Ch(this._priors,t,this._core.branch);return new Es(this._core,n)}dispatchWorkgroups(t,n,r){let s=this._core.unwrap(),{branch:i}=this._core,p={label:W(this._core)??"<unnamed>",...qh(this._priors,i)},y=i.device.createCommandEncoder(),v=y.beginComputePass(p);v.setPipeline(s.pipeline);let _=new Set(s.usedBindGroupLayouts);if(s.usedBindGroupLayouts.forEach((P,U)=>{if(s.catchall&&U===s.catchall[0])v.setBindGroup(U,i.unwrap(s.catchall[1])),_.delete(P);else{let N=this._priors.bindGroupLayoutMap?.get(P);N!==void 0&&(_.delete(P),v.setBindGroup(U,i.unwrap(N)))}}),_.size>0)throw new mo(_);v.dispatchWorkgroups(t,n,r),v.end(),i.device.queue.submit([y.finish()]),s.logResources&&Qa(s.logResources),this._priors.performanceCallback&&Ka({root:i,priors:this._priors})}$name(t){return Fe(this._core,t),this}},lw=class{constructor(t,n,r){this.branch=t,this._slotBindings=n,this._entryFn=r}[E]=!0;_memo;[he](t){return t.withSlots(this._slotBindings,()=>(t.resolve(this._entryFn),B("",at)))}toString(){return"computePipelineCore"}unwrap(){if(this._memo===void 0){let t=this.branch.device,n=Co.filter(P=>this.branch.enabledFeatures.has(oh[P])),r,s=ii({names:this.branch.nameRegistrySetting});r=Wo(this,{namespace:s,enableExtensions:n,shaderGenerator:this.branch.shaderGenerator,root:this.branch});let{code:i,usedBindGroupLayouts:p,catchall:y,logResources:v}=r;y!==void 0&&p[y[0]]?.$name(`${W(this)??"<unnamed>"} - Automatic Bind Group & Layout`);let _=t.createShaderModule({label:`${W(this)??"<unnamed>"} - Shader`,code:i});this._memo={pipeline:t.createComputePipeline({label:W(this)??"<unnamed>",layout:t.createPipelineLayout({label:`${W(this)??"<unnamed>"} - Pipeline Layout`,bindGroupLayouts:p.map(P=>this.branch.unwrap(P))}),compute:{module:_}}),usedBindGroupLayouts:p,catchall:y,logResources:v}}return this._memo}};function Du(e,t="vertex"){return new cw(e,t)}function Wh(e){return e?.resourceType==="vertex-layout"}var eo=Symbol("defaultAttribEntry");function Pi(e,t,n,r,s){if(zn(t)||Sn(t)){let i=yr(t);return i!==void 0&&(r[s??eo]=i),Pi(e,t.inner,sn(n,wn(t)),r)}if(vt(t)){let i=n,p=t.propTypes;return Object.fromEntries(Object.entries(p).map(([y,v])=>{i=sn(i,tt(v));let _=[y,Pi(e,v,i,r,y)];return i+=Me(v),_}))}if(En(t)){let i=n,p=t.propTypes;return Object.fromEntries(Object.entries(p).map(([y,v])=>{i=sn(i,wn(v));let _=[y,Pi(e,v,i,r,y)];return i+=Me(v),_}))}if("type"in t&&typeof t.type=="string"){if(Vl.includes(t.type))return{_layout:e,format:t.type,offset:n};let i=zp[t.type];if(i)return{_layout:e,format:i,offset:n}}throw new Error(`Unsupported data used in vertex layout: ${String(t)}`)}var cw=class{constructor(t,n){this.schemaForCount=t,this.stepMode=n;let r=t(0);this.stride=sn(Me(r.elementType),tt(r)),this.attrib=Pi(this,r.elementType,0,this._customLocationMap)}[E]=!0;resourceType="vertex-layout";stride;attrib;_customLocationMap={};get vertexLayout(){if(this._customLocationMap[eo]!==void 0){if(typeof this.attrib.format!="string"||typeof this.attrib.offset!="number")throw new Error("Single attribute vertex layouts must have a format and offset.");return{arrayStride:this.stride,stepMode:this.stepMode,attributes:[{format:this.attrib.format,offset:this.attrib.offset,shaderLocation:this._customLocationMap[eo]}]}}if(!Object.keys(this.attrib).every(t=>this._customLocationMap[t]!==void 0))throw new Error("All attributes must have custom locations in order to unwrap a vertex layout.");return{arrayStride:this.stride,stepMode:this.stepMode,attributes:[...Object.entries(this.attrib).map(([t,n])=>({format:n.format,offset:n.offset,shaderLocation:this._customLocationMap[t]}))]}}$name(t){return Fe(this,t),this}};function hw(e){return typeof e?.loadOp=="string"}function pw(e,t){if(Dr(e)){if(!hw(t))throw new Error("Expected a single color attachment, not a record.");return[t]}let n=[];for(let r of Object.keys(e)){let s=e[r];if(Nr(s))continue;let i=t[r];if(!i)throw new Error(`A color attachment by the name of '${r}' was not provided to the shader.`);n.push(i)}return n}function dw(e){return typeof e?.format=="string"}function fw(e,t){if(Dr(e)){if(kl(e))return[];if(!dw(t))throw new Error("Expected a single color target configuration, not a record.");return[t]}let n=[];for(let r of Object.keys(e)){let s=e[r];if(Nr(s))continue;let i=t[r];if(!i)throw new Error(`A color target by the name of '${r}' was not provided to the shader.`);n.push(i)}return n}function Xh(e){return new mw(new yw(e),{})}var mw=class Rn{[E];resourceType="render-pipeline";[st];hasIndexBuffer=!1;constructor(t,n){this[E]={core:t,priors:n,branch:t.options.branch},this[st]=t}[he](t){return t.resolve(this[E].core)}toString(){return`renderPipeline:${W(this)??"<unnamed>"}`}$name(t){return Fe(this[E].core,t),this}with(t,n){let r=this[E];if(Yi(t))return new Rn(r.core,{...r.priors,bindGroupLayoutMap:new Map([...r.priors.bindGroupLayoutMap??[],[t.layout,t]])});if(Eh(t))return new Rn(r.core,{...r.priors,bindGroupLayoutMap:new Map([...r.priors.bindGroupLayoutMap??[],[t,n]])});if(Wh(t))return new Rn(r.core,{...r.priors,vertexLayoutMap:new Map([...r.priors.vertexLayoutMap??[],[t,n]])});throw new Error("Unsupported value passed into .with()")}withPerformanceCallback(t){let n=this[E],r=Yh(n.priors,t,n.core.options.branch);return new Rn(n.core,r)}withTimestampWrites(t){let n=this[E],r=Ch(n.priors,t,n.core.options.branch);return new Rn(n.core,r)}withColorAttachment(t){let n=this[E];return new Rn(n.core,{...n.priors,colorAttachment:t})}withDepthStencilAttachment(t){let n=this[E];return new Rn(n.core,{...n.priors,depthStencilAttachment:t})}withIndexBuffer(t,n,r,s){let i=this[E];if(Oa(t)){if(typeof n!="string")throw new Error("If a GPUBuffer is passed, indexFormat must be provided.");return new Rn(i.core,{...i.priors,indexBuffer:{buffer:t,indexFormat:n,offsetBytes:r,sizeBytes:s}})}let p={u32:"uint32",u16:"uint16"},y=t.dataType.elementType;return new Rn(i.core,{...i.priors,indexBuffer:{buffer:t,indexFormat:p[y.type],offsetBytes:n!==void 0?n*Me(y):void 0,sizeBytes:s!==void 0?s*Me(y):void 0}})}setupRenderPass(t){let n=this[E],r=n.core.unwrap(),{branch:s,fragmentFn:i}=n.core.options,p=i?pw(i.shell.out,n.priors.colorAttachment??{}).map(U=>qs(U.view)?{...U,view:s.unwrap(U.view).createView()}:ji(U.view)?{...U,view:s.unwrap(U.view)}:U):[null],y={label:W(n.core)??"<unnamed>",colorAttachments:p,...qh(n.priors,s)};if(n.priors.depthStencilAttachment!==void 0){let U=n.priors.depthStencilAttachment;qs(U.view)?y.depthStencilAttachment={...U,view:s.unwrap(U.view).createView()}:y.depthStencilAttachment=U}let v=t.beginRenderPass(y);v.setPipeline(r.pipeline);let _=new Set(r.usedBindGroupLayouts);r.usedBindGroupLayouts.forEach((U,N)=>{if(r.catchall&&N===r.catchall[0])v.setBindGroup(N,s.unwrap(r.catchall[1])),_.delete(U);else{let j=n.priors.bindGroupLayoutMap?.get(U);j!==void 0&&(_.delete(U),v.setBindGroup(N,s.unwrap(j)))}});let P=new Set(n.core.usedVertexLayouts);if(n.core.usedVertexLayouts.forEach((U,N)=>{let j=n.priors.vertexLayoutMap?.get(U);j&&(P.delete(U),v.setVertexBuffer(N,s.unwrap(j)))}),_.size>0)throw new mo(_);if(P.size>0)throw new Fl(P);return v}draw(t,n,r,s){let i=this[E],{branch:p}=i.core.options,{logResources:y}=i.core.unwrap(),v=p.device.createCommandEncoder(),_=this.setupRenderPass(v);_.draw(t,n,r,s),_.end(),p.device.queue.submit([v.finish()]),y&&Qa(y),i.priors.performanceCallback&&Ka({root:p,priors:i.priors})}drawIndexed(t,n,r,s,i){let p=this[E];if(!p.priors.indexBuffer)throw new Error("No index buffer set for this render pipeline.");let{logResources:y}=p.core.unwrap(),{branch:v}=p.core.options,{buffer:_,indexFormat:P,offsetBytes:U,sizeBytes:N}=p.priors.indexBuffer,j=v.device.createCommandEncoder(),L=this.setupRenderPass(j);Oa(_)?L.setIndexBuffer(_,P,U,N):L.setIndexBuffer(v.unwrap(_),P,U,N),L.drawIndexed(t,n,r,s,i),L.end(),v.device.queue.submit([j.finish()]),y&&Qa(y),p.priors.performanceCallback&&Ka({root:v,priors:p.priors})}},yw=class{constructor(t){this.options=t;let n=ig(t.vertexFn.shell.in??{},t.vertexAttribs);this._vertexBufferLayouts=n.bufferDefinitions,this.usedVertexLayouts=n.usedVertexLayouts,this._targets=t.fragmentFn&&t.targets?fw(t.fragmentFn.shell.out,t.targets):[null]}[E]=!0;usedVertexLayouts;_memo;_vertexBufferLayouts;_targets;[he](t){let{vertexFn:n,fragmentFn:r,slotBindings:s}=this.options,i=gw(n.shell.out,r?.shell.in,W(n)??"<unnamed>",W(r)??"<unnamed>");return t.withVaryingLocations(i,()=>t.withSlots(s,()=>(t.resolve(n),r&&t.resolve(r),B("",at))))}toString(){return"renderPipelineCore"}unwrap(){if(this._memo===void 0){let{branch:t,primitiveState:n,depthStencilState:r,multisampleState:s}=this.options,i=t.device,p=Co.filter(Q=>t.enabledFeatures.has(oh[Q])),y,v=ii({names:t.nameRegistrySetting});y=Wo(this,{namespace:v,enableExtensions:p,shaderGenerator:t.shaderGenerator,root:t});let{code:_,usedBindGroupLayouts:P,catchall:U,logResources:N}=y;U!==void 0&&P[U[0]]?.$name(`${W(this)??"<unnamed>"} - Automatic Bind Group & Layout`);let j=i.createShaderModule({label:`${W(this)??"<unnamed>"} - Shader`,code:_}),L={layout:i.createPipelineLayout({label:`${W(this)??"<unnamed>"} - Pipeline Layout`,bindGroupLayouts:P.map(Q=>t.unwrap(Q))}),vertex:{module:j,buffers:this._vertexBufferLayouts}},Z=W(this);Z!==void 0&&(L.label=Z),this.options.fragmentFn&&(L.fragment={module:j,targets:this._targets}),n&&(zt(n.stripIndexFormat)?L.primitive={...n,stripIndexFormat:{u32:"uint32",u16:"uint16"}[n.stripIndexFormat.type]}:L.primitive=n),r&&(L.depthStencil=r),s&&(L.multisample=s),this._memo={pipeline:i.createRenderPipeline(L),usedBindGroupLayouts:P,catchall:U,logResources:N}}return this._memo}};function gw(e,t,n,r){let s={},i=new Set;function p(v,_){s[v]=_,i.add(_)}for(let[v,_]of Object.entries(e)){let P=yr(_);P!==void 0&&p(v,P)}for(let[v,_]of Object.entries(t??{})){let P=yr(_);P!==void 0&&(s[v]===void 0?p(v,P):s[v]!==P&&console.warn(`Mismatched location between vertexFn (${n}) output (${s[v]}) and fragmentFn (${r}) input (${P}) for the key "${v}", using the location set on vertex output.`))}let y=0;for(let v of Object.keys(e??{}))if(!(Nr(e[v])||s[v]!==void 0)){for(;i.has(y);)y++;p(v,y)}return s}function ww(e){if(e.includes(0))throw new Error("Size and workgroupSize cannot contain zeroes.");return rt(e[0]??1,e[1]??1,e[2]??1)}var xw=[rt(1,1,1),rt(256,1,1),rt(16,16,1),rt(8,8,4)],vw=class Jh{#e;#t;#n;#r;#s;constructor(t,n,r,s){this.#e=t,this.#t=n,this.#n=r,this.#r=s,this.#s=rt()}with(t){return new Jh(this.#e,this.#t.with(t),this.#n,this.#r)}dispatchThreads(...t){let n=ww(t),r=Gc(O(n).div(O(this.#r)));sh(n,this.#s)||(this.#s=n,this.#n.write(n)),this.#t.dispatchWorkgroups(r.x,r.y,r.z)}get pipeline(){return this.#t}get sizeUniform(){return this.#n}},bw=class to{constructor(t,n){this._getRoot=t,this._slotBindings=n}with(t,n){return new to(this._getRoot,[...this._slotBindings,[ea(t)?t.slot:t,n]])}withCompute(t){return new Tw(this._getRoot(),this._slotBindings,t)}createGuardedComputePipeline(t){let n=this._getRoot();if(t.length>=4)throw new Error("Guarded compute callback only supports up to three dimensions.");let r=xw[t.length],s=Ve([J,J,J])(t),i=(globalThis.__TYPEGPU_AUTONAME__??(v=>v))(n.createUniform(rt),"o"),p=uh({workgroupSize:r,in:{id:Fs.globalInvocationId}})`{
  if (any(in.id >= sizeUniform)) {
    return;
  }
  wrappedCallback(in.id.x, in.id.y, in.id.z);
}`.$uses({sizeUniform:i,wrappedCallback:s}),y=(globalThis.__TYPEGPU_AUTONAME__??(v=>v))(this.withCompute(p).createPipeline(),"i");return new vw(n,y,i,r)}withVertex(t,n){return new _w({branch:this._getRoot(),primitiveState:void 0,depthStencilState:void 0,slotBindings:this._slotBindings,vertexFn:t,vertexAttribs:n,multisampleState:void 0})}pipe(t){let n=t(new yh([]));return new to(this._getRoot,[...this._slotBindings,...n.bindings])}},Tw=class{constructor(e,t,n){this._root=e,this._slotBindings=t,this._entryFn=n}createPipeline(){return ow(this._root,this._slotBindings,this._entryFn)}},_w=class Ui{constructor(t){this._options=t}withFragment(t,n,r){return er(typeof t!="string"),er(typeof n!="string"),new $w({...this._options,fragmentFn:t,targets:n})}withPrimitive(t){return new Ui({...this._options,primitiveState:t})}withDepthStencil(t){return new Ui({...this._options,depthStencilState:t})}withMultisample(t){return new Ui({...this._options,multisampleState:t})}createPipeline(){return Xh({...this._options,fragmentFn:null,targets:null})}},$w=class Ai{constructor(t){this._options=t}withPrimitive(t){return new Ai({...this._options,primitiveState:t})}withDepthStencil(t){return new Ai({...this._options,depthStencilState:t})}withMultisample(t){return new Ai({...this._options,multisampleState:t})}createPipeline(){return Xh(this._options)}},Zh=class extends bw{constructor(t,n,r,s,i){super(()=>this,[]),this.device=t,this.nameRegistrySetting=n,this._ownDevice=r,this.shaderGenerator=i,this["~unstable"]=this,this[E]={logOptions:s}}"~unstable";_unwrappedBindGroupLayouts=new Gu(t=>t.unwrap(this));_unwrappedBindGroups=new Gu(t=>t.unwrap(this));[E];get enabledFeatures(){return new Set(this.device.features)}createBuffer(t,n){return bi(this,t,n)}createUniform(t,n){let r=bi(this,t,n).$usage("uniform");return new wa("uniform",r)}createMutable(t,n){let r=bi(this,t,n).$usage("storage");return new wa("mutable",r)}createReadonly(t,n){let r=bi(this,t,n).$usage("storage");return new wa("readonly",r)}createQuerySet(t,n,r){return nw(this,t,n,r)}createBindGroup(t,n){return new Ph(t,n)}destroy(){Sg(this.device),this._ownDevice&&this.device.destroy()}createTexture(t){return Og(t,this)}createSampler(t){return $g(t,this)}createComparisonSampler(t){return Mg(t,this)}unwrap(t){if(Fh(t))return t[E].rawPipeline;if(Lh(t))return t[E].core.unwrap().pipeline;if(Eh(t))return this._unwrappedBindGroupLayouts.getOrMake(t);if(Yi(t))return this._unwrappedBindGroups.getOrMake(t);if(Gs(t))return t.buffer;if(qs(t))return t[E].unwrap();if(ji(t)){if(!t[E].unwrap)throw new Error("Cannot unwrap laid-out texture view as it has no underlying resource.");return t[E].unwrap()}if(Wh(t))return t.vertexLayout;if(bh(t)||Th(t)){if(t[E].unwrap)return t[E].unwrap();throw new Error("Cannot unwrap laid-out sampler.")}if(Xo(t))return t.querySet;throw new Error(`Unknown resource type: ${t}`)}beginRenderPass(t,n){let r=this.device.createCommandEncoder(),s=r.beginRenderPass(t),i=new Map,p=new Map,y,v=()=>{if(!y)throw new Error("Cannot draw without a call to pass.setPipeline");let{core:_,priors:P}=y[E],U=_.unwrap();s.setPipeline(U.pipeline);let N=new Set(U.usedBindGroupLayouts);U.usedBindGroupLayouts.forEach((L,Z)=>{if(U.catchall&&Z===U.catchall[0])s.setBindGroup(Z,this.unwrap(U.catchall[1])),N.delete(L);else{let Q=P.bindGroupLayoutMap?.get(L)??i.get(L);Q!==void 0&&(N.delete(L),Yi(Q)?s.setBindGroup(Z,this.unwrap(Q)):s.setBindGroup(Z,Q))}});let j=new Set;if(_.usedVertexLayouts.forEach((L,Z)=>{let Q=P.vertexLayoutMap?.get(L),se=Q?{buffer:Q,offset:void 0,size:void 0}:p.get(L);!se||!se.buffer?j.add(L):Gs(se.buffer)?s.setVertexBuffer(Z,this.unwrap(se.buffer),se.offset,se.size):s.setVertexBuffer(Z,se.buffer,se.offset,se.size)}),N.size>0)throw new mo(N);if(j.size>0)throw new Fl(j)};n({setViewport(..._){s.setViewport(..._)},setScissorRect(..._){s.setScissorRect(..._)},setBlendConstant(..._){s.setBlendConstant(..._)},setStencilReference(..._){s.setStencilReference(..._)},beginOcclusionQuery(..._){s.beginOcclusionQuery(..._)},endOcclusionQuery(..._){s.endOcclusionQuery(..._)},executeBundles(..._){s.executeBundles(..._)},setPipeline(_){y=_},setIndexBuffer:(_,P,U,N)=>{Gs(_)?s.setIndexBuffer(this.unwrap(_),P,U,N):s.setIndexBuffer(_,P,U,N)},setVertexBuffer(_,P,U,N){p.set(_,{buffer:P,offset:U,size:N})},setBindGroup(_,P){i.set(_,P)},draw(_,P,U,N){v(),s.draw(_,P,U,N)},drawIndexed(..._){v(),s.drawIndexed(..._)},drawIndirect(..._){v(),s.drawIndirect(..._)},drawIndexedIndirect(..._){v(),s.drawIndexedIndirect(..._)}}),s.end(),this.device.queue.submit([r.finish()])}flush(){console.warn("flush() has been deprecated, and has no effect.")}};async function Mw(e){let{adapter:t,device:n,unstable_names:r="random",unstable_logOptions:s}=e??{};if(!navigator.gpu)throw new Error("WebGPU is not supported by this browser.");let i=await navigator.gpu.requestAdapter(t);if(!i)throw new Error("Could not find a compatible GPU");let p=[];for(let v of n?.requiredFeatures??[]){if(!i.features.has(v))throw new Error(`Requested feature "${v}" is not supported by the adapter.`);p.push(v)}for(let v of n?.optionalFeatures??[])i.features.has(v)?p.push(v):console.warn(`Optional feature "${v}" is not supported by the adapter.`);let y=await i.requestDevice({...n,requiredFeatures:p});return new Zh(y,r,!0,s??{},e?.shaderGenerator)}function zw(e){let{device:t,unstable_names:n="random",unstable_logOptions:r}=e??{};return new Zh(t,n,!1,r??{},e?.shaderGenerator)}function Ew(e,t){return new Sw(e,t)}var Sw=class{constructor(e,t=void 0){this.schema=e,this.defaultValue=t,this.slot=Ci(t),this[st]=this.slot}[E]=!0;[st];resourceType="accessor";slot;get[Ne](){return new Proxy({[E]:!0,[Xt]:this.#e(),[he]:e=>e.resolve(this),toString:()=>`accessor:${W(this)??"<unnamed>"}.$`},On)}#e(){let e=gr(),t=ua(e.unwrap(this.slot));return lh(t)?t[E].gpuImpl():B(t,this.schema)}$name(e){return this.slot.$name(e),this}toString(){return`accessor:${W(this)??"<unnamed>"}`}get value(){if(kn())return this[Ne];throw new Error("`tgpu.accessor` relies on GPU resources and cannot be accessed outside of a compute dispatch or draw call")}get $(){return this.value}[he](e){let t=this.#e();return B(e.resolve(t.value,t.dataType).value,t.dataType)}};function Pw(e){return Aw(e)}function Uw([e,t]){return`${W(e)??"<unnamed>"}=${t}`}function Aw(e){if(gr())throw new Error("Cannot create tgpu.derived objects at the resolution stage.");return{[E]:!0,resourceType:"derived","~compute":e,get[Ne](){let t=gr();if(!t)throw new Error("Cannot access tgpu.derived's value outside of resolution.");return ua(t.unwrap(this))},get value(){return this[Ne]},get $(){return this.value},with(t,n){return Hh(this,[[t,n]])},toString(){return"derived"}}}function Hh(e,t){return{[E]:!0,resourceType:"derived","~compute"(){throw new Error("'~compute' should never be read on bound derived items.")},[Ar]:{inner:e,pairs:t},get[Ne](){let n=gr();if(!n)throw new Error("Cannot access tgpu.derived's value outside of resolution.");return ua(n.unwrap(this))},get value(){return this[Ne]},get $(){return this.value},with(n,r){return Hh(e,[...t,[n,r]])},toString(){return`derived[${t.map(Uw).join(", ")}]`}}}var Iw={fn:Ve,bindGroupLayout:zh,vertexLayout:Du,slot:Ci,init:Mw,initFromDevice:zw,resolve:ew,resolveWithContext:jh,privateVar:qi,workgroupVar:Vu,const:Na,"~unstable":{fn:Ve,fragmentFn:Hy,vertexFn:xc,computeFn:uh,vertexLayout:Du,namespace:ii,derived:Pw,slot:Ci,accessor:Ew,privateVar:qi,workgroupVar:Vu,const:Na,declare:qy,simulate:tw}},H=Iw;function Qh(e){return vs("function",e,"read-write")}function Bw(e){return vs("private",e,"read-write")}function kw(e){return vs("workgroup",e,"read-write")}function Ow(e,t="read"){return vs("storage",e,t)}function Vw(e){return vs("uniform",e,"read")}function Gw(e){return vs("handle",e,"read")}function vs(e,t,n){return{[E]:!0,type:"ptr",addressSpace:e,inner:t,access:n}}var Kh=ce(((e,t)=>t===void 0?n=>xa(e,n):xa(e,t)),(e,t)=>{if(t===void 0||t.value===void 0){let n=r=>Kh[E].gpuImpl(e,r);return n[E]=!0,B(n,kt)}if(typeof t.value!="number")throw new Error(`Cannot create disarray schema with count unknown at compile-time: '${t.value}'`);return B(xa(e.value,t.value),e.value)},"disarrayOf");function xa(e,t){let n=r=>{if(r&&r.length!==t)throw new Error(`Disarray schema of ${t} elements of type ${e.type} called with ${r.length} argument(s).`);return Array.from({length:t},(s,i)=>kr(e,r?.[i]))};if(Object.setPrototypeOf(n,Dw),n.elementType=e,!Number.isInteger(t)||t<0)throw new Error(`Cannot create disarray schema with invalid element count: ${t}.`);return n.elementCount=t,n}var Dw={[E]:!0,type:"disarray",toString(){return`disarrayOf(${this.elementType}, ${this.elementCount})`}};function Rw(e){let t=n=>Object.fromEntries(Object.entries(e).map(([r,s])=>[r,kr(s,n?.[r])]));return Object.setPrototypeOf(t,Nw),t.propTypes=e,t}var Nw={[E]:!0,type:"unstruct",$name(e){return Fe(this,e),this},toString(){return`unstruct:${W(this)??"<unnamed>"}`}};function is(e,t){if(e===t)return!0;if(e.type!==t.type)return!1;if(vt(e)&&vt(t)||En(e)&&En(t)){let n=e.propTypes,r=t.propTypes,s=Object.keys(n),i=Object.keys(r);if(s.length!==i.length)return!1;for(let p=0;p<s.length;p++){let y=s[p],v=i[p];if(y!==v||!y||!v||!is(n[y],r[v]))return!1}return!0}if(Lt(e)&&Lt(t)||ir(e)&&ir(t))return e.elementCount===t.elementCount&&is(e.elementType,t.elementType);if(Br(e)&&Br(t))return e.addressSpace===t.addressSpace&&e.access===t.access&&is(e.inner,t.inner);if(ki(e)&&ki(t))return is(e.inner,t.inner);if(zn(e)&&zn(t)||Sn(e)&&Sn(t)){if(!is(e.inner,t.inner)||e.attribs.length!==t.attribs.length)return!1;let n=i=>{let p=i;return`${p.type}(${(p.params??[]).join(",")})`},r=e.attribs.map(n),s=t.attribs.map(n);for(let i=0;i<r.length;i++)if(r[i]!==s[i])return!1}return!0}function Lr(e,t){let n=e.prototype,r=qa[t][E].jsImpl;n[t]=function(s){return r(this,s)}}Lr(Rr,"add");Lr(Rr,"sub");Lr(Rr,"mul");Lr(Rr,"div");Lr(gs,"add");Lr(gs,"sub");Lr(gs,"mul");const de=Object.freeze(Object.defineProperty({__proto__:null,Void:at,align:Jd,alignmentOf:jd,arrayOf:Cn,atomic:kc,bool:ke,builtin:Fs,comparisonSampler:Ro,deepEqual:is,disarrayOf:Kh,f16:ut,f32:$,float16:_d,float16x2:$d,float16x4:Md,float32:zd,float32x2:Ed,float32x3:Sd,float32x4:Pd,formatToWGSLType:ar,i32:Ae,interpolate:Hd,invariant:Qd,isAlignAttrib:co,isAtomic:ki,isBuiltin:Nr,isBuiltinAttrib:po,isData:Dr,isDecorated:zn,isDisarray:ir,isInterpolateAttrib:$p,isLocationAttrib:Bl,isLooseData:ms,isLooseDecorated:Sn,isPackedData:dc,isPtr:Br,isSizeAttrib:ho,isUnstruct:En,isWgslArray:Lt,isWgslData:zt,isWgslStruct:vt,location:Ri,mat2x2f:xn,mat3x3f:Bn,mat4x4f:ve,matToArray:zf,packedFormats:Oo,ptrFn:Qh,ptrHandle:Gw,ptrPrivate:Bw,ptrStorage:Ow,ptrUniform:Vw,ptrWorkgroup:kw,sampler:Do,sint16:fd,sint16x2:md,sint16x4:yd,sint32:kd,sint32x2:Od,sint32x3:Vd,sint32x4:Gd,sint8:nd,sint8x2:rd,sint8x4:sd,size:Zd,sizeOf:Xd,snorm16:vd,snorm16x2:bd,snorm16x4:Td,snorm8:ud,snorm8x2:ld,snorm8x4:cd,struct:Wn,texture1d:_c,texture2d:ps,texture2dArray:Mc,texture3d:Sc,textureCube:zc,textureCubeArray:Ec,textureDepth2d:kf,textureDepth2dArray:Vf,textureDepthCube:Gf,textureDepthCubeArray:Df,textureDepthMultisampled2d:Of,textureExternal:Ic,textureMultisampled2d:$c,textureStorage1d:Pc,textureStorage2d:ri,textureStorage2dArray:Uc,textureStorage3d:Ac,u16:Cp,u32:J,uint16:hd,uint16x2:pd,uint16x4:dd,uint32:Ud,uint32x2:Ad,uint32x3:Id,uint32x4:Bd,uint8:Kp,uint8x2:ed,uint8x4:td,unorm10_10_10_2:Dd,unorm16:gd,unorm16x2:wd,unorm16x4:xd,unorm8:id,unorm8x2:ad,unorm8x4:od,unorm8x4_bgra:Rd,unstruct:Rw,vec2b:br,vec2f:G,vec2h:Un,vec2i:Be,vec2u:xt,vec3b:Tr,vec3f:O,vec3h:An,vec3i:Ot,vec3u:rt,vec4b:_r,vec4f:k,vec4h:In,vec4i:Le,vec4u:Ce},Symbol.toStringTag,{value:"Module"}));var Fw=ce(()=>{throw new Error("`discard` relies on GPU resources and cannot be executed outside of a draw call")},()=>B("discard;",at),"discard"),ai=be[E].jsImpl,Lw=ra[E].jsImpl,jw=ra[E].gpuImpl,Yw=sa[E].jsImpl,Cw=sa[E].gpuImpl,qw=ia[E].jsImpl,Ww=ia[E].gpuImpl,Xw=aa[E].jsImpl,Jw=aa[E].gpuImpl,Zw=oa[E].jsImpl,Hw=oa[E].gpuImpl,Qw=ce((e,t)=>ai(Lw(t),e),(e,t)=>B(S`(${jw(t)} * ${e})`,e.dataType),"translate4"),Kw=ce((e,t)=>ai(Yw(t),e),(e,t)=>B(S`(${Cw(t)} * ${e})`,e.dataType),"scale4"),e0=ce((e,t)=>ai(qw(t),e),(e,t)=>B(S`(${Ww(t)} * ${e})`,e.dataType),"rotateX4"),t0=ce((e,t)=>ai(Xw(t),e),(e,t)=>B(S`(${Jw(t)} * ${e})`,e.dataType),"rotateY4"),n0=ce((e,t)=>ai(Zw(t),e),(e,t)=>B(S`(${Hw(t)} * ${e})`,e.dataType),"rotateZ4"),r0=ce(()=>console.warn("workgroupBarrier is a no-op outside of CODEGEN mode."),()=>B("workgroupBarrier()",at),"workgroupBarrier"),s0=ce(()=>console.warn("storageBarrier is a no-op outside of CODEGEN mode."),()=>B("storageBarrier()",at),"storageBarrier"),i0=ce(()=>console.warn("textureBarrier is a no-op outside of CODEGEN mode."),()=>B("textureBarrier()",at),"textureBarrier"),a0=ce(e=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},e=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicLoad(&${e})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicLoad"),o0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(!zt(e.dataType)||e.dataType.type!=="atomic")throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`);return B(S`atomicStore(&${e}, ${t})`,at)},"atomicStore"),jr=(e,t)=>e.dataType.type==="atomic"&&e.dataType.inner.type==="i32"?[e.dataType,Ae]:[e.dataType,J],u0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicAdd(&${e}, ${t})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicAdd",jr),l0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicSub(&${e}, ${t})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicSub",jr),c0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicMax(&${e}, ${t})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicMax",jr),h0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicMin(&${e}, ${t})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicMin",jr),p0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicAnd(&${e}, ${t})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicAnd",jr),d0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicOr(&${e}, ${t})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicOr",jr),f0=ce((e,t)=>{throw new Error("Atomic operations are not supported outside of CODEGEN mode.")},(e,t)=>{if(zt(e.dataType)&&e.dataType.type==="atomic")return B(S`atomicXor(&${e}, ${t})`,e.dataType.inner);throw new Error(`Invalid atomic type: ${Jt(e.dataType)}`)},"atomicXor",jr);function m0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var y0=ce(m0,e=>B(S`dpdx(${e})`,e.dataType),"dpdx");function g0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var w0=ce(g0,e=>B(S`dpdxCoarse(${e})`,e.dataType),"dpdxCoarse");function x0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var v0=ce(x0,e=>B(S`dpdxFine(${e})`,e.dataType),"dpdxFine");function b0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var T0=ce(b0,e=>B(S`dpdy(${e})`,e.dataType),"dpdy");function _0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var $0=ce(_0,e=>B(S`dpdyCoarse(${e})`,e.dataType),"dpdyCoarse");function M0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var z0=ce(M0,e=>B(S`dpdyFine(${e})`,e.dataType),"dpdyFine");function E0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var S0=ce(E0,e=>B(S`fwidth(${e})`,e.dataType),"fwidth");function P0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var U0=ce(P0,e=>B(S`fwidthCoarse(${e})`,e.dataType),"fwidthCoarse");function A0(e){throw new Error("Derivative builtins are not allowed on the cpu")}var I0=ce(A0,e=>B(S`fwidthFine(${e})`,e.dataType),"fwidthFine"),Ru=e=>Br(e)&&Lt(e.inner)?e.inner.elementCount:0,B0=D({name:"arrayLength",signature:e=>{let t=Br(e)?e:Qh(e);return{argTypes:[t],returnType:Ru(t)>0?Zs:J}},normalImpl:e=>e.length,codegenImpl(e){let t=Ru(e.dataType);return t>0?String(t):S`arrayLength(${e})`}});function k0(e,t,n,r,s){throw new Error("Texture sampling relies on GPU resources and cannot be executed outside of a draw call")}var ep=D({name:"textureSample",normalImpl:k0,codegenImpl:(...e)=>S`textureSample(${e})`,signature:(...e)=>{let t=e[0].type.startsWith("texture_depth");return{argTypes:e,returnType:t?$:k}}});function O0(e,t,n,r,s,i){throw new Error("Texture sampling with bias relies on GPU resources and cannot be executed outside of a draw call")}var V0=D({name:"textureSampleBias",normalImpl:O0,codegenImpl:(...e)=>S`textureSampleBias(${e})`,signature:(...e)=>({argTypes:e,returnType:k})});function G0(e,t,n,r,s,i){throw new Error("Texture sampling relies on GPU resources and cannot be executed outside of a draw call")}var D0=D({name:"textureSampleLevel",normalImpl:G0,codegenImpl:(...e)=>S`textureSampleLevel(${e})`,signature:(...e)=>{let t=e[0].type.startsWith("texture_depth");return{argTypes:e,returnType:t?$:k}}});function R0(e,t,n){throw new Error("`textureLoad` relies on GPU resources and cannot be executed outside of a draw call")}var Ii=D({name:"textureLoad",normalImpl:R0,codegenImpl:(...e)=>S`textureLoad(${e})`,signature:(...e)=>{let t=e[0];if(Bc(t)){let s=t.type.startsWith("texture_depth"),i=t.sampleType;return{argTypes:e,returnType:s?$:i.type==="f32"?k:i.type==="u32"?Ce:Le}}let n=t.format,r=xs[n].vectorType;return{argTypes:e,returnType:r}}});function N0(e,t,n,r){throw new Error("`textureStore` relies on GPU resources and cannot be executed outside of a draw call")}var tp=D({name:"textureStore",normalImpl:N0,codegenImpl:(...e)=>S`textureStore(${e})`,signature:(...e)=>({argTypes:e,returnType:at})});function F0(e,t){throw new Error("`textureDimensions` relies on GPU resources and cannot be executed outside of a draw call")}var np=D({name:"textureDimensions",normalImpl:F0,codegenImpl:(...e)=>S`textureDimensions(${e})`,signature:(...e)=>{let t=e[0].dimension;return t==="1d"?{argTypes:e,returnType:J}:t==="3d"?{argTypes:e,returnType:rt}:{argTypes:e,returnType:xt}}});function L0(e,t,n,r,s,i){throw new Error("Texture comparison sampling relies on GPU resources and cannot be executed outside of a draw call")}var j0=D({name:"textureSampleCompare",normalImpl:L0,codegenImpl:(...e)=>S`textureSampleCompare(${e})`,signature:(...e)=>({argTypes:e,returnType:$})});function Y0(e,t,n){throw new Error("Texture sampling with base clamp to edge is not supported outside of GPU mode.")}var C0=D({name:"textureSampleBaseClampToEdge",normalImpl:Y0,codegenImpl:(...e)=>S`textureSampleBaseClampToEdge(${e})`,signature:(...e)=>({argTypes:e,returnType:k})}),lt="Subgroup operations can only be used in the GPU context.",q0=D({name:"subgroupAdd",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupAdd(${e})`}),W0=D({name:"subgroupExclusiveAdd",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupExclusiveAdd(${e})`}),X0=D({name:"subgroupInclusiveAdd",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupInclusiveAdd(${e})`}),J0=D({name:"subgroupAll",signature:{argTypes:[ke],returnType:ke},normalImpl:lt,codegenImpl:e=>S`subgroupAll(${e})`}),Z0=D({name:"subgroupAnd",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupAnd(${e})`}),H0=D({name:"subgroupAny",signature:{argTypes:[ke],returnType:ke},normalImpl:lt,codegenImpl:e=>S`subgroupAny(${e})`}),Q0=D({name:"subgroupBallot",signature:{argTypes:[ke],returnType:Ce},normalImpl:lt,codegenImpl:e=>S`subgroupBallot(${e})`}),K0=D({name:"subgroupBroadcast",signature:(...e)=>{let t=ct([e[1]],[Ae,J]);if(!t)throw new Error(`subgroupBroadcast's second argument has to be compatible with i32 or u32. Got: ${e[1].type}`);return{argTypes:[e[0],t[0]],returnType:e[0]}},normalImpl:lt,codegenImpl:(e,t)=>S`subgroupBroadcast(${e}, ${t})`}),ex=D({name:"subgroupBroadcastFirst",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupBroadcastFirst(${e})`}),tx=D({name:"subgroupElect",signature:{argTypes:[],returnType:ke},normalImpl:lt,codegenImpl:()=>S`subgroupElect()`}),nx=D({name:"subgroupMax",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupMax(${e})`}),rx=D({name:"subgroupMin",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupMin(${e})`}),sx=D({name:"subgroupMul",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupMul(${e})`}),ix=D({name:"subgroupExclusiveMul",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupExclusiveMul(${e})`}),ax=D({name:"subgroupInclusiveMul",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupInclusiveMul(${e})`}),ox=D({name:"subgroupOr",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupOr(${e})`}),ux=D({name:"subgroupShuffle",signature:(...e)=>{let t=ct([e[1]],[Ae,J]);if(!t)throw new Error(`subgroupShuffle's second argument has to be compatible with i32 or u32. Got: ${e[1].type}`);return{argTypes:[e[0],t[0]],returnType:e[0]}},normalImpl:lt,codegenImpl:(e,t)=>S`subgroupShuffle(${e}, ${t})`}),lx=D({name:"subgroupShuffleDown",signature:(...e)=>{let t=ct([e[1]],[J]);if(!t)throw new Error(`subgroupShuffleDown's second argument has to be compatible with u32. Got: ${e[1].type}`);return{argTypes:[e[0],t[0]],returnType:e[0]}},normalImpl:lt,codegenImpl:(e,t)=>S`subgroupShuffleDown(${e}, ${t})`}),cx=D({name:"subgroupShuffleUp",signature:(...e)=>{let t=ct([e[1]],[J]);if(!t)throw new Error(`subgroupShuffleUp's second argument has to be compatible with u32. Got: ${e[1].type}`);return{argTypes:[e[0],t[0]],returnType:e[0]}},normalImpl:lt,codegenImpl:(e,t)=>S`subgroupShuffleUp(${e}, ${t})`}),hx=D({name:"subgroupShuffleXor",signature:(...e)=>{let t=ct([e[1]],[J]);if(!t)throw new Error(`subgroupShuffleXor's second argument has to be compatible with u32. Got: ${e[1].type}`);return{argTypes:[e[0],t[0]],returnType:e[0]}},normalImpl:lt,codegenImpl:(e,t)=>S`subgroupShuffleXor(${e}, ${t})`}),px=D({name:"subgroupXor",signature:e=>({argTypes:[e],returnType:e}),normalImpl:lt,codegenImpl:e=>S`subgroupXor(${e})`}),dx=(()=>{let e=r=>{let s=gr();if(!s)throw new Error("extensionEnabled can only be called in a GPU codegen context.");return(s.enableExtensions??[]).includes(r)},t=r=>{let{value:s}=r;if(typeof s!="string"||!Co.includes(s))throw new Error(`extensionEnabled has to be called with a string literal representing a valid WGSL extension name. Got: ${s}`);return B(e(s),ke)},n=r=>{if(kn())return t(r);throw new Error("extensionEnabled can only be called in a GPU codegen context.")};return Object.defineProperty(n,E,{value:{jsImpl:e,gpuImpl:t,argConversionHint:"keep"}}),n})();const De=Object.freeze(Object.defineProperty({__proto__:null,abs:Je,acos:ja,acosh:nm,add:ue,all:Ly,allEq:sh,and:Fy,any:jy,arrayLength:B0,asin:sm,asinh:am,atan:um,atan2:pm,atanh:cm,atomicAdd:u0,atomicAnd:p0,atomicLoad:a0,atomicMax:c0,atomicMin:h0,atomicOr:d0,atomicStore:o0,atomicSub:l0,atomicXor:f0,bitcastU32toF32:th,bitcastU32toI32:nh,ceil:Gc,clamp:Or,cos:Ft,cosh:gm,countLeadingZeros:wm,countOneBits:xm,countTrailingZeros:vm,cross:Dc,degrees:Tm,determinant:_m,discard:Fw,distance:Mm,div:No,dot:ae,dot4I8Packed:Em,dot4U8Packed:zm,dpdx:y0,dpdxCoarse:w0,dpdxFine:v0,dpdy:T0,dpdyCoarse:$0,dpdyFine:z0,eq:By,exp:Rc,exp2:Um,extensionEnabled:dx,extractBits:Am,faceForward:Im,firstLeadingBit:Bm,firstTrailingBit:km,floor:Vr,fma:Gm,fract:tr,frexp:Nm,fwidth:S0,fwidthCoarse:U0,fwidthFine:I0,ge:Dy,gt:Gy,identity2:vc,identity3:bc,identity4:Tc,insertBits:Fm,inverseSqrt:jm,isCloseTo:Yy,ldexp:Ym,le:Vy,length:Te,log:Ys,log2:Xm,lt:Oy,max:re,min:pe,mix:rn,mod:Hf,modf:Km,mul:be,ne:ky,neg:js,normalize:an,not:Ry,or:Ny,pack2x16float:Uy,pack4x8unorm:Iy,pow:wr,quantizeToF16:t1,radians:r1,reflect:Nc,refract:s1,reverseBits:i1,rotateX4:e0,rotateY4:t0,rotateZ4:n0,rotationX4:ia,rotationY4:aa,rotationZ4:oa,round:o1,saturate:jt,scale4:Kw,scaling4:sa,select:Cs,sign:or,sin:un,sinh:p1,smoothstep:Fc,sqrt:gn,step:Ya,storageBarrier:s0,sub:K,subgroupAdd:q0,subgroupAll:J0,subgroupAnd:Z0,subgroupAny:H0,subgroupBallot:Q0,subgroupBroadcast:K0,subgroupBroadcastFirst:ex,subgroupElect:tx,subgroupExclusiveAdd:W0,subgroupExclusiveMul:ix,subgroupInclusiveAdd:X0,subgroupInclusiveMul:ax,subgroupMax:nx,subgroupMin:rx,subgroupMul:sx,subgroupOr:ox,subgroupShuffle:ux,subgroupShuffleDown:lx,subgroupShuffleUp:cx,subgroupShuffleXor:hx,subgroupXor:px,tan:Ca,tanh:Lc,textureBarrier:i0,textureDimensions:np,textureLoad:Ii,textureSample:ep,textureSampleBaseClampToEdge:C0,textureSampleBias:V0,textureSampleCompare:j0,textureSampleLevel:D0,textureStore:tp,translate4:Qw,translation4:ra,transpose:w1,trunc:x1,unpack2x16float:rh,unpack4x8unorm:Ay,workgroupBarrier:r0},Symbol.toStringTag,{value:"Module"})),fx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$,$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=re(r-Je(t-n),0)/r;return pe(t,n)-s*s*r*(1/4)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"d1"},{type:"i",name:"d2"},{type:"i",name:"k"}],body:[0,[[13,"h",[1,[6,[7,"std","max"],[[1,"k","-",[6,[7,"std","abs"],[[1,"d1","-","d2"]]]],[5,"0"]]],"/","k"]],[10,[1,[6,[7,"std","min"],["d1","d2"]],"-",[1,[1,[1,"h","*","h"],"*","k"],"*",[1,[5,"1"],"/",[5,"4"]]]]]]],externalNames:["std"]},get externals(){return{std:De}}})&&e.f)({})),"opSmoothUnion"),mx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$,$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=re(r-Je(-t-n),0)/r;return re(-n,t)+s*s*r*(1/4)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"d1"},{type:"i",name:"d2"},{type:"i",name:"k"}],body:[0,[[13,"h",[1,[6,[7,"std","max"],[[1,"k","-",[6,[7,"std","abs"],[[1,[4,"-","d1"],"-","d2"]]]],[5,"0"]]],"/","k"]],[10,[1,[6,[7,"std","max"],[[4,"-","d2"],"d1"]],"+",[1,[1,[1,"h","*","h"],"*","k"],"*",[1,[5,"1"],"/",[5,"4"]]]]]]],externalNames:["std"]},get externals(){return{std:De}}})&&e.f)({})),"opSmoothDifference"),yx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=G(n,Je(t.z)-r);return pe(re(s.x,s.y),0)+Te(re(s,G()))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"dd"},{type:"i",name:"h"}],body:[0,[[13,"w",[6,[7,"d","vec2f"],["dd",[1,[6,[7,"std","abs"],[[7,"p","z"]]],"-","h"]]]],[10,[1,[6,[7,"std","min"],[[6,[7,"std","max"],[[7,"w","x"],[7,"w","y"]]],[5,"0"]]],"+",[6,[7,"std","length"],[[6,[7,"std","max"],["w",[6,[7,"d","vec2f"],[]]]]]]]]]],externalNames:["d","std"]},get externals(){return{d:de,std:De}}})&&e.f)({})),"opExtrudeZ"),gx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=G(n,Je(t.x)-r);return pe(re(s.x,s.y),0)+Te(re(s,G()))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"dd"},{type:"i",name:"h"}],body:[0,[[13,"w",[6,[7,"d","vec2f"],["dd",[1,[6,[7,"std","abs"],[[7,"p","x"]]],"-","h"]]]],[10,[1,[6,[7,"std","min"],[[6,[7,"std","max"],[[7,"w","x"],[7,"w","y"]]],[5,"0"]]],"+",[6,[7,"std","length"],[[6,[7,"std","max"],["w",[6,[7,"d","vec2f"],[]]]]]]]]]],externalNames:["d","std"]},get externals(){return{d:de,std:De}}})&&e.f)({})),"opExtrudeX"),rp=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=G(n,Je(t.y)-r);return pe(re(s.x,s.y),0)+Te(re(s,G()))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"dd"},{type:"i",name:"h"}],body:[0,[[13,"w",[6,[7,"d","vec2f"],["dd",[1,[6,[7,"std","abs"],[[7,"p","y"]]],"-","h"]]]],[10,[1,[6,[7,"std","min"],[[6,[7,"std","max"],[[7,"w","x"],[7,"w","y"]]],[5,"0"]]],"+",[6,[7,"std","length"],[[6,[7,"std","max"],["w",[6,[7,"d","vec2f"],[]]]]]]]]]],externalNames:["d","std"]},get externals(){return{d:de,std:De}}})&&e.f)({})),"opExtrudeY"),sp=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>pe(t,n)),{v:1,name:void 0,ast:{params:[{type:"i",name:"d1"},{type:"i",name:"d2"}],body:[0,[[10,[6,[7,"std","min"],["d1","d2"]]]]],externalNames:["std"]},get externals(){return{std:De}}})&&e.f)({})),"opUnion"),wx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>Te(t)-n),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"radius"}],body:[0,[[10,[1,[6,"length",["p"]],"-","radius"]]]],externalNames:["length"]},get externals(){return{length:Te}}})&&e.f)({})),"sdDisk"),xx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G,G],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{const r=K(Je(t),n);return Te(re(r,G(0)))+pe(re(r.x,r.y),0)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"size"}],body:[0,[[13,"d",[6,"sub",[[6,"abs",["p"]],"size"]]],[10,[1,[6,"length",[[6,"max",["d",[6,"vec2f",[[5,"0"]]]]]]],"+",[6,"min",[[6,"max",[[7,"d","x"],[7,"d","y"]]],[5,"0"]]]]]]],externalNames:["sub","abs","length","max","vec2f","min"]},get externals(){return{sub:K,abs:Je,length:Te,max:re,vec2f:G,min:pe}}})&&e.f)({})),"sdBox2d"),vx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G,G,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=ue(K(Je(t),n),G(r));return Te(re(s,G(0)))+pe(re(s.x,s.y),0)-r}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"size"},{type:"i",name:"cornerRadius"}],body:[0,[[13,"d",[6,"add",[[6,"sub",[[6,"abs",["p"]],"size"]],[6,"vec2f",["cornerRadius"]]]]],[10,[1,[1,[6,"length",[[6,"max",["d",[6,"vec2f",[[5,"0"]]]]]]],"+",[6,"min",[[6,"max",[[7,"d","x"],[7,"d","y"]]],[5,"0"]]]],"-","cornerRadius"]]]],externalNames:["add","sub","abs","vec2f","length","max","min"]},get externals(){return{add:ue,sub:K,abs:Je,vec2f:G,length:Te,max:re,min:pe}}})&&e.f)({})),"sdRoundedBox2d"),bx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G,G,G],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=K(t,n),i=K(r,n),p=re(0,pe(1,ae(s,i)/ae(i,i)));return Te(K(s,i.mul(p)))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"a"},{type:"i",name:"b"}],body:[0,[[13,"pa",[6,"sub",["p","a"]]],[13,"ba",[6,"sub",["b","a"]]],[13,"h",[6,"max",[[5,"0"],[6,"min",[[5,"1"],[1,[6,"dot",["pa","ba"]],"/",[6,"dot",["ba","ba"]]]]]]]],[10,[6,"length",[[6,"sub",["pa",[6,[7,"ba","mul"],["h"]]]]]]]]],externalNames:["sub","max","min","dot","length"]},get externals(){return{sub:K,max:re,min:pe,dot:ae,length:Te}}})&&e.f)({})),"sdLine"),ls=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>{"use gpu";return ae(n,n)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"v"}],body:[0,[[10,[6,"dot",["v","v"]]]]],externalNames:["dot"]},get externals(){return{dot:ae}}})&&t.f)({}),{v:1,name:"dot2",ast:{params:[{type:"i",name:"v"}],body:[0,[[10,[6,"dot",["v","v"]]]]],externalNames:["dot"]},get externals(){return{dot:ae}}})&&e.f)({}),Tx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G,G,G,G],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r,s)=>{const i=r.sub(n),p=n.sub(r.mul(2)).add(s),y=i.mul($(2)),v=n.sub(t),P=1/re(ae(p,p),1e-4),U=P*ae(i,p),N=P*($(2)*ae(i,i)+ae(v,p))/3,j=P*ae(v,i);let L=$(0);const Z=N-U*U,Q=Z*Z*Z,se=U*(2*U*U-3*N)+j;let ze=se*se+4*Q;if(ze>=0){ze=gn(ze);const oe=G(ze,-ze).sub(se).mul(.5),_e=or(oe).mul(wr(Je(oe),G(1/3))),Ee=Or(_e.x+_e.y-U,0,1);L=ls(v.add(y.add(p.mul(Ee)).mul(Ee)))}else{const oe=gn(-Z),_e=ja(se/(Z*oe*2))/3,Ee=Ft(_e),Pe=be(un(_e),1.732050808),Ue=jt(O(Ee+Ee,-Pe-Ee,Pe-Ee).mul(oe).sub(U));L=pe(ls(v.add(y.add(p.mul(Ue.x)).mul(Ue.x))),ls(v.add(y.add(p.mul(Ue.y)).mul(Ue.y))))}return gn(L)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"},{type:"i",name:"A"},{type:"i",name:"B"},{type:"i",name:"C"}],body:[0,[[13,"a",[6,[7,"B","sub"],["A"]]],[13,"b",[6,[7,[6,[7,"A","sub"],[[6,[7,"B","mul"],[[5,"2"]]]]],"add"],["C"]]],[13,"c",[6,[7,"a","mul"],[[6,"f32",[[5,"2"]]]]]],[13,"d",[6,[7,"A","sub"],["pos"]]],[13,"dotB",[6,"max",[[6,"dot",["b","b"]],[5,"0.0001"]]]],[13,"kk",[1,[5,"1"],"/","dotB"]],[13,"kx",[1,"kk","*",[6,"dot",["a","b"]]]],[13,"ky",[1,[1,"kk","*",[1,[1,[6,"f32",[[5,"2"]]],"*",[6,"dot",["a","a"]]],"+",[6,"dot",["d","b"]]]],"/",[5,"3"]]],[13,"kz",[1,"kk","*",[6,"dot",["d","a"]]]],[12,"res",[6,"f32",[[5,"0"]]]],[13,"p",[1,"ky","-",[1,"kx","*","kx"]]],[13,"p3",[1,[1,"p","*","p"],"*","p"]],[13,"q",[1,[1,"kx","*",[1,[1,[1,[5,"2"],"*","kx"],"*","kx"],"-",[1,[5,"3"],"*","ky"]]],"+","kz"]],[12,"h",[1,[1,"q","*","q"],"+",[1,[5,"4"],"*","p3"]]],[11,[1,"h",">=",[5,"0"]],[0,[[2,"h","=",[6,"sqrt",["h"]]],[13,"x",[6,[7,[6,[7,[6,"vec2f",["h",[4,"-","h"]]],"sub"],["q"]],"mul"],[[5,"0.5"]]]],[13,"uv",[6,[7,[6,"sign",["x"]],"mul"],[[6,"pow",[[6,"abs",["x"]],[6,"vec2f",[[1,[5,"1"],"/",[5,"3"]]]]]]]]],[13,"t",[6,"clamp",[[1,[1,[7,"uv","x"],"+",[7,"uv","y"]],"-","kx"],[5,"0"],[5,"1"]]]],[2,"res","=",[6,"dot2",[[6,[7,"d","add"],[[6,[7,[6,[7,"c","add"],[[6,[7,"b","mul"],["t"]]]],"mul"],["t"]]]]]]]]],[0,[[13,"z",[6,"sqrt",[[4,"-","p"]]]],[13,"v",[1,[6,"acos",[[1,"q","/",[1,[1,"p","*","z"],"*",[5,"2"]]]]],"/",[5,"3"]]],[13,"m",[6,"cos",["v"]]],[13,"n",[6,"mul",[[6,"sin",["v"]],[5,"1.732050808"]]]],[13,"t",[6,"saturate",[[6,[7,[6,[7,[6,"vec3f",[[1,"m","+","m"],[1,[4,"-","n"],"-","m"],[1,"n","-","m"]]],"mul"],["z"]],"sub"],["kx"]]]]],[2,"res","=",[6,"min",[[6,"dot2",[[6,[7,"d","add"],[[6,[7,[6,[7,"c","add"],[[6,[7,"b","mul"],[[7,"t","x"]]]]],"mul"],[[7,"t","x"]]]]]]],[6,"dot2",[[6,[7,"d","add"],[[6,[7,[6,[7,"c","add"],[[6,[7,"b","mul"],[[7,"t","y"]]]]],"mul"],[[7,"t","y"]]]]]]]]]]]]],[10,[6,"sqrt",["res"]]]]],externalNames:["f32","max","dot","sqrt","vec2f","sign","pow","abs","clamp","dot2","acos","cos","mul","sin","saturate","vec3f","min"]},get externals(){return{f32:$,max:re,dot:ae,sqrt:gn,vec2f:G,sign:or,pow:wr,abs:Je,clamp:Or,dot2:ls,acos:ja,cos:Ft,mul:be,sin:un,saturate:jt,vec3f:O,min:pe}}})&&e.f)({})),"sdBezier"),Ti=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=((n,r)=>{"use gpu";return n.x*r.y-n.y*r.x}),{v:1,name:void 0,ast:{params:[{type:"i",name:"a"},{type:"i",name:"b"}],body:[0,[[10,[1,[1,[7,"a","x"],"*",[7,"b","y"]],"-",[1,[7,"a","y"],"*",[7,"b","x"]]]]]],externalNames:[]},get externals(){return{}}})&&t.f)({}),{v:1,name:"cro",ast:{params:[{type:"i",name:"a"},{type:"i",name:"b"}],body:[0,[[10,[1,[1,[7,"a","x"],"*",[7,"b","y"]],"-",[1,[7,"a","y"],"*",[7,"b","x"]]]]]],externalNames:[]},get externals(){return{}}})&&e.f)({}),_x=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G,G,G,G],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r,s)=>{const i=n.sub(s),p=s.sub(r),y=r.sub(n),v=p.sub(y),_=n.sub(t),P=r.sub(t),U=s.sub(t),N=Ti(_,U),j=Ti(P,_),L=Ti(U,P),Z=p.mul(j).add(y.mul(L)).mul(2).sub(i.mul(N)),Q=(j*L-N*N*.25)/ls(Z),se=jt((.5*N+j+Q*ae(Z,v))/(N+j+L)),ze=_.add(y.add(y).add(v.mul(se)).mul(se));return Te(ze)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"},{type:"i",name:"A"},{type:"i",name:"B"},{type:"i",name:"C"}],body:[0,[[13,"i",[6,[7,"A","sub"],["C"]]],[13,"j",[6,[7,"C","sub"],["B"]]],[13,"k",[6,[7,"B","sub"],["A"]]],[13,"w",[6,[7,"j","sub"],["k"]]],[13,"v0",[6,[7,"A","sub"],["pos"]]],[13,"v1",[6,[7,"B","sub"],["pos"]]],[13,"v2",[6,[7,"C","sub"],["pos"]]],[13,"x",[6,"cro",["v0","v2"]]],[13,"y",[6,"cro",["v1","v0"]]],[13,"z",[6,"cro",["v2","v1"]]],[13,"s",[6,[7,[6,[7,[6,[7,[6,[7,"j","mul"],["y"]],"add"],[[6,[7,"k","mul"],["z"]]]],"mul"],[[5,"2"]]],"sub"],[[6,[7,"i","mul"],["x"]]]]],[13,"r",[1,[1,[1,"y","*","z"],"-",[1,[1,"x","*","x"],"*",[5,"0.25"]]],"/",[6,"dot2",["s"]]]],[13,"t",[6,"saturate",[[1,[1,[1,[1,[5,"0.5"],"*","x"],"+","y"],"+",[1,"r","*",[6,"dot",["s","w"]]]],"/",[1,[1,"x","+","y"],"+","z"]]]]],[13,"d",[6,[7,"v0","add"],[[6,[7,[6,[7,[6,[7,"k","add"],["k"]],"add"],[[6,[7,"w","mul"],["t"]]]],"mul"],["t"]]]]],[10,[6,"length",["d"]]]]],externalNames:["cro","dot2","saturate","dot","length"]},get externals(){return{cro:Ti,dot2:ls,saturate:jt,dot:ae,length:Te}}})&&e.f)({})),"sdBezierApprox"),$x=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G,G,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=t;s.x=Je(t.x);const i=Te(s)-r,p=Te(s.sub(n.mul(Or(ae(s,n),0,r))));return re(i,p*or(n.y*s.x-n.x*s.y))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"c"},{type:"i",name:"r"}],body:[0,[[13,"p_w","p"],[2,[7,"p_w","x"],"=",[6,"abs",[[7,"p","x"]]]],[13,"l",[1,[6,"length",["p_w"]],"-","r"]],[13,"m",[6,"length",[[6,[7,"p_w","sub"],[[6,[7,"c","mul"],[[6,"clamp",[[6,"dot",["p_w","c"]],[5,"0"],"r"]]]]]]]]],[10,[6,"max",["l",[1,"m","*",[6,"sign",[[1,[1,[7,"c","y"],"*",[7,"p_w","x"]],"-",[1,[7,"c","x"],"*",[7,"p_w","y"]]]]]]]]]]],externalNames:["abs","length","clamp","dot","max","sign"]},get externals(){return{abs:Je,length:Te,clamp:Or,dot:ae,max:re,sign:or}}})&&e.f)({})),"sdPie"),Mx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>Te(t)-n),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"radius"}],body:[0,[[10,[1,[6,"length",["p"]],"-","radius"]]]],externalNames:["length"]},get externals(){return{length:Te}}})&&e.f)({})),"sdSphere"),zx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,O],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{const r=K(Je(t),n);return Te(re(r,O(0)))+pe(re(re(r.x,r.y),r.z),0)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"size"}],body:[0,[[13,"d",[6,"sub",[[6,"abs",["p"]],"size"]]],[10,[1,[6,"length",[[6,"max",["d",[6,"vec3f",[[5,"0"]]]]]]],"+",[6,"min",[[6,"max",[[6,"max",[[7,"d","x"],[7,"d","y"]]],[7,"d","z"]]],[5,"0"]]]]]]],externalNames:["sub","abs","length","max","vec3f","min"]},get externals(){return{sub:K,abs:Je,length:Te,max:re,vec3f:O,min:pe}}})&&e.f)({})),"sdBox3d"),ip=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,O,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=ue(K(Je(t),n),O(r));return Te(re(s,O(0)))+pe(re(re(s.x,s.y),s.z),0)-r}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"size"},{type:"i",name:"cornerRadius"}],body:[0,[[13,"d",[6,"add",[[6,"sub",[[6,"abs",["p"]],"size"]],[6,"vec3f",["cornerRadius"]]]]],[10,[1,[1,[6,"length",[[6,"max",["d",[6,"vec3f",[[5,"0"]]]]]]],"+",[6,"min",[[6,"max",[[6,"max",[[7,"d","x"],[7,"d","y"]]],[7,"d","z"]]],[5,"0"]]]],"-","cornerRadius"]]]],externalNames:["add","sub","abs","vec3f","length","max","min"]},get externals(){return{add:ue,sub:K,abs:Je,vec3f:O,length:Te,max:re,min:pe}}})&&e.f)({})),"sdRoundedBox3d"),Ex=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,O,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=K(Je(t),n),i=K(Je(ue(s,r)),O(r)),p=Te(re(O(s.x,i.y,i.z),O(0)))+pe(re(s.x,re(i.y,i.z)),0),y=Te(re(O(i.x,s.y,i.z),O(0)))+pe(re(i.x,re(s.y,i.z)),0),v=Te(re(O(i.x,i.y,s.z),O(0)))+pe(re(i.x,re(i.y,s.z)),0);return pe(pe(p,y),v)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"size"},{type:"i",name:"thickness"}],body:[0,[[13,"p1",[6,"sub",[[6,"abs",["p"]],"size"]]],[13,"q",[6,"sub",[[6,"abs",[[6,"add",["p1","thickness"]]]],[6,"vec3f",["thickness"]]]]],[13,"d1",[1,[6,"length",[[6,"max",[[6,"vec3f",[[7,"p1","x"],[7,"q","y"],[7,"q","z"]]],[6,"vec3f",[[5,"0"]]]]]]],"+",[6,"min",[[6,"max",[[7,"p1","x"],[6,"max",[[7,"q","y"],[7,"q","z"]]]]],[5,"0"]]]]],[13,"d2",[1,[6,"length",[[6,"max",[[6,"vec3f",[[7,"q","x"],[7,"p1","y"],[7,"q","z"]]],[6,"vec3f",[[5,"0"]]]]]]],"+",[6,"min",[[6,"max",[[7,"q","x"],[6,"max",[[7,"p1","y"],[7,"q","z"]]]]],[5,"0"]]]]],[13,"d3",[1,[6,"length",[[6,"max",[[6,"vec3f",[[7,"q","x"],[7,"q","y"],[7,"p1","z"]]],[6,"vec3f",[[5,"0"]]]]]]],"+",[6,"min",[[6,"max",[[7,"q","x"],[6,"max",[[7,"q","y"],[7,"p1","z"]]]]],[5,"0"]]]]],[10,[6,"min",[[6,"min",["d1","d2"]],"d3"]]]]],externalNames:["sub","abs","add","vec3f","length","max","min"]},get externals(){return{sub:K,abs:Je,add:ue,vec3f:O,length:Te,max:re,min:pe}}})&&e.f)({})),"sdBoxFrame3d"),Sx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,O,O],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{const s=K(t,n),i=K(r,n),p=re(0,pe(1,ae(s,i)/ae(i,i)));return Te(K(s,i.mul(p)))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"a"},{type:"i",name:"b"}],body:[0,[[13,"pa",[6,"sub",["p","a"]]],[13,"ba",[6,"sub",["b","a"]]],[13,"h",[6,"max",[[5,"0"],[6,"min",[[5,"1"],[1,[6,"dot",["pa","ba"]],"/",[6,"dot",["ba","ba"]]]]]]]],[10,[6,"length",[[6,"sub",["pa",[6,[7,"ba","mul"],["h"]]]]]]]]],externalNames:["sub","max","min","dot","length"]},get externals(){return{sub:K,max:re,min:pe,dot:ae,length:Te}}})&&e.f)({})),"sdLine3d"),ap=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,O,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>ae(t,n)+r),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"n"},{type:"i",name:"h"}],body:[0,[[10,[1,[6,"dot",["p","n"]],"+","h"]]]],externalNames:["dot"]},get externals(){return{dot:ae}}})&&e.f)({})),"sdPlane"),Px=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,O,O,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r,s)=>{const i=K(t,n),p=K(r,n),y=jt(ae(i,p)/ae(p,p));return Te(K(i,p.mul(y)))-s}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"},{type:"i",name:"a"},{type:"i",name:"b"},{type:"i",name:"radius"}],body:[0,[[13,"pa",[6,"sub",["p","a"]]],[13,"ba",[6,"sub",["b","a"]]],[13,"h",[6,"saturate",[[1,[6,"dot",["pa","ba"]],"/",[6,"dot",["ba","ba"]]]]]],[10,[1,[6,"length",[[6,"sub",["pa",[6,[7,"ba","mul"],["h"]]]]]],"-","radius"]]]],externalNames:["sub","saturate","dot","length"]},get externals(){return{sub:K,saturate:jt,dot:ae,length:Te}}})&&e.f)({})),"sdCapsule"),op=Object.freeze(Object.defineProperty({__proto__:null,opExtrudeX:gx,opExtrudeY:rp,opExtrudeZ:yx,opSmoothDifference:mx,opSmoothUnion:fx,opUnion:sp,sdBezier:Tx,sdBezierApprox:_x,sdBox2d:xx,sdBox3d:zx,sdBoxFrame3d:Ex,sdCapsule:Px,sdDisk:wx,sdLine:bx,sdLine3d:Sx,sdPie:$x,sdPlane:ap,sdRoundedBox2d:vx,sdRoundedBox3d:ip,sdSphere:Mx},Symbol.toStringTag,{value:"Module"}));var up=xc({in:{vertexIndex:Fs.vertexIndex},out:{pos:Fs.position,uv:G}})`{
  const pos = array<vec2f, 3>(vec2f(-1, -1), vec2f(3, -1), vec2f(-1, 3));
  const uv = array<vec2f, 3>(vec2f(0, 1), vec2f(2, 1), vec2f(0, -1));

  return Out(vec4f(pos[in.vertexIndex], 0, 1), uv[in.vertexIndex]);
}`;const Ux=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],$),"randomGeneratorShell"),Ax=(()=>{const e=(globalThis.__TYPEGPU_AUTONAME__??(t=>t))(H.privateVar(G),"seed");return{seed:(globalThis.__TYPEGPU_AUTONAME__??(t=>t))(H.fn([$])((t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>{e.value=G(n,0)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"value"}],body:[0,[[2,[7,"seed","value"],"=",[6,[7,"d","vec2f"],["value",[5,"0"]]]]]],externalNames:["seed","d"]},get externals(){return{seed:e,d:de}}})&&t.f)({})),"seed"),seed2:(globalThis.__TYPEGPU_AUTONAME__??(t=>t))(H.fn([G])((t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>{e.value=n}),{v:1,name:void 0,ast:{params:[{type:"i",name:"value"}],body:[0,[[2,[7,"seed","value"],"=","value"]]],externalNames:["seed"]},get externals(){return{seed:e}}})&&t.f)({})),"seed2"),seed3:(globalThis.__TYPEGPU_AUTONAME__??(t=>t))(H.fn([O])((t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>{e.value=ue(n.xy,G(n.z))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"value"}],body:[0,[[2,[7,"seed","value"],"=",[6,"add",[[7,"value","xy"],[6,[7,"d","vec2f"],[[7,"value","z"]]]]]]]],externalNames:["seed","add","d"]},get externals(){return{seed:e,add:ue,d:de}}})&&t.f)({})),"seed3"),seed4:(globalThis.__TYPEGPU_AUTONAME__??(t=>t))(H.fn([k])((t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>{e.value=ue(n.xy,n.zw)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"value"}],body:[0,[[2,[7,"seed","value"],"=",[6,"add",[[7,"value","xy"],[7,"value","zw"]]]]]],externalNames:["seed","add"]},get externals(){return{seed:e,add:ue}}})&&t.f)({})),"seed4"),sample:Ux((t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(n.f=(()=>{"use gpu";const r=ae(e.value,G(23.14077926,232.61690225)),s=ae(e.value,G(54.47856553,345.84153136));return e.value.x=tr(Ft(r)*136.8168),e.value.y=tr(Ft(s)*534.7645),e.value.y}),{v:1,name:void 0,ast:{params:[],body:[0,[[13,"a",[6,"dot",[[7,"seed","value"],[6,[7,"d","vec2f"],[[5,"23.14077926"],[5,"232.61690225"]]]]]],[13,"b",[6,"dot",[[7,"seed","value"],[6,[7,"d","vec2f"],[[5,"54.47856553"],[5,"345.84153136"]]]]]],[2,[7,[7,"seed","value"],"x"],"=",[6,"fract",[[1,[6,"cos",["a"]],"*",[5,"136.8168"]]]]],[2,[7,[7,"seed","value"],"y"],"=",[6,"fract",[[1,[6,"cos",["b"]],"*",[5,"534.7645"]]]]],[10,[7,[7,"seed","value"],"y"]]]],externalNames:["dot","seed","d","fract","cos"]},get externals(){return{dot:ae,seed:e,d:de,fract:tr,cos:Ft}}})&&n.f)({}),{v:1,name:void 0,ast:{params:[],body:[0,[[13,"a",[6,"dot",[[7,"seed","value"],[6,[7,"d","vec2f"],[[5,"23.14077926"],[5,"232.61690225"]]]]]],[13,"b",[6,"dot",[[7,"seed","value"],[6,[7,"d","vec2f"],[[5,"54.47856553"],[5,"345.84153136"]]]]]],[2,[7,[7,"seed","value"],"x"],"=",[6,"fract",[[1,[6,"cos",["a"]],"*",[5,"136.8168"]]]]],[2,[7,[7,"seed","value"],"y"],"=",[6,"fract",[[1,[6,"cos",["b"]],"*",[5,"534.7645"]]]]],[10,[7,[7,"seed","value"],"y"]]]],externalNames:["dot","seed","d","fract","cos"]},get externals(){return{dot:ae,seed:e,d:de,fract:tr,cos:Ft}}})&&t.f)({}))}})(),Ix=Ax,Oe=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.slot(Ix),"randomGeneratorSlot"),xr=Math.PI*2,Ds=1e-7,Bx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$])((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{Oe.value.seed(t)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"seed"}],body:[0,[[6,[7,[7,"randomGeneratorSlot","value"],"seed"],["seed"]]]],externalNames:["randomGeneratorSlot"]},get externals(){return{randomGeneratorSlot:Oe}}})&&e.f)({})),"randSeed"),no=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G])((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{Oe.value.seed2(t)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"seed"}],body:[0,[[6,[7,[7,"randomGeneratorSlot","value"],"seed2"],["seed"]]]],externalNames:["randomGeneratorSlot"]},get externals(){return{randomGeneratorSlot:Oe}}})&&e.f)({})),"randSeed2"),ro=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O])((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{Oe.value.seed3(t)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"seed"}],body:[0,[[6,[7,[7,"randomGeneratorSlot","value"],"seed3"],["seed"]]]],externalNames:["randomGeneratorSlot"]},get externals(){return{randomGeneratorSlot:Oe}}})&&e.f)({})),"randSeed3"),kx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([k])((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{Oe.value.seed4(t)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"seed"}],body:[0,[[6,[7,[7,"randomGeneratorSlot","value"],"seed4"],["seed"]]]],externalNames:["randomGeneratorSlot"]},get externals(){return{randomGeneratorSlot:Oe}}})&&e.f)({})),"randSeed4"),Ox=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>Oe.value.sample()),{v:1,name:void 0,ast:{params:[],body:[0,[[10,[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]]]],externalNames:["randomGeneratorSlot"]},get externals(){return{randomGeneratorSlot:Oe}}})&&e.f)({})),"randFloat01"),Vx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>O(Oe.value.sample(),Oe.value.sample(),Oe.value.sample())),{v:1,name:void 0,ast:{params:[],body:[0,[[10,[6,[7,"d","vec3f"],[[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]],[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]],[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]]]]]],externalNames:["d","randomGeneratorSlot"]},get externals(){return{d:de,randomGeneratorSlot:Oe}}})&&e.f)({})),"randInUnitCube"),Gx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>{const t=J(Oe.value.sample()*6),n=t%3,r=O();return r[n]=$(Cs(0,1,t>2)),r[(n+1)%3]=Oe.value.sample(),r[(n+2)%3]=Oe.value.sample(),r}),{v:1,name:void 0,ast:{params:[],body:[0,[[13,"face",[6,[7,"d","u32"],[[1,[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]],"*",[5,"6"]]]]],[13,"axis",[1,"face","%",[5,"3"]]],[13,"result",[6,[7,"d","vec3f"],[]]],[2,[8,"result","axis"],"=",[6,[7,"d","f32"],[[6,"select",[[5,"0"],[5,"1"],[1,"face",">",[5,"2"]]]]]]],[2,[8,"result",[1,[1,"axis","+",[5,"1"]],"%",[5,"3"]]],"=",[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]],[2,[8,"result",[1,[1,"axis","+",[5,"2"]],"%",[5,"3"]]],"=",[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]],[10,"result"]]],externalNames:["d","randomGeneratorSlot","select"]},get externals(){return{d:de,randomGeneratorSlot:Oe,select:Cs}}})&&e.f)({})),"randOnUnitCube"),Dx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],G)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>{const t=gn(Oe.value.sample()),n=Oe.value.sample()*xr;return G(Ft(n)*t,un(n)*t)}),{v:1,name:void 0,ast:{params:[],body:[0,[[13,"radius",[6,"sqrt",[[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]]]],[13,"angle",[1,[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]],"*","TWO_PI"]],[10,[6,[7,"d","vec2f"],[[1,[6,"cos",["angle"]],"*","radius"],[1,[6,"sin",["angle"]],"*","radius"]]]]]],externalNames:["sqrt","randomGeneratorSlot","TWO_PI","d","cos","sin"]},get externals(){return{sqrt:gn,randomGeneratorSlot:Oe,TWO_PI:xr,d:de,cos:Ft,sin:un}}})&&e.f)({})),"randInUnitCircle"),so=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],G)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>{const t=Oe.value.sample()*xr;return G(Ft(t),un(t))}),{v:1,name:void 0,ast:{params:[],body:[0,[[13,"angle",[1,[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]],"*","TWO_PI"]],[10,[6,[7,"d","vec2f"],[[6,"cos",["angle"]],[6,"sin",["angle"]]]]]]],externalNames:["randomGeneratorSlot","TWO_PI","d","cos","sin"]},get externals(){return{randomGeneratorSlot:Oe,TWO_PI:xr,d:de,cos:Ft,sin:un}}})&&e.f)({})),"randOnUnitCircle");(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{let n=t;return Te(t)===0&&(n=t.add(Ds)),an(n)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"v"}],body:[0,[[12,"vNonZero","v"],[11,[1,[6,"length",["v"]],"==",[5,"0"]],[0,[[2,"vNonZero","=",[6,[7,"v","add"],["EPS"]]]]]],[10,[6,"normalize",["vNonZero"]]]]],externalNames:["length","EPS","normalize"]},get externals(){return{length:Te,EPS:Ds,normalize:an}}})&&e.f)({})),"safeNormalize");const io=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>{const t=Oe.value.sample(),n=O(Ss(0,1),Ss(0,1),Ss(0,1));return an(n).mul(wr(t,.33))}),{v:1,name:void 0,ast:{params:[],body:[0,[[13,"u",[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]],[13,"v",[6,[7,"d","vec3f"],[[6,"randNormal",[[5,"0"],[5,"1"]]],[6,"randNormal",[[5,"0"],[5,"1"]]],[6,"randNormal",[[5,"0"],[5,"1"]]]]]],[13,"vNorm",[6,"normalize",["v"]]],[10,[6,[7,"vNorm","mul"],[[6,"pow",["u",[5,"0.33"]]]]]]]],externalNames:["randomGeneratorSlot","d","randNormal","normalize","pow"]},get externals(){return{randomGeneratorSlot:Oe,d:de,randNormal:Ss,normalize:an,pow:wr}}})&&e.f)({})),"randInUnitSphere"),Ws=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>{const t=2*Oe.value.sample()-1,n=gn(1-t*t),r=xr*Oe.value.sample(),s=Ft(r)*n,i=un(r)*n;return O(s,i,t)}),{v:1,name:void 0,ast:{params:[],body:[0,[[13,"z",[1,[1,[5,"2"],"*",[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]],"-",[5,"1"]]],[13,"oneMinusZSq",[6,"sqrt",[[1,[5,"1"],"-",[1,"z","*","z"]]]]],[13,"theta",[1,"TWO_PI","*",[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]]],[13,"x",[1,[6,"cos",["theta"]],"*","oneMinusZSq"]],[13,"y",[1,[6,"sin",["theta"]],"*","oneMinusZSq"]],[10,[6,[7,"d","vec3f"],["x","y","z"]]]]],externalNames:["randomGeneratorSlot","sqrt","TWO_PI","cos","sin","d"]},get externals(){return{randomGeneratorSlot:Oe,sqrt:gn,TWO_PI:xr,cos:Ft,sin:un,d:de}}})&&e.f)({})),"randOnUnitSphere"),Rx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{const n=io(),r=ae(t,n);return be(or(r),n)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"normal"}],body:[0,[[13,"value",[6,"randInUnitSphere",[]]],[13,"alignment",[6,"dot",["normal","value"]]],[10,[6,"mul",[[6,"sign",["alignment"]],"value"]]]]],externalNames:["randInUnitSphere","dot","mul","sign"]},get externals(){return{randInUnitSphere:io,dot:ae,mul:be,sign:or}}})&&e.f)({})),"randInUnitHemisphere"),Nx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{const n=Ws(),r=ae(t,n);return be(or(r),n)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"normal"}],body:[0,[[13,"value",[6,"randOnUnitSphere",[]]],[13,"alignment",[6,"dot",["normal","value"]]],[10,[6,"mul",[[6,"sign",["alignment"]],"value"]]]]],externalNames:["randOnUnitSphere","dot","mul","sign"]},get externals(){return{randOnUnitSphere:Ws,dot:ae,mul:be,sign:or}}})&&e.f)({})),"randOnUnitHemisphere"),dr=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>Oe.value.sample()*(1-2*Ds)+Ds),{v:1,name:void 0,ast:{params:[],body:[0,[[10,[1,[1,[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]],"*",[1,[5,"1"],"-",[1,[5,"2"],"*","EPS"]]],"+","EPS"]]]],externalNames:["randomGeneratorSlot","EPS"]},get externals(){return{randomGeneratorSlot:Oe,EPS:Ds}}})&&e.f)({})),"randUniformExclusive"),Ss=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{const r=xr*dr();return gn(-2*Ys(dr()))*un(r)*n+t}),{v:1,name:void 0,ast:{params:[{type:"i",name:"mu"},{type:"i",name:"sigma"}],body:[0,[[13,"theta",[1,"TWO_PI","*",[6,"randUniformExclusive",[]]]],[13,"R",[6,"sqrt",[[1,[4,"-",[5,"2"]],"*",[6,"log",[[6,"randUniformExclusive",[]]]]]]]],[10,[1,[1,[1,"R","*",[6,"sin",["theta"]]],"*","sigma"],"+","mu"]]]],externalNames:["TWO_PI","randUniformExclusive","sqrt","log","sin"]},get externals(){return{TWO_PI:xr,randUniformExclusive:dr,sqrt:gn,log:Ys,sin:un}}})&&e.f)({})),"randNormal"),Fx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{const n=dr();return-1/t*Ys(n)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"rate"}],body:[0,[[13,"u",[6,"randUniformExclusive",[]]],[10,[1,[1,[4,"-",[5,"1"]],"/","rate"],"*",[6,"log",["u"]]]]]],externalNames:["randUniformExclusive","log"]},get externals(){return{randUniformExclusive:dr,log:Ys}}})&&e.f)({})),"randExponential"),Lx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$,$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{const r=dr();return t+n*Ca(Math.PI*(r-.5))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"x0"},{type:"i",name:"gamma"}],body:[0,[[13,"u",[6,"randUniformExclusive",[]]],[10,[1,"x0","+",[1,"gamma","*",[6,"tan",[[1,[7,"Math","PI"],"*",[1,"u","-",[5,"0.5"]]]]]]]]]],externalNames:["randUniformExclusive","tan","Math"]},get externals(){return{randUniformExclusive:dr,tan:Ca,Math}}})&&e.f)({})),"randCauchy"),jx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([$],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{const n=Oe.value.sample();return Ya(n,t)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"p"}],body:[0,[[13,"u",[6,[7,[7,"randomGeneratorSlot","value"],"sample"],[]]],[10,[6,"step",["u","p"]]]]],externalNames:["randomGeneratorSlot","step"]},get externals(){return{randomGeneratorSlot:Oe,step:Ya}}})&&e.f)({})),"randBernoulli"),lp=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>{"use gpu";return be(be(n,be(n,n)),ue(be(n,K(be(n,6),15)),10))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"t"}],body:[0,[[10,[6,"mul",[[6,"mul",["t",[6,"mul",["t","t"]]]],[6,"add",[[6,"mul",["t",[6,"sub",[[6,"mul",["t",[5,"6"]]],[5,"15"]]]]],[5,"10"]]]]]]]],externalNames:["mul","add","sub"]},get externals(){return{mul:be,add:ue,sub:K}}})&&t.f)({}),{v:1,name:"quinticInterpolationImpl",ast:{params:[{type:"i",name:"t"}],body:[0,[[10,[6,"mul",[[6,"mul",["t",[6,"mul",["t","t"]]]],[6,"add",[[6,"mul",["t",[6,"sub",[[6,"mul",["t",[5,"6"]]],[5,"15"]]]]],[5,"10"]]]]]]]],externalNames:["mul","add","sub"]},get externals(){return{mul:be,add:ue,sub:K}}})&&e.f)({}),Wi=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G],G)(lp),"quinticInterpolation2"),Nu=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O],O)(lp),"quinticInterpolation3"),cp=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(t.f=(n=>{"use gpu";return be(be(be(30,n),n),ue(be(n,K(n,2)),1))}),{v:1,name:void 0,ast:{params:[{type:"i",name:"t"}],body:[0,[[10,[6,"mul",[[6,"mul",[[6,"mul",[[5,"30"],"t"]],"t"]],[6,"add",[[6,"mul",["t",[6,"sub",["t",[5,"2"]]]]],[5,"1"]]]]]]]],externalNames:["mul","add","sub"]},get externals(){return{mul:be,add:ue,sub:K}}})&&t.f)({}),{v:1,name:"quinticDerivativeImpl",ast:{params:[{type:"i",name:"t"}],body:[0,[[10,[6,"mul",[[6,"mul",[[6,"mul",[[5,"30"],"t"]],"t"]],[6,"add",[[6,"mul",["t",[6,"sub",["t",[5,"2"]]]]],[5,"1"]]]]]]]],externalNames:["mul","add","sub"]},get externals(){return{mul:be,add:ue,sub:K}}})&&e.f)({}),Fu=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G],G)(cp),"quinticDerivative2");(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O],O)(cp),"quinticDerivative3");const Yx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([Be],G)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>(no(be(.001,G(t))),so())),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"}],body:[0,[[6,"randSeed2",[[6,"mul",[[5,"0.001"],[6,[7,"d","vec2f"],["pos"]]]]]],[10,[6,"randOnUnitCircle",[]]]]],externalNames:["randSeed2","mul","d","randOnUnitCircle"]},get externals(){return{randSeed2:no,mul:be,d:de,randOnUnitCircle:so}}})&&e.f)({})),"computeJunctionGradient"),Yn=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.slot(Yx),"getJunctionGradientSlot");(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{const n=Be(Vr(t)),r=tr(t),s=Wi(r),i=Yn.$(n),p=Yn.$(ue(n,Be(1,0))),y=Yn.$(ue(n,Be(0,1))),v=Yn.$(ue(n,Be(1,1))),_=ae(i,K(r,G(0,0))),P=ae(p,K(r,G(1,0))),U=ae(y,K(r,G(0,1))),N=ae(v,K(r,G(1,1)));return _+s.x*(P-_)+s.y*(U-_)+s.x*s.y*(_-P-U+N)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"}],body:[0,[[13,"i",[6,[7,"d","vec2i"],[[6,"floor",["pos"]]]]],[13,"f",[6,"fract",["pos"]]],[13,"u",[6,"quinticInterpolation2",["f"]]],[13,"ga",[6,[7,"getJunctionGradientSlot","$"],["i"]]],[13,"gb",[6,[7,"getJunctionGradientSlot","$"],[[6,"add",["i",[6,[7,"d","vec2i"],[[5,"1"],[5,"0"]]]]]]]],[13,"gc",[6,[7,"getJunctionGradientSlot","$"],[[6,"add",["i",[6,[7,"d","vec2i"],[[5,"0"],[5,"1"]]]]]]]],[13,"gd",[6,[7,"getJunctionGradientSlot","$"],[[6,"add",["i",[6,[7,"d","vec2i"],[[5,"1"],[5,"1"]]]]]]]],[13,"va",[6,"dot",["ga",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"0"],[5,"0"]]]]]]]],[13,"vb",[6,"dot",["gb",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"1"],[5,"0"]]]]]]]],[13,"vc",[6,"dot",["gc",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"0"],[5,"1"]]]]]]]],[13,"vd",[6,"dot",["gd",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"1"],[5,"1"]]]]]]]],[13,"noise",[1,[1,[1,"va","+",[1,[7,"u","x"],"*",[1,"vb","-","va"]]],"+",[1,[7,"u","y"],"*",[1,"vc","-","va"]]],"+",[1,[1,[7,"u","x"],"*",[7,"u","y"]],"*",[1,[1,[1,"va","-","vb"],"-","vc"],"+","vd"]]]],[10,"noise"]]],externalNames:["d","floor","fract","quinticInterpolation2","getJunctionGradientSlot","add","dot","sub"]},get externals(){return{d:de,floor:Vr,fract:tr,quinticInterpolation2:Wi,getJunctionGradientSlot:Yn,add:ue,dot:ae,sub:K}}})&&e.f)({})),"sample");(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([G],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{const n=Be(Vr(t)),r=tr(t),s=Wi(r),i=Fu(r),p=Yn.$(n),y=Yn.$(ue(n,Be(1,0))),v=Yn.$(ue(n,Be(0,1))),_=Yn.$(ue(n,Be(1,1))),P=ae(p,K(r,G(0,0))),U=ae(y,K(r,G(1,0))),N=ae(v,K(r,G(0,1))),j=ae(_,K(r,G(1,1))),L=P+s.x*(U-P)+s.y*(N-P)+s.x*s.y*(P-U-N+j),Z=ue(p,ue(ue(ue(be(s.x,K(y,p)),be(s.y,K(v,p))),be(s.x,be(s.y,ue(K(K(p,y),v),_)))),be(i,K(ue(be(s.yx,P-U-N+j),G(U,N)),P))));return O(L,Z)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"}],body:[0,[[13,"i",[6,[7,"d","vec2i"],[[6,"floor",["pos"]]]]],[13,"f",[6,"fract",["pos"]]],[13,"u",[6,"quinticInterpolation2",["f"]]],[13,"du",[6,"quinticDerivative2",["f"]]],[13,"ga",[6,[7,"getJunctionGradientSlot","$"],["i"]]],[13,"gb",[6,[7,"getJunctionGradientSlot","$"],[[6,"add",["i",[6,[7,"d","vec2i"],[[5,"1"],[5,"0"]]]]]]]],[13,"gc",[6,[7,"getJunctionGradientSlot","$"],[[6,"add",["i",[6,[7,"d","vec2i"],[[5,"0"],[5,"1"]]]]]]]],[13,"gd",[6,[7,"getJunctionGradientSlot","$"],[[6,"add",["i",[6,[7,"d","vec2i"],[[5,"1"],[5,"1"]]]]]]]],[13,"va",[6,"dot",["ga",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"0"],[5,"0"]]]]]]]],[13,"vb",[6,"dot",["gb",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"1"],[5,"0"]]]]]]]],[13,"vc",[6,"dot",["gc",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"0"],[5,"1"]]]]]]]],[13,"vd",[6,"dot",["gd",[6,"sub",["f",[6,[7,"d","vec2f"],[[5,"1"],[5,"1"]]]]]]]],[13,"noise",[1,[1,[1,"va","+",[1,[7,"u","x"],"*",[1,"vb","-","va"]]],"+",[1,[7,"u","y"],"*",[1,"vc","-","va"]]],"+",[1,[1,[7,"u","x"],"*",[7,"u","y"]],"*",[1,[1,[1,"va","-","vb"],"-","vc"],"+","vd"]]]],[13,"grad",[6,"add",["ga",[6,"add",[[6,"add",[[6,"add",[[6,"mul",[[7,"u","x"],[6,"sub",["gb","ga"]]]],[6,"mul",[[7,"u","y"],[6,"sub",["gc","ga"]]]]]],[6,"mul",[[7,"u","x"],[6,"mul",[[7,"u","y"],[6,"add",[[6,"sub",[[6,"sub",["ga","gb"]],"gc"]],"gd"]]]]]]]],[6,"mul",["du",[6,"sub",[[6,"add",[[6,"mul",[[7,"u","yx"],[1,[1,[1,"va","-","vb"],"-","vc"],"+","vd"]]],[6,[7,"d","vec2f"],["vb","vc"]]]],"va"]]]]]]]]],[10,[6,[7,"d","vec3f"],["noise","grad"]]]]],externalNames:["d","floor","fract","quinticInterpolation2","quinticDerivative2","getJunctionGradientSlot","add","dot","sub","mul"]},get externals(){return{d:de,floor:Vr,fract:tr,quinticInterpolation2:Wi,quinticDerivative2:Fu,getJunctionGradientSlot:Yn,add:ue,dot:ae,sub:K,mul:be}}})&&e.f)({})),"sampleWithGradient");Cn(G);Cn(G);const Cx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([Ot],O)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>(ro(be(.001,O(t))),Ws())),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"}],body:[0,[[6,"randSeed3",[[6,"mul",[[5,"0.001"],[6,[7,"d","vec3f"],["pos"]]]]]],[10,[6,"randOnUnitSphere",[]]]]],externalNames:["randSeed3","mul","d","randOnUnitSphere"]},get externals(){return{randSeed3:ro,mul:be,d:de,randOnUnitSphere:Ws}}})&&e.f)({})),"computeJunctionGradient"),Lu=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.slot(Cx),"getJunctionGradientSlot"),Xn=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O,O],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{const r=K(t,n),s=Lu.value(Ot(n));return ae(r,s)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"},{type:"i",name:"junction"}],body:[0,[[13,"relative",[6,"sub",["pos","junction"]]],[13,"gridVector",[6,[7,"getJunctionGradientSlot","value"],[[6,[7,"d","vec3i"],["junction"]]]]],[10,[6,"dot",["relative","gridVector"]]]]],externalNames:["sub","getJunctionGradientSlot","d","dot"]},get externals(){return{sub:K,getJunctionGradientSlot:Lu,d:de,dot:ae}}})&&e.f)({})),"dotProdGrid");(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.fn([O],$)((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{const n=Vr(t),r=Xn(t,n),s=Xn(t,ue(n,O(0,0,1))),i=Xn(t,ue(n,O(0,1,0))),p=Xn(t,ue(n,O(0,1,1))),y=Xn(t,ue(n,O(1,0,0))),v=Xn(t,ue(n,O(1,0,1))),_=Xn(t,ue(n,O(1,1,0))),P=Xn(t,ue(n,O(1,1,1))),U=K(t,n),N=Nu(U),j=rn(r,s,N.z),L=rn(i,p,N.z),Z=rn(y,v,N.z),Q=rn(_,P,N.z),se=rn(j,L,N.y),ze=rn(Z,Q,N.y);return rn(se,ze,N.x)}),{v:1,name:void 0,ast:{params:[{type:"i",name:"pos"}],body:[0,[[13,"minJunction",[6,"floor",["pos"]]],[13,"xyz",[6,"dotProdGrid",["pos","minJunction"]]],[13,"xyZ",[6,"dotProdGrid",["pos",[6,"add",["minJunction",[6,[7,"d","vec3f"],[[5,"0"],[5,"0"],[5,"1"]]]]]]]],[13,"xYz",[6,"dotProdGrid",["pos",[6,"add",["minJunction",[6,[7,"d","vec3f"],[[5,"0"],[5,"1"],[5,"0"]]]]]]]],[13,"xYZ",[6,"dotProdGrid",["pos",[6,"add",["minJunction",[6,[7,"d","vec3f"],[[5,"0"],[5,"1"],[5,"1"]]]]]]]],[13,"Xyz",[6,"dotProdGrid",["pos",[6,"add",["minJunction",[6,[7,"d","vec3f"],[[5,"1"],[5,"0"],[5,"0"]]]]]]]],[13,"XyZ",[6,"dotProdGrid",["pos",[6,"add",["minJunction",[6,[7,"d","vec3f"],[[5,"1"],[5,"0"],[5,"1"]]]]]]]],[13,"XYz",[6,"dotProdGrid",["pos",[6,"add",["minJunction",[6,[7,"d","vec3f"],[[5,"1"],[5,"1"],[5,"0"]]]]]]]],[13,"XYZ",[6,"dotProdGrid",["pos",[6,"add",["minJunction",[6,[7,"d","vec3f"],[[5,"1"],[5,"1"],[5,"1"]]]]]]]],[13,"partial",[6,"sub",["pos","minJunction"]]],[13,"smoothPartial",[6,"quinticInterpolation3",["partial"]]],[13,"xy",[6,"mix",["xyz","xyZ",[7,"smoothPartial","z"]]]],[13,"xY",[6,"mix",["xYz","xYZ",[7,"smoothPartial","z"]]]],[13,"Xy",[6,"mix",["Xyz","XyZ",[7,"smoothPartial","z"]]]],[13,"XY",[6,"mix",["XYz","XYZ",[7,"smoothPartial","z"]]]],[13,"x",[6,"mix",["xy","xY",[7,"smoothPartial","y"]]]],[13,"X",[6,"mix",["Xy","XY",[7,"smoothPartial","y"]]]],[10,[6,"mix",["x","X",[7,"smoothPartial","x"]]]]]],externalNames:["floor","dotProdGrid","add","d","sub","quinticInterpolation3","mix"]},get externals(){return{floor:Vr,dotProdGrid:Xn,add:ue,d:de,sub:K,quinticInterpolation3:Nu,mix:rn}}})&&e.f)({})),"sample");Cn(O);Cn(O);const ju={seed:Bx,seed2:no,seed3:ro,seed4:kx,sample:Ox,sampleExclusive:dr,normal:Ss,exponential:Fx,cauchy:Lx,bernoulli:jx,inUnitCircle:Dx,onUnitCircle:so,inUnitCube:Vx,onUnitCube:Gx,inHemisphere:Rx,onHemisphere:Nx,inUnitSphere:io,onUnitSphere:Ws},qx=O(0,2.5,.5),_i=12,va=10,cr=.001,Yu=O(1),Cu=O(.2),qu=O(.6),Wu=.6,Xu=10,Ju=.6,ba=1.42,Zu=1,Ta=3,$i=.1,_a=.5,Hu=cr*5,cs=O(.4,.4,.4),Wx={mass:1,stiffness:1e3,damping:10},Xx={mass:1,stiffness:900,damping:12},Jx={mass:1,stiffness:1e3,damping:20},Zx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(Wn({direction:O,color:O}),"DirectionalLight"),Rs={SLIDER:1,BACKGROUND:2},Qu=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(Wn({distance:$,objectType:Ae}),"HitInfo"),Ku=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(Wn({hit:ke,tMin:$,tMax:$}),"BoxIntersection"),el=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(Wn({origin:O,direction:O}),"Ray"),tl=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(Wn({min:O,max:O}),"BoundingBox"),Hx=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(Wn({posX:$,posY:$,posZ:$,baseCenterX:$,baseCenterY:$,baseCenterZ:$,squashX:$,squashZ:$,wiggleX:$}),"SwitchState"),hp=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.bindGroupLayout({backgroundTexture:{texture:ps($)}}),"rayMarchLayout"),Sr=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.bindGroupLayout({currentTexture:{texture:ps()},historyTexture:{texture:ps()},outputTexture:{storageTexture:ri("rgba8unorm","write-only")}}),"taaResolveLayout"),ao=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H.bindGroupLayout({currentTexture:{texture:ps()}}),"sampleLayout");class $a{value;target;properties;velocity;constructor(t){this.target=0,this.value=this.target,this.properties={...t},this.velocity=0}update(t){const n=-this.properties.stiffness*(this.value-this.target),r=-this.properties.damping*this.velocity,s=(n+r)/this.properties.mass;this.velocity=this.velocity+s*t,this.value=this.value+this.velocity*t}}class Qx{#e;stateUniform;pressed=!1;dragging=!1;basePosition={x:.05,y:.2,z:0};dragStart={x:0,y:0};dragOffset={x:0,y:0};#t;#n;#r;#s;#i;constructor(t){this.#e=t,this.#t=0,this.#n=0,this.#r=new $a(Wx),this.#s=new $a(Xx),this.#i=new $a(Jx),this.stateUniform=this.#e.createUniform(Hx)}async init(){window.addEventListener("devicemotion",t=>{t.accelerationIncludingGravity})}startDrag(t,n){this.dragging=!0,this.dragStart={x:t,y:n},this.dragOffset={x:0,y:0}}updateDrag(t,n){if(!this.dragging)return;const r=t-this.dragStart.x,s=n-this.dragStart.y;this.dragOffset={x:r*.005,y:-s*.005}}endDrag(){this.dragging&&(this.basePosition.x+=this.dragOffset.x,this.basePosition.y+=this.dragOffset.y,this.basePosition.x=Math.max(-1.5,Math.min(1.5,this.basePosition.x)),this.basePosition.y=Math.max(-1.5,Math.min(1.5,this.basePosition.y)),this.dragging=!1,this.dragOffset={x:0,y:0},this.dragStart={x:0,y:0})}getCurrentBaseCenter(){return O(this.basePosition.x+this.dragOffset.x,this.basePosition.y+this.dragOffset.y,this.basePosition.z)}update(t){if(t<=0)return;const n=this.pressed?0:1,r=100;this.#t<n?this.#n+=r*t:this.#t>n&&(this.#n-=r*t),this.pressed&&this.#t<.1&&(this.#r.velocity=5,this.#s.velocity=5,this.#i.velocity=Math.random()*2-1),this.#t=this.#t+this.#n*t,Math.abs(this.#n)>.1&&(this.#i.velocity=this.#n*-.1),this.#t>1&&(this.#t=1,this.#n=0,this.#r.velocity=5,this.#s.velocity=5,this.#i.velocity=5),this.#t<0&&(this.#t=0,this.#n=0,this.#r.velocity=5,this.#s.velocity=5,this.#i.velocity=8),this.#t=jt(this.#t),this.#n*=.95,this.#r.update(t),this.#s.update(t),this.#i.update(t),this.#a()}#a(){const t=this.basePosition.x+this.dragOffset.x,n=this.basePosition.y+this.dragOffset.y;this.stateUniform.write({posX:1-this.#t/-3,posY:1-this.#t,posZ:1-this.#t/-3,baseCenterX:t,baseCenterY:n,baseCenterZ:this.basePosition.z,squashX:0,squashZ:0,wiggleX:0})}}function Kx(e,t){return class extends e{constructor(...n){super(...n),t(this)}}}const e2=Kx(Array,e=>e.fill(0));let me=1e-6;function t2(e){function t(T=0,M=0){const z=new e(2);return T!==void 0&&(z[0]=T,M!==void 0&&(z[1]=M)),z}const n=t;function r(T,M,z){const a=z??new e(2);return a[0]=T,a[1]=M,a}function s(T,M){const z=M??new e(2);return z[0]=Math.ceil(T[0]),z[1]=Math.ceil(T[1]),z}function i(T,M){const z=M??new e(2);return z[0]=Math.floor(T[0]),z[1]=Math.floor(T[1]),z}function p(T,M){const z=M??new e(2);return z[0]=Math.round(T[0]),z[1]=Math.round(T[1]),z}function y(T,M=0,z=1,a){const m=a??new e(2);return m[0]=Math.min(z,Math.max(M,T[0])),m[1]=Math.min(z,Math.max(M,T[1])),m}function v(T,M,z){const a=z??new e(2);return a[0]=T[0]+M[0],a[1]=T[1]+M[1],a}function _(T,M,z,a){const m=a??new e(2);return m[0]=T[0]+M[0]*z,m[1]=T[1]+M[1]*z,m}function P(T,M){const z=T[0],a=T[1],m=M[0],l=M[1],h=Math.sqrt(z*z+a*a),u=Math.sqrt(m*m+l*l),d=h*u,b=d&&ht(T,M)/d;return Math.acos(b)}function U(T,M,z){const a=z??new e(2);return a[0]=T[0]-M[0],a[1]=T[1]-M[1],a}const N=U;function j(T,M){return Math.abs(T[0]-M[0])<me&&Math.abs(T[1]-M[1])<me}function L(T,M){return T[0]===M[0]&&T[1]===M[1]}function Z(T,M,z,a){const m=a??new e(2);return m[0]=T[0]+z*(M[0]-T[0]),m[1]=T[1]+z*(M[1]-T[1]),m}function Q(T,M,z,a){const m=a??new e(2);return m[0]=T[0]+z[0]*(M[0]-T[0]),m[1]=T[1]+z[1]*(M[1]-T[1]),m}function se(T,M,z){const a=z??new e(2);return a[0]=Math.max(T[0],M[0]),a[1]=Math.max(T[1],M[1]),a}function ze(T,M,z){const a=z??new e(2);return a[0]=Math.min(T[0],M[0]),a[1]=Math.min(T[1],M[1]),a}function oe(T,M,z){const a=z??new e(2);return a[0]=T[0]*M,a[1]=T[1]*M,a}const _e=oe;function Ee(T,M,z){const a=z??new e(2);return a[0]=T[0]/M,a[1]=T[1]/M,a}function Pe(T,M){const z=M??new e(2);return z[0]=1/T[0],z[1]=1/T[1],z}const Ue=Pe;function yt(T,M,z){const a=z??new e(3),m=T[0]*M[1]-T[1]*M[0];return a[0]=0,a[1]=0,a[2]=m,a}function ht(T,M){return T[0]*M[0]+T[1]*M[1]}function it(T){const M=T[0],z=T[1];return Math.sqrt(M*M+z*z)}const Ct=it;function _t(T){const M=T[0],z=T[1];return M*M+z*z}const Ht=_t;function gt(T,M){const z=T[0]-M[0],a=T[1]-M[1];return Math.sqrt(z*z+a*a)}const Se=gt;function $e(T,M){const z=T[0]-M[0],a=T[1]-M[1];return z*z+a*a}const xe=$e;function $t(T,M){const z=M??new e(2),a=T[0],m=T[1],l=Math.sqrt(a*a+m*m);return l>1e-5?(z[0]=a/l,z[1]=m/l):(z[0]=0,z[1]=0),z}function Qt(T,M){const z=M??new e(2);return z[0]=-T[0],z[1]=-T[1],z}function je(T,M){const z=M??new e(2);return z[0]=T[0],z[1]=T[1],z}const bn=je;function qt(T,M,z){const a=z??new e(2);return a[0]=T[0]*M[0],a[1]=T[1]*M[1],a}const Tn=qt;function Wt(T,M,z){const a=z??new e(2);return a[0]=T[0]/M[0],a[1]=T[1]/M[1],a}const ln=Wt;function cn(T=1,M){const z=M??new e(2),a=Math.random()*2*Math.PI;return z[0]=Math.cos(a)*T,z[1]=Math.sin(a)*T,z}function A(T){const M=T??new e(2);return M[0]=0,M[1]=0,M}function F(T,M,z){const a=z??new e(2),m=T[0],l=T[1];return a[0]=m*M[0]+l*M[4]+M[12],a[1]=m*M[1]+l*M[5]+M[13],a}function x(T,M,z){const a=z??new e(2),m=T[0],l=T[1];return a[0]=M[0]*m+M[4]*l+M[8],a[1]=M[1]*m+M[5]*l+M[9],a}function o(T,M,z,a){const m=a??new e(2),l=T[0]-M[0],h=T[1]-M[1],u=Math.sin(z),d=Math.cos(z);return m[0]=l*d-h*u+M[0],m[1]=l*u+h*d+M[1],m}function f(T,M,z){const a=z??new e(2);return $t(T,a),oe(a,M,a)}function c(T,M,z){const a=z??new e(2);return it(T)>M?f(T,M,a):je(T,a)}function g(T,M,z){const a=z??new e(2);return Z(T,M,.5,a)}return{create:t,fromValues:n,set:r,ceil:s,floor:i,round:p,clamp:y,add:v,addScaled:_,angle:P,subtract:U,sub:N,equalsApproximately:j,equals:L,lerp:Z,lerpV:Q,max:se,min:ze,mulScalar:oe,scale:_e,divScalar:Ee,inverse:Pe,invert:Ue,cross:yt,dot:ht,length:it,len:Ct,lengthSq:_t,lenSq:Ht,distance:gt,dist:Se,distanceSq:$e,distSq:xe,normalize:$t,negate:Qt,copy:je,clone:bn,multiply:qt,mul:Tn,divide:Wt,div:ln,random:cn,zero:A,transformMat4:F,transformMat3:x,rotate:o,setLength:f,truncate:c,midpoint:g}}const nl=new Map;function pp(e){let t=nl.get(e);return t||(t=t2(e),nl.set(e,t)),t}function n2(e){function t(u,d,b){const w=new e(3);return u!==void 0&&(w[0]=u,d!==void 0&&(w[1]=d,b!==void 0&&(w[2]=b))),w}const n=t;function r(u,d,b,w){const I=w??new e(3);return I[0]=u,I[1]=d,I[2]=b,I}function s(u,d){const b=d??new e(3);return b[0]=Math.ceil(u[0]),b[1]=Math.ceil(u[1]),b[2]=Math.ceil(u[2]),b}function i(u,d){const b=d??new e(3);return b[0]=Math.floor(u[0]),b[1]=Math.floor(u[1]),b[2]=Math.floor(u[2]),b}function p(u,d){const b=d??new e(3);return b[0]=Math.round(u[0]),b[1]=Math.round(u[1]),b[2]=Math.round(u[2]),b}function y(u,d=0,b=1,w){const I=w??new e(3);return I[0]=Math.min(b,Math.max(d,u[0])),I[1]=Math.min(b,Math.max(d,u[1])),I[2]=Math.min(b,Math.max(d,u[2])),I}function v(u,d,b){const w=b??new e(3);return w[0]=u[0]+d[0],w[1]=u[1]+d[1],w[2]=u[2]+d[2],w}function _(u,d,b,w){const I=w??new e(3);return I[0]=u[0]+d[0]*b,I[1]=u[1]+d[1]*b,I[2]=u[2]+d[2]*b,I}function P(u,d){const b=u[0],w=u[1],I=u[2],V=d[0],R=d[1],X=d[2],Y=Math.sqrt(b*b+w*w+I*I),C=Math.sqrt(V*V+R*R+X*X),te=Y*C,le=te&&ht(u,d)/te;return Math.acos(le)}function U(u,d,b){const w=b??new e(3);return w[0]=u[0]-d[0],w[1]=u[1]-d[1],w[2]=u[2]-d[2],w}const N=U;function j(u,d){return Math.abs(u[0]-d[0])<me&&Math.abs(u[1]-d[1])<me&&Math.abs(u[2]-d[2])<me}function L(u,d){return u[0]===d[0]&&u[1]===d[1]&&u[2]===d[2]}function Z(u,d,b,w){const I=w??new e(3);return I[0]=u[0]+b*(d[0]-u[0]),I[1]=u[1]+b*(d[1]-u[1]),I[2]=u[2]+b*(d[2]-u[2]),I}function Q(u,d,b,w){const I=w??new e(3);return I[0]=u[0]+b[0]*(d[0]-u[0]),I[1]=u[1]+b[1]*(d[1]-u[1]),I[2]=u[2]+b[2]*(d[2]-u[2]),I}function se(u,d,b){const w=b??new e(3);return w[0]=Math.max(u[0],d[0]),w[1]=Math.max(u[1],d[1]),w[2]=Math.max(u[2],d[2]),w}function ze(u,d,b){const w=b??new e(3);return w[0]=Math.min(u[0],d[0]),w[1]=Math.min(u[1],d[1]),w[2]=Math.min(u[2],d[2]),w}function oe(u,d,b){const w=b??new e(3);return w[0]=u[0]*d,w[1]=u[1]*d,w[2]=u[2]*d,w}const _e=oe;function Ee(u,d,b){const w=b??new e(3);return w[0]=u[0]/d,w[1]=u[1]/d,w[2]=u[2]/d,w}function Pe(u,d){const b=d??new e(3);return b[0]=1/u[0],b[1]=1/u[1],b[2]=1/u[2],b}const Ue=Pe;function yt(u,d,b){const w=b??new e(3),I=u[2]*d[0]-u[0]*d[2],V=u[0]*d[1]-u[1]*d[0];return w[0]=u[1]*d[2]-u[2]*d[1],w[1]=I,w[2]=V,w}function ht(u,d){return u[0]*d[0]+u[1]*d[1]+u[2]*d[2]}function it(u){const d=u[0],b=u[1],w=u[2];return Math.sqrt(d*d+b*b+w*w)}const Ct=it;function _t(u){const d=u[0],b=u[1],w=u[2];return d*d+b*b+w*w}const Ht=_t;function gt(u,d){const b=u[0]-d[0],w=u[1]-d[1],I=u[2]-d[2];return Math.sqrt(b*b+w*w+I*I)}const Se=gt;function $e(u,d){const b=u[0]-d[0],w=u[1]-d[1],I=u[2]-d[2];return b*b+w*w+I*I}const xe=$e;function $t(u,d){const b=d??new e(3),w=u[0],I=u[1],V=u[2],R=Math.sqrt(w*w+I*I+V*V);return R>1e-5?(b[0]=w/R,b[1]=I/R,b[2]=V/R):(b[0]=0,b[1]=0,b[2]=0),b}function Qt(u,d){const b=d??new e(3);return b[0]=-u[0],b[1]=-u[1],b[2]=-u[2],b}function je(u,d){const b=d??new e(3);return b[0]=u[0],b[1]=u[1],b[2]=u[2],b}const bn=je;function qt(u,d,b){const w=b??new e(3);return w[0]=u[0]*d[0],w[1]=u[1]*d[1],w[2]=u[2]*d[2],w}const Tn=qt;function Wt(u,d,b){const w=b??new e(3);return w[0]=u[0]/d[0],w[1]=u[1]/d[1],w[2]=u[2]/d[2],w}const ln=Wt;function cn(u=1,d){const b=d??new e(3),w=Math.random()*2*Math.PI,I=Math.random()*2-1,V=Math.sqrt(1-I*I)*u;return b[0]=Math.cos(w)*V,b[1]=Math.sin(w)*V,b[2]=I*u,b}function A(u){const d=u??new e(3);return d[0]=0,d[1]=0,d[2]=0,d}function F(u,d,b){const w=b??new e(3),I=u[0],V=u[1],R=u[2],X=d[3]*I+d[7]*V+d[11]*R+d[15]||1;return w[0]=(d[0]*I+d[4]*V+d[8]*R+d[12])/X,w[1]=(d[1]*I+d[5]*V+d[9]*R+d[13])/X,w[2]=(d[2]*I+d[6]*V+d[10]*R+d[14])/X,w}function x(u,d,b){const w=b??new e(3),I=u[0],V=u[1],R=u[2];return w[0]=I*d[0]+V*d[4]+R*d[8],w[1]=I*d[1]+V*d[5]+R*d[9],w[2]=I*d[2]+V*d[6]+R*d[10],w}function o(u,d,b){const w=b??new e(3),I=u[0],V=u[1],R=u[2];return w[0]=I*d[0]+V*d[4]+R*d[8],w[1]=I*d[1]+V*d[5]+R*d[9],w[2]=I*d[2]+V*d[6]+R*d[10],w}function f(u,d,b){const w=b??new e(3),I=d[0],V=d[1],R=d[2],X=d[3]*2,Y=u[0],C=u[1],te=u[2],le=V*te-R*C,ne=R*Y-I*te,ie=I*C-V*Y;return w[0]=Y+le*X+(V*ie-R*ne)*2,w[1]=C+ne*X+(R*le-I*ie)*2,w[2]=te+ie*X+(I*ne-V*le)*2,w}function c(u,d){const b=d??new e(3);return b[0]=u[12],b[1]=u[13],b[2]=u[14],b}function g(u,d,b){const w=b??new e(3),I=d*4;return w[0]=u[I+0],w[1]=u[I+1],w[2]=u[I+2],w}function T(u,d){const b=d??new e(3),w=u[0],I=u[1],V=u[2],R=u[4],X=u[5],Y=u[6],C=u[8],te=u[9],le=u[10];return b[0]=Math.sqrt(w*w+I*I+V*V),b[1]=Math.sqrt(R*R+X*X+Y*Y),b[2]=Math.sqrt(C*C+te*te+le*le),b}function M(u,d,b,w){const I=w??new e(3),V=[],R=[];return V[0]=u[0]-d[0],V[1]=u[1]-d[1],V[2]=u[2]-d[2],R[0]=V[0],R[1]=V[1]*Math.cos(b)-V[2]*Math.sin(b),R[2]=V[1]*Math.sin(b)+V[2]*Math.cos(b),I[0]=R[0]+d[0],I[1]=R[1]+d[1],I[2]=R[2]+d[2],I}function z(u,d,b,w){const I=w??new e(3),V=[],R=[];return V[0]=u[0]-d[0],V[1]=u[1]-d[1],V[2]=u[2]-d[2],R[0]=V[2]*Math.sin(b)+V[0]*Math.cos(b),R[1]=V[1],R[2]=V[2]*Math.cos(b)-V[0]*Math.sin(b),I[0]=R[0]+d[0],I[1]=R[1]+d[1],I[2]=R[2]+d[2],I}function a(u,d,b,w){const I=w??new e(3),V=[],R=[];return V[0]=u[0]-d[0],V[1]=u[1]-d[1],V[2]=u[2]-d[2],R[0]=V[0]*Math.cos(b)-V[1]*Math.sin(b),R[1]=V[0]*Math.sin(b)+V[1]*Math.cos(b),R[2]=V[2],I[0]=R[0]+d[0],I[1]=R[1]+d[1],I[2]=R[2]+d[2],I}function m(u,d,b){const w=b??new e(3);return $t(u,w),oe(w,d,w)}function l(u,d,b){const w=b??new e(3);return it(u)>d?m(u,d,w):je(u,w)}function h(u,d,b){const w=b??new e(3);return Z(u,d,.5,w)}return{create:t,fromValues:n,set:r,ceil:s,floor:i,round:p,clamp:y,add:v,addScaled:_,angle:P,subtract:U,sub:N,equalsApproximately:j,equals:L,lerp:Z,lerpV:Q,max:se,min:ze,mulScalar:oe,scale:_e,divScalar:Ee,inverse:Pe,invert:Ue,cross:yt,dot:ht,length:it,len:Ct,lengthSq:_t,lenSq:Ht,distance:gt,dist:Se,distanceSq:$e,distSq:xe,normalize:$t,negate:Qt,copy:je,clone:bn,multiply:qt,mul:Tn,divide:Wt,div:ln,random:cn,zero:A,transformMat4:F,transformMat4Upper3x3:x,transformMat3:o,transformQuat:f,getTranslation:c,getAxis:g,getScaling:T,rotateX:M,rotateY:z,rotateZ:a,setLength:m,truncate:l,midpoint:h}}const rl=new Map;function da(e){let t=rl.get(e);return t||(t=n2(e),rl.set(e,t)),t}function r2(e){const t=pp(e),n=da(e);function r(o,f,c,g,T,M,z,a,m){const l=new e(12);return l[3]=0,l[7]=0,l[11]=0,o!==void 0&&(l[0]=o,f!==void 0&&(l[1]=f,c!==void 0&&(l[2]=c,g!==void 0&&(l[4]=g,T!==void 0&&(l[5]=T,M!==void 0&&(l[6]=M,z!==void 0&&(l[8]=z,a!==void 0&&(l[9]=a,m!==void 0&&(l[10]=m))))))))),l}function s(o,f,c,g,T,M,z,a,m,l){const h=l??new e(12);return h[0]=o,h[1]=f,h[2]=c,h[3]=0,h[4]=g,h[5]=T,h[6]=M,h[7]=0,h[8]=z,h[9]=a,h[10]=m,h[11]=0,h}function i(o,f){const c=f??new e(12);return c[0]=o[0],c[1]=o[1],c[2]=o[2],c[3]=0,c[4]=o[4],c[5]=o[5],c[6]=o[6],c[7]=0,c[8]=o[8],c[9]=o[9],c[10]=o[10],c[11]=0,c}function p(o,f){const c=f??new e(12),g=o[0],T=o[1],M=o[2],z=o[3],a=g+g,m=T+T,l=M+M,h=g*a,u=T*a,d=T*m,b=M*a,w=M*m,I=M*l,V=z*a,R=z*m,X=z*l;return c[0]=1-d-I,c[1]=u+X,c[2]=b-R,c[3]=0,c[4]=u-X,c[5]=1-h-I,c[6]=w+V,c[7]=0,c[8]=b+R,c[9]=w-V,c[10]=1-h-d,c[11]=0,c}function y(o,f){const c=f??new e(12);return c[0]=-o[0],c[1]=-o[1],c[2]=-o[2],c[4]=-o[4],c[5]=-o[5],c[6]=-o[6],c[8]=-o[8],c[9]=-o[9],c[10]=-o[10],c}function v(o,f,c){const g=c??new e(12);return g[0]=o[0]*f,g[1]=o[1]*f,g[2]=o[2]*f,g[4]=o[4]*f,g[5]=o[5]*f,g[6]=o[6]*f,g[8]=o[8]*f,g[9]=o[9]*f,g[10]=o[10]*f,g}const _=v;function P(o,f,c){const g=c??new e(12);return g[0]=o[0]+f[0],g[1]=o[1]+f[1],g[2]=o[2]+f[2],g[4]=o[4]+f[4],g[5]=o[5]+f[5],g[6]=o[6]+f[6],g[8]=o[8]+f[8],g[9]=o[9]+f[9],g[10]=o[10]+f[10],g}function U(o,f){const c=f??new e(12);return c[0]=o[0],c[1]=o[1],c[2]=o[2],c[4]=o[4],c[5]=o[5],c[6]=o[6],c[8]=o[8],c[9]=o[9],c[10]=o[10],c}const N=U;function j(o,f){return Math.abs(o[0]-f[0])<me&&Math.abs(o[1]-f[1])<me&&Math.abs(o[2]-f[2])<me&&Math.abs(o[4]-f[4])<me&&Math.abs(o[5]-f[5])<me&&Math.abs(o[6]-f[6])<me&&Math.abs(o[8]-f[8])<me&&Math.abs(o[9]-f[9])<me&&Math.abs(o[10]-f[10])<me}function L(o,f){return o[0]===f[0]&&o[1]===f[1]&&o[2]===f[2]&&o[4]===f[4]&&o[5]===f[5]&&o[6]===f[6]&&o[8]===f[8]&&o[9]===f[9]&&o[10]===f[10]}function Z(o){const f=o??new e(12);return f[0]=1,f[1]=0,f[2]=0,f[4]=0,f[5]=1,f[6]=0,f[8]=0,f[9]=0,f[10]=1,f}function Q(o,f){const c=f??new e(12);if(c===o){let d;return d=o[1],o[1]=o[4],o[4]=d,d=o[2],o[2]=o[8],o[8]=d,d=o[6],o[6]=o[9],o[9]=d,c}const g=o[0],T=o[1],M=o[2],z=o[4],a=o[5],m=o[6],l=o[8],h=o[9],u=o[10];return c[0]=g,c[1]=z,c[2]=l,c[4]=T,c[5]=a,c[6]=h,c[8]=M,c[9]=m,c[10]=u,c}function se(o,f){const c=f??new e(12),g=o[0],T=o[1],M=o[2],z=o[4],a=o[5],m=o[6],l=o[8],h=o[9],u=o[10],d=u*a-m*h,b=-u*z+m*l,w=h*z-a*l,I=1/(g*d+T*b+M*w);return c[0]=d*I,c[1]=(-u*T+M*h)*I,c[2]=(m*T-M*a)*I,c[4]=b*I,c[5]=(u*g-M*l)*I,c[6]=(-m*g+M*z)*I,c[8]=w*I,c[9]=(-h*g+T*l)*I,c[10]=(a*g-T*z)*I,c}function ze(o){const f=o[0],c=o[1],g=o[2],T=o[4],M=o[5],z=o[6],a=o[8],m=o[9],l=o[10];return f*(M*l-m*z)-T*(c*l-m*g)+a*(c*z-M*g)}const oe=se;function _e(o,f,c){const g=c??new e(12),T=o[0],M=o[1],z=o[2],a=o[4],m=o[5],l=o[6],h=o[8],u=o[9],d=o[10],b=f[0],w=f[1],I=f[2],V=f[4],R=f[5],X=f[6],Y=f[8],C=f[9],te=f[10];return g[0]=T*b+a*w+h*I,g[1]=M*b+m*w+u*I,g[2]=z*b+l*w+d*I,g[4]=T*V+a*R+h*X,g[5]=M*V+m*R+u*X,g[6]=z*V+l*R+d*X,g[8]=T*Y+a*C+h*te,g[9]=M*Y+m*C+u*te,g[10]=z*Y+l*C+d*te,g}const Ee=_e;function Pe(o,f,c){const g=c??Z();return o!==g&&(g[0]=o[0],g[1]=o[1],g[2]=o[2],g[4]=o[4],g[5]=o[5],g[6]=o[6]),g[8]=f[0],g[9]=f[1],g[10]=1,g}function Ue(o,f){const c=f??t.create();return c[0]=o[8],c[1]=o[9],c}function yt(o,f,c){const g=c??t.create(),T=f*4;return g[0]=o[T+0],g[1]=o[T+1],g}function ht(o,f,c,g){const T=g===o?o:U(o,g),M=c*4;return T[M+0]=f[0],T[M+1]=f[1],T}function it(o,f){const c=f??t.create(),g=o[0],T=o[1],M=o[4],z=o[5];return c[0]=Math.sqrt(g*g+T*T),c[1]=Math.sqrt(M*M+z*z),c}function Ct(o,f){const c=f??n.create(),g=o[0],T=o[1],M=o[2],z=o[4],a=o[5],m=o[6],l=o[8],h=o[9],u=o[10];return c[0]=Math.sqrt(g*g+T*T+M*M),c[1]=Math.sqrt(z*z+a*a+m*m),c[2]=Math.sqrt(l*l+h*h+u*u),c}function _t(o,f){const c=f??new e(12);return c[0]=1,c[1]=0,c[2]=0,c[4]=0,c[5]=1,c[6]=0,c[8]=o[0],c[9]=o[1],c[10]=1,c}function Ht(o,f,c){const g=c??new e(12),T=f[0],M=f[1],z=o[0],a=o[1],m=o[2],l=o[4],h=o[5],u=o[6],d=o[8],b=o[9],w=o[10];return o!==g&&(g[0]=z,g[1]=a,g[2]=m,g[4]=l,g[5]=h,g[6]=u),g[8]=z*T+l*M+d,g[9]=a*T+h*M+b,g[10]=m*T+u*M+w,g}function gt(o,f){const c=f??new e(12),g=Math.cos(o),T=Math.sin(o);return c[0]=g,c[1]=T,c[2]=0,c[4]=-T,c[5]=g,c[6]=0,c[8]=0,c[9]=0,c[10]=1,c}function Se(o,f,c){const g=c??new e(12),T=o[0],M=o[1],z=o[2],a=o[4],m=o[5],l=o[6],h=Math.cos(f),u=Math.sin(f);return g[0]=h*T+u*a,g[1]=h*M+u*m,g[2]=h*z+u*l,g[4]=h*a-u*T,g[5]=h*m-u*M,g[6]=h*l-u*z,o!==g&&(g[8]=o[8],g[9]=o[9],g[10]=o[10]),g}function $e(o,f){const c=f??new e(12),g=Math.cos(o),T=Math.sin(o);return c[0]=1,c[1]=0,c[2]=0,c[4]=0,c[5]=g,c[6]=T,c[8]=0,c[9]=-T,c[10]=g,c}function xe(o,f,c){const g=c??new e(12),T=o[4],M=o[5],z=o[6],a=o[8],m=o[9],l=o[10],h=Math.cos(f),u=Math.sin(f);return g[4]=h*T+u*a,g[5]=h*M+u*m,g[6]=h*z+u*l,g[8]=h*a-u*T,g[9]=h*m-u*M,g[10]=h*l-u*z,o!==g&&(g[0]=o[0],g[1]=o[1],g[2]=o[2]),g}function $t(o,f){const c=f??new e(12),g=Math.cos(o),T=Math.sin(o);return c[0]=g,c[1]=0,c[2]=-T,c[4]=0,c[5]=1,c[6]=0,c[8]=T,c[9]=0,c[10]=g,c}function Qt(o,f,c){const g=c??new e(12),T=o[0],M=o[1],z=o[2],a=o[8],m=o[9],l=o[10],h=Math.cos(f),u=Math.sin(f);return g[0]=h*T-u*a,g[1]=h*M-u*m,g[2]=h*z-u*l,g[8]=h*a+u*T,g[9]=h*m+u*M,g[10]=h*l+u*z,o!==g&&(g[4]=o[4],g[5]=o[5],g[6]=o[6]),g}const je=gt,bn=Se;function qt(o,f){const c=f??new e(12);return c[0]=o[0],c[1]=0,c[2]=0,c[4]=0,c[5]=o[1],c[6]=0,c[8]=0,c[9]=0,c[10]=1,c}function Tn(o,f,c){const g=c??new e(12),T=f[0],M=f[1];return g[0]=T*o[0],g[1]=T*o[1],g[2]=T*o[2],g[4]=M*o[4],g[5]=M*o[5],g[6]=M*o[6],o!==g&&(g[8]=o[8],g[9]=o[9],g[10]=o[10]),g}function Wt(o,f){const c=f??new e(12);return c[0]=o[0],c[1]=0,c[2]=0,c[4]=0,c[5]=o[1],c[6]=0,c[8]=0,c[9]=0,c[10]=o[2],c}function ln(o,f,c){const g=c??new e(12),T=f[0],M=f[1],z=f[2];return g[0]=T*o[0],g[1]=T*o[1],g[2]=T*o[2],g[4]=M*o[4],g[5]=M*o[5],g[6]=M*o[6],g[8]=z*o[8],g[9]=z*o[9],g[10]=z*o[10],g}function cn(o,f){const c=f??new e(12);return c[0]=o,c[1]=0,c[2]=0,c[4]=0,c[5]=o,c[6]=0,c[8]=0,c[9]=0,c[10]=1,c}function A(o,f,c){const g=c??new e(12);return g[0]=f*o[0],g[1]=f*o[1],g[2]=f*o[2],g[4]=f*o[4],g[5]=f*o[5],g[6]=f*o[6],o!==g&&(g[8]=o[8],g[9]=o[9],g[10]=o[10]),g}function F(o,f){const c=f??new e(12);return c[0]=o,c[1]=0,c[2]=0,c[4]=0,c[5]=o,c[6]=0,c[8]=0,c[9]=0,c[10]=o,c}function x(o,f,c){const g=c??new e(12);return g[0]=f*o[0],g[1]=f*o[1],g[2]=f*o[2],g[4]=f*o[4],g[5]=f*o[5],g[6]=f*o[6],g[8]=f*o[8],g[9]=f*o[9],g[10]=f*o[10],g}return{add:P,clone:N,copy:U,create:r,determinant:ze,equals:L,equalsApproximately:j,fromMat4:i,fromQuat:p,get3DScaling:Ct,getAxis:yt,getScaling:it,getTranslation:Ue,identity:Z,inverse:se,invert:oe,mul:Ee,mulScalar:_,multiply:_e,multiplyScalar:v,negate:y,rotate:Se,rotateX:xe,rotateY:Qt,rotateZ:bn,rotation:gt,rotationX:$e,rotationY:$t,rotationZ:je,scale:Tn,scale3D:ln,scaling:qt,scaling3D:Wt,set:s,setAxis:ht,setTranslation:Pe,translate:Ht,translation:_t,transpose:Q,uniformScale:A,uniformScale3D:x,uniformScaling:cn,uniformScaling3D:F}}const sl=new Map;function s2(e){let t=sl.get(e);return t||(t=r2(e),sl.set(e,t)),t}function i2(e){const t=da(e);function n(a,m,l,h,u,d,b,w,I,V,R,X,Y,C,te,le){const ne=new e(16);return a!==void 0&&(ne[0]=a,m!==void 0&&(ne[1]=m,l!==void 0&&(ne[2]=l,h!==void 0&&(ne[3]=h,u!==void 0&&(ne[4]=u,d!==void 0&&(ne[5]=d,b!==void 0&&(ne[6]=b,w!==void 0&&(ne[7]=w,I!==void 0&&(ne[8]=I,V!==void 0&&(ne[9]=V,R!==void 0&&(ne[10]=R,X!==void 0&&(ne[11]=X,Y!==void 0&&(ne[12]=Y,C!==void 0&&(ne[13]=C,te!==void 0&&(ne[14]=te,le!==void 0&&(ne[15]=le)))))))))))))))),ne}function r(a,m,l,h,u,d,b,w,I,V,R,X,Y,C,te,le,ne){const ie=ne??new e(16);return ie[0]=a,ie[1]=m,ie[2]=l,ie[3]=h,ie[4]=u,ie[5]=d,ie[6]=b,ie[7]=w,ie[8]=I,ie[9]=V,ie[10]=R,ie[11]=X,ie[12]=Y,ie[13]=C,ie[14]=te,ie[15]=le,ie}function s(a,m){const l=m??new e(16);return l[0]=a[0],l[1]=a[1],l[2]=a[2],l[3]=0,l[4]=a[4],l[5]=a[5],l[6]=a[6],l[7]=0,l[8]=a[8],l[9]=a[9],l[10]=a[10],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function i(a,m){const l=m??new e(16),h=a[0],u=a[1],d=a[2],b=a[3],w=h+h,I=u+u,V=d+d,R=h*w,X=u*w,Y=u*I,C=d*w,te=d*I,le=d*V,ne=b*w,ie=b*I,Re=b*V;return l[0]=1-Y-le,l[1]=X+Re,l[2]=C-ie,l[3]=0,l[4]=X-Re,l[5]=1-R-le,l[6]=te+ne,l[7]=0,l[8]=C+ie,l[9]=te-ne,l[10]=1-R-Y,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function p(a,m){const l=m??new e(16);return l[0]=-a[0],l[1]=-a[1],l[2]=-a[2],l[3]=-a[3],l[4]=-a[4],l[5]=-a[5],l[6]=-a[6],l[7]=-a[7],l[8]=-a[8],l[9]=-a[9],l[10]=-a[10],l[11]=-a[11],l[12]=-a[12],l[13]=-a[13],l[14]=-a[14],l[15]=-a[15],l}function y(a,m,l){const h=l??new e(16);return h[0]=a[0]+m[0],h[1]=a[1]+m[1],h[2]=a[2]+m[2],h[3]=a[3]+m[3],h[4]=a[4]+m[4],h[5]=a[5]+m[5],h[6]=a[6]+m[6],h[7]=a[7]+m[7],h[8]=a[8]+m[8],h[9]=a[9]+m[9],h[10]=a[10]+m[10],h[11]=a[11]+m[11],h[12]=a[12]+m[12],h[13]=a[13]+m[13],h[14]=a[14]+m[14],h[15]=a[15]+m[15],h}function v(a,m,l){const h=l??new e(16);return h[0]=a[0]*m,h[1]=a[1]*m,h[2]=a[2]*m,h[3]=a[3]*m,h[4]=a[4]*m,h[5]=a[5]*m,h[6]=a[6]*m,h[7]=a[7]*m,h[8]=a[8]*m,h[9]=a[9]*m,h[10]=a[10]*m,h[11]=a[11]*m,h[12]=a[12]*m,h[13]=a[13]*m,h[14]=a[14]*m,h[15]=a[15]*m,h}const _=v;function P(a,m){const l=m??new e(16);return l[0]=a[0],l[1]=a[1],l[2]=a[2],l[3]=a[3],l[4]=a[4],l[5]=a[5],l[6]=a[6],l[7]=a[7],l[8]=a[8],l[9]=a[9],l[10]=a[10],l[11]=a[11],l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15],l}const U=P;function N(a,m){return Math.abs(a[0]-m[0])<me&&Math.abs(a[1]-m[1])<me&&Math.abs(a[2]-m[2])<me&&Math.abs(a[3]-m[3])<me&&Math.abs(a[4]-m[4])<me&&Math.abs(a[5]-m[5])<me&&Math.abs(a[6]-m[6])<me&&Math.abs(a[7]-m[7])<me&&Math.abs(a[8]-m[8])<me&&Math.abs(a[9]-m[9])<me&&Math.abs(a[10]-m[10])<me&&Math.abs(a[11]-m[11])<me&&Math.abs(a[12]-m[12])<me&&Math.abs(a[13]-m[13])<me&&Math.abs(a[14]-m[14])<me&&Math.abs(a[15]-m[15])<me}function j(a,m){return a[0]===m[0]&&a[1]===m[1]&&a[2]===m[2]&&a[3]===m[3]&&a[4]===m[4]&&a[5]===m[5]&&a[6]===m[6]&&a[7]===m[7]&&a[8]===m[8]&&a[9]===m[9]&&a[10]===m[10]&&a[11]===m[11]&&a[12]===m[12]&&a[13]===m[13]&&a[14]===m[14]&&a[15]===m[15]}function L(a){const m=a??new e(16);return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function Z(a,m){const l=m??new e(16);if(l===a){let Ie;return Ie=a[1],a[1]=a[4],a[4]=Ie,Ie=a[2],a[2]=a[8],a[8]=Ie,Ie=a[3],a[3]=a[12],a[12]=Ie,Ie=a[6],a[6]=a[9],a[9]=Ie,Ie=a[7],a[7]=a[13],a[13]=Ie,Ie=a[11],a[11]=a[14],a[14]=Ie,l}const h=a[0],u=a[1],d=a[2],b=a[3],w=a[4],I=a[5],V=a[6],R=a[7],X=a[8],Y=a[9],C=a[10],te=a[11],le=a[12],ne=a[13],ie=a[14],Re=a[15];return l[0]=h,l[1]=w,l[2]=X,l[3]=le,l[4]=u,l[5]=I,l[6]=Y,l[7]=ne,l[8]=d,l[9]=V,l[10]=C,l[11]=ie,l[12]=b,l[13]=R,l[14]=te,l[15]=Re,l}function Q(a,m){const l=m??new e(16),h=a[0],u=a[1],d=a[2],b=a[3],w=a[4],I=a[5],V=a[6],R=a[7],X=a[8],Y=a[9],C=a[10],te=a[11],le=a[12],ne=a[13],ie=a[14],Re=a[15],Ie=C*Re,pt=ie*te,dt=V*Re,ft=ie*R,Mt=V*te,St=C*R,Pt=d*Re,Ut=ie*b,At=d*te,It=C*b,Vt=d*R,Gt=V*b,Dt=X*ne,Rt=le*Y,Kt=w*ne,en=le*I,tn=w*Y,oi=X*I,ui=h*ne,li=le*u,ci=h*Y,hi=X*u,pi=h*I,di=w*u,Ko=Ie*I+ft*Y+Mt*ne-(pt*I+dt*Y+St*ne),eu=pt*u+Pt*Y+It*ne-(Ie*u+Ut*Y+At*ne),tu=dt*u+Ut*I+Vt*ne-(ft*u+Pt*I+Gt*ne),nu=St*u+At*I+Gt*Y-(Mt*u+It*I+Vt*Y),Bt=1/(h*Ko+w*eu+X*tu+le*nu);return l[0]=Bt*Ko,l[1]=Bt*eu,l[2]=Bt*tu,l[3]=Bt*nu,l[4]=Bt*(pt*w+dt*X+St*le-(Ie*w+ft*X+Mt*le)),l[5]=Bt*(Ie*h+Ut*X+At*le-(pt*h+Pt*X+It*le)),l[6]=Bt*(ft*h+Pt*w+Gt*le-(dt*h+Ut*w+Vt*le)),l[7]=Bt*(Mt*h+It*w+Vt*X-(St*h+At*w+Gt*X)),l[8]=Bt*(Dt*R+en*te+tn*Re-(Rt*R+Kt*te+oi*Re)),l[9]=Bt*(Rt*b+ui*te+hi*Re-(Dt*b+li*te+ci*Re)),l[10]=Bt*(Kt*b+li*R+pi*Re-(en*b+ui*R+di*Re)),l[11]=Bt*(oi*b+ci*R+di*te-(tn*b+hi*R+pi*te)),l[12]=Bt*(Kt*C+oi*ie+Rt*V-(tn*ie+Dt*V+en*C)),l[13]=Bt*(ci*ie+Dt*d+li*C-(ui*C+hi*ie+Rt*d)),l[14]=Bt*(ui*V+di*ie+en*d-(pi*ie+Kt*d+li*V)),l[15]=Bt*(pi*C+tn*d+hi*V-(ci*V+di*C+oi*d)),l}function se(a){const m=a[0],l=a[1],h=a[2],u=a[3],d=a[4],b=a[5],w=a[6],I=a[7],V=a[8],R=a[9],X=a[10],Y=a[11],C=a[12],te=a[13],le=a[14],ne=a[15],ie=X*ne,Re=le*Y,Ie=w*ne,pt=le*I,dt=w*Y,ft=X*I,Mt=h*ne,St=le*u,Pt=h*Y,Ut=X*u,At=h*I,It=w*u,Vt=ie*b+pt*R+dt*te-(Re*b+Ie*R+ft*te),Gt=Re*l+Mt*R+Ut*te-(ie*l+St*R+Pt*te),Dt=Ie*l+St*b+At*te-(pt*l+Mt*b+It*te),Rt=ft*l+Pt*b+It*R-(dt*l+Ut*b+At*R);return m*Vt+d*Gt+V*Dt+C*Rt}const ze=Q;function oe(a,m,l){const h=l??new e(16),u=a[0],d=a[1],b=a[2],w=a[3],I=a[4],V=a[5],R=a[6],X=a[7],Y=a[8],C=a[9],te=a[10],le=a[11],ne=a[12],ie=a[13],Re=a[14],Ie=a[15],pt=m[0],dt=m[1],ft=m[2],Mt=m[3],St=m[4],Pt=m[5],Ut=m[6],At=m[7],It=m[8],Vt=m[9],Gt=m[10],Dt=m[11],Rt=m[12],Kt=m[13],en=m[14],tn=m[15];return h[0]=u*pt+I*dt+Y*ft+ne*Mt,h[1]=d*pt+V*dt+C*ft+ie*Mt,h[2]=b*pt+R*dt+te*ft+Re*Mt,h[3]=w*pt+X*dt+le*ft+Ie*Mt,h[4]=u*St+I*Pt+Y*Ut+ne*At,h[5]=d*St+V*Pt+C*Ut+ie*At,h[6]=b*St+R*Pt+te*Ut+Re*At,h[7]=w*St+X*Pt+le*Ut+Ie*At,h[8]=u*It+I*Vt+Y*Gt+ne*Dt,h[9]=d*It+V*Vt+C*Gt+ie*Dt,h[10]=b*It+R*Vt+te*Gt+Re*Dt,h[11]=w*It+X*Vt+le*Gt+Ie*Dt,h[12]=u*Rt+I*Kt+Y*en+ne*tn,h[13]=d*Rt+V*Kt+C*en+ie*tn,h[14]=b*Rt+R*Kt+te*en+Re*tn,h[15]=w*Rt+X*Kt+le*en+Ie*tn,h}const _e=oe;function Ee(a,m,l){const h=l??L();return a!==h&&(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11]),h[12]=m[0],h[13]=m[1],h[14]=m[2],h[15]=1,h}function Pe(a,m){const l=m??t.create();return l[0]=a[12],l[1]=a[13],l[2]=a[14],l}function Ue(a,m,l){const h=l??t.create(),u=m*4;return h[0]=a[u+0],h[1]=a[u+1],h[2]=a[u+2],h}function yt(a,m,l,h){const u=h===a?h:P(a,h),d=l*4;return u[d+0]=m[0],u[d+1]=m[1],u[d+2]=m[2],u}function ht(a,m){const l=m??t.create(),h=a[0],u=a[1],d=a[2],b=a[4],w=a[5],I=a[6],V=a[8],R=a[9],X=a[10];return l[0]=Math.sqrt(h*h+u*u+d*d),l[1]=Math.sqrt(b*b+w*w+I*I),l[2]=Math.sqrt(V*V+R*R+X*X),l}function it(a,m,l,h,u){const d=u??new e(16),b=Math.tan(Math.PI*.5-.5*a);if(d[0]=b/m,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=b,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,Number.isFinite(h)){const w=1/(l-h);d[10]=h*w,d[14]=h*l*w}else d[10]=-1,d[14]=-l;return d}function Ct(a,m,l,h=1/0,u){const d=u??new e(16),b=1/Math.tan(a*.5);if(d[0]=b/m,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=b,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,h===1/0)d[10]=0,d[14]=l;else{const w=1/(h-l);d[10]=l*w,d[14]=h*l*w}return d}function _t(a,m,l,h,u,d,b){const w=b??new e(16);return w[0]=2/(m-a),w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2/(h-l),w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1/(u-d),w[11]=0,w[12]=(m+a)/(a-m),w[13]=(h+l)/(l-h),w[14]=u/(u-d),w[15]=1,w}function Ht(a,m,l,h,u,d,b){const w=b??new e(16),I=m-a,V=h-l,R=u-d;return w[0]=2*u/I,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*u/V,w[6]=0,w[7]=0,w[8]=(a+m)/I,w[9]=(h+l)/V,w[10]=d/R,w[11]=-1,w[12]=0,w[13]=0,w[14]=u*d/R,w[15]=0,w}function gt(a,m,l,h,u,d=1/0,b){const w=b??new e(16),I=m-a,V=h-l;if(w[0]=2*u/I,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*u/V,w[6]=0,w[7]=0,w[8]=(a+m)/I,w[9]=(h+l)/V,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,d===1/0)w[10]=0,w[14]=u;else{const R=1/(d-u);w[10]=u*R,w[14]=d*u*R}return w}const Se=t.create(),$e=t.create(),xe=t.create();function $t(a,m,l,h){const u=h??new e(16);return t.normalize(t.subtract(m,a,xe),xe),t.normalize(t.cross(l,xe,Se),Se),t.normalize(t.cross(xe,Se,$e),$e),u[0]=Se[0],u[1]=Se[1],u[2]=Se[2],u[3]=0,u[4]=$e[0],u[5]=$e[1],u[6]=$e[2],u[7]=0,u[8]=xe[0],u[9]=xe[1],u[10]=xe[2],u[11]=0,u[12]=a[0],u[13]=a[1],u[14]=a[2],u[15]=1,u}function Qt(a,m,l,h){const u=h??new e(16);return t.normalize(t.subtract(a,m,xe),xe),t.normalize(t.cross(l,xe,Se),Se),t.normalize(t.cross(xe,Se,$e),$e),u[0]=Se[0],u[1]=Se[1],u[2]=Se[2],u[3]=0,u[4]=$e[0],u[5]=$e[1],u[6]=$e[2],u[7]=0,u[8]=xe[0],u[9]=xe[1],u[10]=xe[2],u[11]=0,u[12]=a[0],u[13]=a[1],u[14]=a[2],u[15]=1,u}function je(a,m,l,h){const u=h??new e(16);return t.normalize(t.subtract(a,m,xe),xe),t.normalize(t.cross(l,xe,Se),Se),t.normalize(t.cross(xe,Se,$e),$e),u[0]=Se[0],u[1]=$e[0],u[2]=xe[0],u[3]=0,u[4]=Se[1],u[5]=$e[1],u[6]=xe[1],u[7]=0,u[8]=Se[2],u[9]=$e[2],u[10]=xe[2],u[11]=0,u[12]=-(Se[0]*a[0]+Se[1]*a[1]+Se[2]*a[2]),u[13]=-($e[0]*a[0]+$e[1]*a[1]+$e[2]*a[2]),u[14]=-(xe[0]*a[0]+xe[1]*a[1]+xe[2]*a[2]),u[15]=1,u}function bn(a,m){const l=m??new e(16);return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=a[0],l[13]=a[1],l[14]=a[2],l[15]=1,l}function qt(a,m,l){const h=l??new e(16),u=m[0],d=m[1],b=m[2],w=a[0],I=a[1],V=a[2],R=a[3],X=a[4],Y=a[5],C=a[6],te=a[7],le=a[8],ne=a[9],ie=a[10],Re=a[11],Ie=a[12],pt=a[13],dt=a[14],ft=a[15];return a!==h&&(h[0]=w,h[1]=I,h[2]=V,h[3]=R,h[4]=X,h[5]=Y,h[6]=C,h[7]=te,h[8]=le,h[9]=ne,h[10]=ie,h[11]=Re),h[12]=w*u+X*d+le*b+Ie,h[13]=I*u+Y*d+ne*b+pt,h[14]=V*u+C*d+ie*b+dt,h[15]=R*u+te*d+Re*b+ft,h}function Tn(a,m){const l=m??new e(16),h=Math.cos(a),u=Math.sin(a);return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=h,l[6]=u,l[7]=0,l[8]=0,l[9]=-u,l[10]=h,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Wt(a,m,l){const h=l??new e(16),u=a[4],d=a[5],b=a[6],w=a[7],I=a[8],V=a[9],R=a[10],X=a[11],Y=Math.cos(m),C=Math.sin(m);return h[4]=Y*u+C*I,h[5]=Y*d+C*V,h[6]=Y*b+C*R,h[7]=Y*w+C*X,h[8]=Y*I-C*u,h[9]=Y*V-C*d,h[10]=Y*R-C*b,h[11]=Y*X-C*w,a!==h&&(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h}function ln(a,m){const l=m??new e(16),h=Math.cos(a),u=Math.sin(a);return l[0]=h,l[1]=0,l[2]=-u,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=u,l[9]=0,l[10]=h,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function cn(a,m,l){const h=l??new e(16),u=a[0],d=a[1],b=a[2],w=a[3],I=a[8],V=a[9],R=a[10],X=a[11],Y=Math.cos(m),C=Math.sin(m);return h[0]=Y*u-C*I,h[1]=Y*d-C*V,h[2]=Y*b-C*R,h[3]=Y*w-C*X,h[8]=Y*I+C*u,h[9]=Y*V+C*d,h[10]=Y*R+C*b,h[11]=Y*X+C*w,a!==h&&(h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h}function A(a,m){const l=m??new e(16),h=Math.cos(a),u=Math.sin(a);return l[0]=h,l[1]=u,l[2]=0,l[3]=0,l[4]=-u,l[5]=h,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function F(a,m,l){const h=l??new e(16),u=a[0],d=a[1],b=a[2],w=a[3],I=a[4],V=a[5],R=a[6],X=a[7],Y=Math.cos(m),C=Math.sin(m);return h[0]=Y*u+C*I,h[1]=Y*d+C*V,h[2]=Y*b+C*R,h[3]=Y*w+C*X,h[4]=Y*I-C*u,h[5]=Y*V-C*d,h[6]=Y*R-C*b,h[7]=Y*X-C*w,a!==h&&(h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h}function x(a,m,l){const h=l??new e(16);let u=a[0],d=a[1],b=a[2];const w=Math.sqrt(u*u+d*d+b*b);u/=w,d/=w,b/=w;const I=u*u,V=d*d,R=b*b,X=Math.cos(m),Y=Math.sin(m),C=1-X;return h[0]=I+(1-I)*X,h[1]=u*d*C+b*Y,h[2]=u*b*C-d*Y,h[3]=0,h[4]=u*d*C-b*Y,h[5]=V+(1-V)*X,h[6]=d*b*C+u*Y,h[7]=0,h[8]=u*b*C+d*Y,h[9]=d*b*C-u*Y,h[10]=R+(1-R)*X,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}const o=x;function f(a,m,l,h){const u=h??new e(16);let d=m[0],b=m[1],w=m[2];const I=Math.sqrt(d*d+b*b+w*w);d/=I,b/=I,w/=I;const V=d*d,R=b*b,X=w*w,Y=Math.cos(l),C=Math.sin(l),te=1-Y,le=V+(1-V)*Y,ne=d*b*te+w*C,ie=d*w*te-b*C,Re=d*b*te-w*C,Ie=R+(1-R)*Y,pt=b*w*te+d*C,dt=d*w*te+b*C,ft=b*w*te-d*C,Mt=X+(1-X)*Y,St=a[0],Pt=a[1],Ut=a[2],At=a[3],It=a[4],Vt=a[5],Gt=a[6],Dt=a[7],Rt=a[8],Kt=a[9],en=a[10],tn=a[11];return u[0]=le*St+ne*It+ie*Rt,u[1]=le*Pt+ne*Vt+ie*Kt,u[2]=le*Ut+ne*Gt+ie*en,u[3]=le*At+ne*Dt+ie*tn,u[4]=Re*St+Ie*It+pt*Rt,u[5]=Re*Pt+Ie*Vt+pt*Kt,u[6]=Re*Ut+Ie*Gt+pt*en,u[7]=Re*At+Ie*Dt+pt*tn,u[8]=dt*St+ft*It+Mt*Rt,u[9]=dt*Pt+ft*Vt+Mt*Kt,u[10]=dt*Ut+ft*Gt+Mt*en,u[11]=dt*At+ft*Dt+Mt*tn,a!==u&&(u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u}const c=f;function g(a,m){const l=m??new e(16);return l[0]=a[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=a[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=a[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function T(a,m,l){const h=l??new e(16),u=m[0],d=m[1],b=m[2];return h[0]=u*a[0],h[1]=u*a[1],h[2]=u*a[2],h[3]=u*a[3],h[4]=d*a[4],h[5]=d*a[5],h[6]=d*a[6],h[7]=d*a[7],h[8]=b*a[8],h[9]=b*a[9],h[10]=b*a[10],h[11]=b*a[11],a!==h&&(h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h}function M(a,m){const l=m??new e(16);return l[0]=a,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=a,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=a,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function z(a,m,l){const h=l??new e(16);return h[0]=m*a[0],h[1]=m*a[1],h[2]=m*a[2],h[3]=m*a[3],h[4]=m*a[4],h[5]=m*a[5],h[6]=m*a[6],h[7]=m*a[7],h[8]=m*a[8],h[9]=m*a[9],h[10]=m*a[10],h[11]=m*a[11],a!==h&&(h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h}return{add:y,aim:$t,axisRotate:f,axisRotation:x,cameraAim:Qt,clone:U,copy:P,create:n,determinant:se,equals:j,equalsApproximately:N,fromMat3:s,fromQuat:i,frustum:Ht,frustumReverseZ:gt,getAxis:Ue,getScaling:ht,getTranslation:Pe,identity:L,inverse:Q,invert:ze,lookAt:je,mul:_e,mulScalar:_,multiply:oe,multiplyScalar:v,negate:p,ortho:_t,perspective:it,perspectiveReverseZ:Ct,rotate:c,rotateX:Wt,rotateY:cn,rotateZ:F,rotation:o,rotationX:Tn,rotationY:ln,rotationZ:A,scale:T,scaling:g,set:r,setAxis:yt,setTranslation:Ee,translate:qt,translation:bn,transpose:Z,uniformScale:z,uniformScaling:M}}const il=new Map;function a2(e){let t=il.get(e);return t||(t=i2(e),il.set(e,t)),t}function o2(e){const t=da(e);function n(A,F,x,o){const f=new e(4);return A!==void 0&&(f[0]=A,F!==void 0&&(f[1]=F,x!==void 0&&(f[2]=x,o!==void 0&&(f[3]=o)))),f}const r=n;function s(A,F,x,o,f){const c=f??new e(4);return c[0]=A,c[1]=F,c[2]=x,c[3]=o,c}function i(A,F,x){const o=x??new e(4),f=F*.5,c=Math.sin(f);return o[0]=c*A[0],o[1]=c*A[1],o[2]=c*A[2],o[3]=Math.cos(f),o}function p(A,F){const x=F??t.create(3),o=Math.acos(A[3])*2,f=Math.sin(o*.5);return f>me?(x[0]=A[0]/f,x[1]=A[1]/f,x[2]=A[2]/f):(x[0]=1,x[1]=0,x[2]=0),{angle:o,axis:x}}function y(A,F){const x=it(A,F);return Math.acos(2*x*x-1)}function v(A,F,x){const o=x??new e(4),f=A[0],c=A[1],g=A[2],T=A[3],M=F[0],z=F[1],a=F[2],m=F[3];return o[0]=f*m+T*M+c*a-g*z,o[1]=c*m+T*z+g*M-f*a,o[2]=g*m+T*a+f*z-c*M,o[3]=T*m-f*M-c*z-g*a,o}const _=v;function P(A,F,x){const o=x??new e(4),f=F*.5,c=A[0],g=A[1],T=A[2],M=A[3],z=Math.sin(f),a=Math.cos(f);return o[0]=c*a+M*z,o[1]=g*a+T*z,o[2]=T*a-g*z,o[3]=M*a-c*z,o}function U(A,F,x){const o=x??new e(4),f=F*.5,c=A[0],g=A[1],T=A[2],M=A[3],z=Math.sin(f),a=Math.cos(f);return o[0]=c*a-T*z,o[1]=g*a+M*z,o[2]=T*a+c*z,o[3]=M*a-g*z,o}function N(A,F,x){const o=x??new e(4),f=F*.5,c=A[0],g=A[1],T=A[2],M=A[3],z=Math.sin(f),a=Math.cos(f);return o[0]=c*a+g*z,o[1]=g*a-c*z,o[2]=T*a+M*z,o[3]=M*a-T*z,o}function j(A,F,x,o){const f=o??new e(4),c=A[0],g=A[1],T=A[2],M=A[3];let z=F[0],a=F[1],m=F[2],l=F[3],h=c*z+g*a+T*m+M*l;h<0&&(h=-h,z=-z,a=-a,m=-m,l=-l);let u,d;if(1-h>me){const b=Math.acos(h),w=Math.sin(b);u=Math.sin((1-x)*b)/w,d=Math.sin(x*b)/w}else u=1-x,d=x;return f[0]=u*c+d*z,f[1]=u*g+d*a,f[2]=u*T+d*m,f[3]=u*M+d*l,f}function L(A,F){const x=F??new e(4),o=A[0],f=A[1],c=A[2],g=A[3],T=o*o+f*f+c*c+g*g,M=T?1/T:0;return x[0]=-o*M,x[1]=-f*M,x[2]=-c*M,x[3]=g*M,x}function Z(A,F){const x=F??new e(4);return x[0]=-A[0],x[1]=-A[1],x[2]=-A[2],x[3]=A[3],x}function Q(A,F){const x=F??new e(4),o=A[0]+A[5]+A[10];if(o>0){const f=Math.sqrt(o+1);x[3]=.5*f;const c=.5/f;x[0]=(A[6]-A[9])*c,x[1]=(A[8]-A[2])*c,x[2]=(A[1]-A[4])*c}else{let f=0;A[5]>A[0]&&(f=1),A[10]>A[f*4+f]&&(f=2);const c=(f+1)%3,g=(f+2)%3,T=Math.sqrt(A[f*4+f]-A[c*4+c]-A[g*4+g]+1);x[f]=.5*T;const M=.5/T;x[3]=(A[c*4+g]-A[g*4+c])*M,x[c]=(A[c*4+f]+A[f*4+c])*M,x[g]=(A[g*4+f]+A[f*4+g])*M}return x}function se(A,F,x,o,f){const c=f??new e(4),g=A*.5,T=F*.5,M=x*.5,z=Math.sin(g),a=Math.cos(g),m=Math.sin(T),l=Math.cos(T),h=Math.sin(M),u=Math.cos(M);switch(o){case"xyz":c[0]=z*l*u+a*m*h,c[1]=a*m*u-z*l*h,c[2]=a*l*h+z*m*u,c[3]=a*l*u-z*m*h;break;case"xzy":c[0]=z*l*u-a*m*h,c[1]=a*m*u-z*l*h,c[2]=a*l*h+z*m*u,c[3]=a*l*u+z*m*h;break;case"yxz":c[0]=z*l*u+a*m*h,c[1]=a*m*u-z*l*h,c[2]=a*l*h-z*m*u,c[3]=a*l*u+z*m*h;break;case"yzx":c[0]=z*l*u+a*m*h,c[1]=a*m*u+z*l*h,c[2]=a*l*h-z*m*u,c[3]=a*l*u-z*m*h;break;case"zxy":c[0]=z*l*u-a*m*h,c[1]=a*m*u+z*l*h,c[2]=a*l*h+z*m*u,c[3]=a*l*u-z*m*h;break;case"zyx":c[0]=z*l*u-a*m*h,c[1]=a*m*u+z*l*h,c[2]=a*l*h-z*m*u,c[3]=a*l*u+z*m*h;break;default:throw new Error(`Unknown rotation order: ${o}`)}return c}function ze(A,F){const x=F??new e(4);return x[0]=A[0],x[1]=A[1],x[2]=A[2],x[3]=A[3],x}const oe=ze;function _e(A,F,x){const o=x??new e(4);return o[0]=A[0]+F[0],o[1]=A[1]+F[1],o[2]=A[2]+F[2],o[3]=A[3]+F[3],o}function Ee(A,F,x){const o=x??new e(4);return o[0]=A[0]-F[0],o[1]=A[1]-F[1],o[2]=A[2]-F[2],o[3]=A[3]-F[3],o}const Pe=Ee;function Ue(A,F,x){const o=x??new e(4);return o[0]=A[0]*F,o[1]=A[1]*F,o[2]=A[2]*F,o[3]=A[3]*F,o}const yt=Ue;function ht(A,F,x){const o=x??new e(4);return o[0]=A[0]/F,o[1]=A[1]/F,o[2]=A[2]/F,o[3]=A[3]/F,o}function it(A,F){return A[0]*F[0]+A[1]*F[1]+A[2]*F[2]+A[3]*F[3]}function Ct(A,F,x,o){const f=o??new e(4);return f[0]=A[0]+x*(F[0]-A[0]),f[1]=A[1]+x*(F[1]-A[1]),f[2]=A[2]+x*(F[2]-A[2]),f[3]=A[3]+x*(F[3]-A[3]),f}function _t(A){const F=A[0],x=A[1],o=A[2],f=A[3];return Math.sqrt(F*F+x*x+o*o+f*f)}const Ht=_t;function gt(A){const F=A[0],x=A[1],o=A[2],f=A[3];return F*F+x*x+o*o+f*f}const Se=gt;function $e(A,F){const x=F??new e(4),o=A[0],f=A[1],c=A[2],g=A[3],T=Math.sqrt(o*o+f*f+c*c+g*g);return T>1e-5?(x[0]=o/T,x[1]=f/T,x[2]=c/T,x[3]=g/T):(x[0]=0,x[1]=0,x[2]=0,x[3]=1),x}function xe(A,F){return Math.abs(A[0]-F[0])<me&&Math.abs(A[1]-F[1])<me&&Math.abs(A[2]-F[2])<me&&Math.abs(A[3]-F[3])<me}function $t(A,F){return A[0]===F[0]&&A[1]===F[1]&&A[2]===F[2]&&A[3]===F[3]}function Qt(A){const F=A??new e(4);return F[0]=0,F[1]=0,F[2]=0,F[3]=1,F}const je=t.create(),bn=t.create(),qt=t.create();function Tn(A,F,x){const o=x??new e(4),f=t.dot(A,F);return f<-.999999?(t.cross(bn,A,je),t.len(je)<1e-6&&t.cross(qt,A,je),t.normalize(je,je),i(je,Math.PI,o),o):f>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(t.cross(A,F,je),o[0]=je[0],o[1]=je[1],o[2]=je[2],o[3]=1+f,$e(o,o))}const Wt=new e(4),ln=new e(4);function cn(A,F,x,o,f,c){const g=c??new e(4);return j(A,o,f,Wt),j(F,x,f,ln),j(Wt,ln,2*f*(1-f),g),g}return{create:n,fromValues:r,set:s,fromAxisAngle:i,toAxisAngle:p,angle:y,multiply:v,mul:_,rotateX:P,rotateY:U,rotateZ:N,slerp:j,inverse:L,conjugate:Z,fromMat:Q,fromEuler:se,copy:ze,clone:oe,add:_e,subtract:Ee,sub:Pe,mulScalar:Ue,scale:yt,divScalar:ht,dot:it,lerp:Ct,length:_t,len:Ht,lengthSq:gt,lenSq:Se,normalize:$e,equalsApproximately:xe,equals:$t,identity:Qt,rotationTo:Tn,sqlerp:cn}}const al=new Map;function u2(e){let t=al.get(e);return t||(t=o2(e),al.set(e,t)),t}function l2(e){function t(x,o,f,c){const g=new e(4);return x!==void 0&&(g[0]=x,o!==void 0&&(g[1]=o,f!==void 0&&(g[2]=f,c!==void 0&&(g[3]=c)))),g}const n=t;function r(x,o,f,c,g){const T=g??new e(4);return T[0]=x,T[1]=o,T[2]=f,T[3]=c,T}function s(x,o){const f=o??new e(4);return f[0]=Math.ceil(x[0]),f[1]=Math.ceil(x[1]),f[2]=Math.ceil(x[2]),f[3]=Math.ceil(x[3]),f}function i(x,o){const f=o??new e(4);return f[0]=Math.floor(x[0]),f[1]=Math.floor(x[1]),f[2]=Math.floor(x[2]),f[3]=Math.floor(x[3]),f}function p(x,o){const f=o??new e(4);return f[0]=Math.round(x[0]),f[1]=Math.round(x[1]),f[2]=Math.round(x[2]),f[3]=Math.round(x[3]),f}function y(x,o=0,f=1,c){const g=c??new e(4);return g[0]=Math.min(f,Math.max(o,x[0])),g[1]=Math.min(f,Math.max(o,x[1])),g[2]=Math.min(f,Math.max(o,x[2])),g[3]=Math.min(f,Math.max(o,x[3])),g}function v(x,o,f){const c=f??new e(4);return c[0]=x[0]+o[0],c[1]=x[1]+o[1],c[2]=x[2]+o[2],c[3]=x[3]+o[3],c}function _(x,o,f,c){const g=c??new e(4);return g[0]=x[0]+o[0]*f,g[1]=x[1]+o[1]*f,g[2]=x[2]+o[2]*f,g[3]=x[3]+o[3]*f,g}function P(x,o,f){const c=f??new e(4);return c[0]=x[0]-o[0],c[1]=x[1]-o[1],c[2]=x[2]-o[2],c[3]=x[3]-o[3],c}const U=P;function N(x,o){return Math.abs(x[0]-o[0])<me&&Math.abs(x[1]-o[1])<me&&Math.abs(x[2]-o[2])<me&&Math.abs(x[3]-o[3])<me}function j(x,o){return x[0]===o[0]&&x[1]===o[1]&&x[2]===o[2]&&x[3]===o[3]}function L(x,o,f,c){const g=c??new e(4);return g[0]=x[0]+f*(o[0]-x[0]),g[1]=x[1]+f*(o[1]-x[1]),g[2]=x[2]+f*(o[2]-x[2]),g[3]=x[3]+f*(o[3]-x[3]),g}function Z(x,o,f,c){const g=c??new e(4);return g[0]=x[0]+f[0]*(o[0]-x[0]),g[1]=x[1]+f[1]*(o[1]-x[1]),g[2]=x[2]+f[2]*(o[2]-x[2]),g[3]=x[3]+f[3]*(o[3]-x[3]),g}function Q(x,o,f){const c=f??new e(4);return c[0]=Math.max(x[0],o[0]),c[1]=Math.max(x[1],o[1]),c[2]=Math.max(x[2],o[2]),c[3]=Math.max(x[3],o[3]),c}function se(x,o,f){const c=f??new e(4);return c[0]=Math.min(x[0],o[0]),c[1]=Math.min(x[1],o[1]),c[2]=Math.min(x[2],o[2]),c[3]=Math.min(x[3],o[3]),c}function ze(x,o,f){const c=f??new e(4);return c[0]=x[0]*o,c[1]=x[1]*o,c[2]=x[2]*o,c[3]=x[3]*o,c}const oe=ze;function _e(x,o,f){const c=f??new e(4);return c[0]=x[0]/o,c[1]=x[1]/o,c[2]=x[2]/o,c[3]=x[3]/o,c}function Ee(x,o){const f=o??new e(4);return f[0]=1/x[0],f[1]=1/x[1],f[2]=1/x[2],f[3]=1/x[3],f}const Pe=Ee;function Ue(x,o){return x[0]*o[0]+x[1]*o[1]+x[2]*o[2]+x[3]*o[3]}function yt(x){const o=x[0],f=x[1],c=x[2],g=x[3];return Math.sqrt(o*o+f*f+c*c+g*g)}const ht=yt;function it(x){const o=x[0],f=x[1],c=x[2],g=x[3];return o*o+f*f+c*c+g*g}const Ct=it;function _t(x,o){const f=x[0]-o[0],c=x[1]-o[1],g=x[2]-o[2],T=x[3]-o[3];return Math.sqrt(f*f+c*c+g*g+T*T)}const Ht=_t;function gt(x,o){const f=x[0]-o[0],c=x[1]-o[1],g=x[2]-o[2],T=x[3]-o[3];return f*f+c*c+g*g+T*T}const Se=gt;function $e(x,o){const f=o??new e(4),c=x[0],g=x[1],T=x[2],M=x[3],z=Math.sqrt(c*c+g*g+T*T+M*M);return z>1e-5?(f[0]=c/z,f[1]=g/z,f[2]=T/z,f[3]=M/z):(f[0]=0,f[1]=0,f[2]=0,f[3]=0),f}function xe(x,o){const f=o??new e(4);return f[0]=-x[0],f[1]=-x[1],f[2]=-x[2],f[3]=-x[3],f}function $t(x,o){const f=o??new e(4);return f[0]=x[0],f[1]=x[1],f[2]=x[2],f[3]=x[3],f}const Qt=$t;function je(x,o,f){const c=f??new e(4);return c[0]=x[0]*o[0],c[1]=x[1]*o[1],c[2]=x[2]*o[2],c[3]=x[3]*o[3],c}const bn=je;function qt(x,o,f){const c=f??new e(4);return c[0]=x[0]/o[0],c[1]=x[1]/o[1],c[2]=x[2]/o[2],c[3]=x[3]/o[3],c}const Tn=qt;function Wt(x){const o=x??new e(4);return o[0]=0,o[1]=0,o[2]=0,o[3]=0,o}function ln(x,o,f){const c=f??new e(4),g=x[0],T=x[1],M=x[2],z=x[3];return c[0]=o[0]*g+o[4]*T+o[8]*M+o[12]*z,c[1]=o[1]*g+o[5]*T+o[9]*M+o[13]*z,c[2]=o[2]*g+o[6]*T+o[10]*M+o[14]*z,c[3]=o[3]*g+o[7]*T+o[11]*M+o[15]*z,c}function cn(x,o,f){const c=f??new e(4);return $e(x,c),ze(c,o,c)}function A(x,o,f){const c=f??new e(4);return yt(x)>o?cn(x,o,c):$t(x,c)}function F(x,o,f){const c=f??new e(4);return L(x,o,.5,c)}return{create:t,fromValues:n,set:r,ceil:s,floor:i,round:p,clamp:y,add:v,addScaled:_,subtract:P,sub:U,equalsApproximately:N,equals:j,lerp:L,lerpV:Z,max:Q,min:se,mulScalar:ze,scale:oe,divScalar:_e,inverse:Ee,invert:Pe,dot:Ue,length:yt,len:ht,lengthSq:it,lenSq:Ct,distance:_t,dist:Ht,distanceSq:gt,distSq:Se,normalize:$e,negate:xe,copy:$t,clone:Qt,multiply:je,mul:bn,divide:qt,div:Tn,zero:Wt,transformMat4:ln,setLength:cn,truncate:A,midpoint:F}}const ol=new Map;function c2(e){let t=ol.get(e);return t||(t=l2(e),ol.set(e,t)),t}function Jo(e,t,n,r,s,i){return{mat3:s2(e),mat4:a2(t),quat:u2(n),vec2:pp(r),vec3:da(s),vec4:c2(i)}}const{mat4:_n}=Jo(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);Jo(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);Jo(e2,Array,Array,Array,Array,Array);const h2=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(Wn({view:ve,proj:ve,viewInv:ve,projInv:ve}),"Camera");function p2(e,t){let n=0,r=1/t,s=e;for(;s>0;)n+=r*(s%t),s=Math.floor(s/t),r=r/t;return n}function*ul(e){let t=1;for(;;)yield p2(t,e),t++}class d2{#e;#t;#n;#r;#s;#i;#a;#u;#o;#l;#c;constructor(t,n,r,s,i,p,y,v=.1,_=10){this.#l=p,this.#c=y,this.#t=_n.lookAt(n,r,s,ve()),this.#i=_n.perspective(i,p/y,v,_,ve()),this.#n=this.#i,this.#r=_n.invert(this.#t,ve()),this.#a=_n.invert(this.#i,ve()),this.#s=this.#a,this.#e=t.createUniform(h2,{view:this.#t,proj:this.#n,viewInv:this.#r,projInv:this.#s}),this.#u=ul(2),this.#o=ul(3)}jitter(){const[t,n]=[this.#u.next().value,this.#o.next().value],r=(t-.5)*2/this.#l,s=(n-.5)*2/this.#c,i=_n.identity(ve());i[12]=r,i[13]=s;const p=_n.mul(i,this.#i,ve()),y=_n.invert(p,ve());this.#e.writePartial({proj:p,projInv:y})}updateView(t,n,r){this.#t=_n.lookAt(t,n,r,ve()),this.#r=_n.invert(this.#t,ve()),this.#e.writePartial({view:this.#t,viewInv:this.#r})}updateProjection(t,n,r,s=.1,i=100){this.#l=n,this.#c=r,this.#i=_n.perspective(t,n/r,s,i,ve()),this.#a=_n.invert(this.#i,ve()),this.#e.writePartial({proj:this.#i,projInv:this.#a})}get cameraUniform(){return this.#e}}const ll=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{"use gpu";const s=wr((n-r)/(n+r),2);return s+(1-s)*wr(1-t,5)}),{v:1,name:"fresnelSchlick",ast:{params:[{type:"i",name:"cosTheta"},{type:"i",name:"ior1"},{type:"i",name:"ior2"}],body:[0,[[13,"r0",[6,[7,"std","pow"],[[1,[1,"ior1","-","ior2"],"/",[1,"ior1","+","ior2"]],[5,"2"]]]],[10,[1,"r0","+",[1,[1,[5,"1"],"-","r0"],"*",[6,[7,"std","pow"],[[1,[5,"1"],"-","cosTheta"],[5,"5"]]]]]]]],externalNames:["std"]},get externals(){return{std:De}}})&&e.f)({}),cl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";return Rc(be(t,-n))}),{v:1,name:"beerLambert",ast:{params:[{type:"i",name:"sigma"},{type:"i",name:"dist"}],body:[0,[[10,[6,[7,"std","exp"],[[6,[7,"std","mul"],["sigma",[4,"-","dist"]]]]]]]],externalNames:["std"]},get externals(){return{std:De}}})&&e.f)({}),hl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{"use gpu";const s=O(1).div(n),i=K(r.min,t).mul(s),p=K(r.max,t).mul(s),y=pe(i,p),v=re(i,p),_=re(re(y.x,y.y),y.z),P=pe(pe(v.x,v.y),v.z),U=Ku();return U.hit=P>=_&&P>=0,U.tMin=_,U.tMax=P,U}),{v:1,name:"intersectBox",ast:{params:[{type:"i",name:"rayOrigin"},{type:"i",name:"rayDirection"},{type:"i",name:"box"}],body:[0,[[13,"invDir",[6,[7,[6,[7,"d","vec3f"],[[5,"1"]]],"div"],["rayDirection"]]],[13,"t1",[6,[7,[6,[7,"std","sub"],[[7,"box","min"],"rayOrigin"]],"mul"],["invDir"]]],[13,"t2",[6,[7,[6,[7,"std","sub"],[[7,"box","max"],"rayOrigin"]],"mul"],["invDir"]]],[13,"tMinVec",[6,[7,"std","min"],["t1","t2"]]],[13,"tMaxVec",[6,[7,"std","max"],["t1","t2"]]],[13,"tMin",[6,[7,"std","max"],[[6,[7,"std","max"],[[7,"tMinVec","x"],[7,"tMinVec","y"]]],[7,"tMinVec","z"]]]],[13,"tMax",[6,[7,"std","min"],[[6,[7,"std","min"],[[7,"tMaxVec","x"],[7,"tMaxVec","y"]]],[7,"tMaxVec","z"]]]],[13,"result",[6,"BoxIntersection",[]]],[2,[7,"result","hit"],"=",[3,[1,"tMax",">=","tMin"],"&&",[1,"tMax",">=",[5,"0"]]]],[2,[7,"result","tMin"],"=","tMin"],[2,[7,"result","tMax"],"=","tMax"],[10,"result"]]],externalNames:["d","std","BoxIntersection"]},get externals(){return{d:de,std:De,BoxIntersection:Ku}}})&&e.f)({});function dp(e,t,n){return[0,1].map(()=>{const r=(globalThis.__TYPEGPU_AUTONAME__??(s=>s))(e["~unstable"].createTexture({size:[t,n],format:"rgba8unorm"}).$usage("storage","sampled","render"),"texture");return{write:r.createView(ri("rgba8unorm")),sampled:r.createView()}})}function fp(e,t,n){return{sampled:(globalThis.__TYPEGPU_AUTONAME__??(s=>s))(e["~unstable"].createTexture({size:[t,n],format:"rgba16float"}).$usage("sampled","render"),"texture").createView()}}const f2=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H["~unstable"].computeFn({workgroupSize:[16,16],in:{gid:Fs.globalInvocationId}})((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(({gid:t})=>{const n=Ii(Sr.$.currentTexture,xt(t.xy),0),r=Ii(Sr.$.historyTexture,xt(t.xy),0);let s=O(9999),i=O(-9999);const p=np(Sr.$.currentTexture);for(let P=-1;P<=1;P++)for(let U=-1;U<=1;U++){const N=Be(t.xy).add(Be(P,U)),j=Or(N,Be(0,0),Be(p.xy).sub(Be(1))),L=Ii(Sr.$.currentTexture,j,0);s=pe(s,L.xyz),i=re(i,L.xyz)}const y=Or(r.xyz,s,i),v=$(.9),_=k(rn(n.xyz,y,v),1);tp(Sr.$.outputTexture,xt(t.x,t.y),_)}),{v:1,name:void 0,ast:{params:[{type:"d",props:[{name:"gid",alias:"gid"}]}],body:[0,[[13,"currentColor",[6,[7,"std","textureLoad"],[[7,[7,"taaResolveLayout","$"],"currentTexture"],[6,[7,"d","vec2u"],[[7,"gid","xy"]]],[5,"0"]]]],[13,"historyColor",[6,[7,"std","textureLoad"],[[7,[7,"taaResolveLayout","$"],"historyTexture"],[6,[7,"d","vec2u"],[[7,"gid","xy"]]],[5,"0"]]]],[12,"minColor",[6,[7,"d","vec3f"],[[5,"9999"]]]],[12,"maxColor",[6,[7,"d","vec3f"],[[4,"-",[5,"9999"]]]]],[13,"dimensions",[6,[7,"std","textureDimensions"],[[7,[7,"taaResolveLayout","$"],"currentTexture"]]]],[14,[12,"x",[4,"-",[5,"1"]]],[1,"x","<=",[5,"1"]],[102,"++","x"],[0,[[14,[12,"y",[4,"-",[5,"1"]]],[1,"y","<=",[5,"1"]],[102,"++","y"],[0,[[13,"sampleCoord",[6,[7,[6,[7,"d","vec2i"],[[7,"gid","xy"]]],"add"],[[6,[7,"d","vec2i"],["x","y"]]]]],[13,"clampedCoord",[6,[7,"std","clamp"],["sampleCoord",[6,[7,"d","vec2i"],[[5,"0"],[5,"0"]]],[6,[7,[6,[7,"d","vec2i"],[[7,"dimensions","xy"]]],"sub"],[[6,[7,"d","vec2i"],[[5,"1"]]]]]]]],[13,"neighborColor",[6,[7,"std","textureLoad"],[[7,[7,"taaResolveLayout","$"],"currentTexture"],"clampedCoord",[5,"0"]]]],[2,"minColor","=",[6,[7,"std","min"],["minColor",[7,"neighborColor","xyz"]]]],[2,"maxColor","=",[6,[7,"std","max"],["maxColor",[7,"neighborColor","xyz"]]]]]]]]]],[13,"historyColorClamped",[6,[7,"std","clamp"],[[7,"historyColor","xyz"],"minColor","maxColor"]]],[13,"blendFactor",[6,[7,"d","f32"],[[5,"0.9"]]]],[13,"resolvedColor",[6,[7,"d","vec4f"],[[6,[7,"std","mix"],[[7,"currentColor","xyz"],"historyColorClamped","blendFactor"]],[5,"1"]]]],[6,[7,"std","textureStore"],[[7,[7,"taaResolveLayout","$"],"outputTexture"],[6,[7,"d","vec2u"],[[7,"gid","x"],[7,"gid","y"]]],"resolvedColor"]]]],externalNames:["std","taaResolveLayout","d"]},get externals(){return{std:De,taaResolveLayout:Sr,d:de}}})&&e.f)({})),"taaResolveFn");function pl(e,t,n){return[0,1].map(()=>{const r=(globalThis.__TYPEGPU_AUTONAME__??(s=>s))(e["~unstable"].createTexture({size:[t,n],format:"rgba8unorm"}).$usage("storage","sampled"),"texture");return{write:r.createView(ri("rgba8unorm")),sampled:r.createView()}})}class m2{#e;#t;#n;#r;#s;constructor(t,n,r){this.#n=t,this.#r=n,this.#s=r,this.#e=t["~unstable"].withCompute(f2).createPipeline(),this.#t=pl(t,n,r)}resolve(t,n,r){const s=1-r;return this.#e.with(this.#n.createBindGroup(Sr,{currentTexture:t,historyTexture:n===1?t:this.#t[s].sampled,outputTexture:this.#t[r].write})).dispatchWorkgroups(Math.ceil(this.#r/16),Math.ceil(this.#s/16)),this.#t[r].sampled}resize(t,n){this.#r=t,this.#s=n,this.#t=pl(this.#n,t,n)}getResolvedTexture(t){return this.#t[t].sampled}}const mp=navigator.gpu.getPreferredCanvasFormat(),Zt=document.querySelector("canvas"),yp=Zt.getContext("webgpu"),He=await H.init({device:{optionalFeatures:["timestamp-query"]}}),y2=He.enabledFeatures.has("timestamp-query");yp.configure({device:He.device,format:mp,alphaMode:"premultiplied"});const bt=new Qx(He);await bt.init();let ds=.5,[Qn,Kn]=[Zt.width*ds,Zt.height*ds],oo=dp(He,Qn,Kn),Zo=fp(He,Qn,Kn);const dl=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(He["~unstable"].createSampler({magFilter:"linear",minFilter:"linear"}),"filteringSampler"),Ho=new d2(He,qx,O(0,0,0),O(0,1,0),Math.PI/4,Qn,Kn),Ma=Ho.cameraUniform,Ir=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(He.createUniform(Zx,{direction:an(O(.19,-.24,.75)),color:O(1,1,1)}),"lightUniform"),Xs=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(He.createUniform(k,k(1,.45,.075,1)),"jellyColorUniform"),Js=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(He.createUniform(J),"darkModeUniform"),uo=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(He.createUniform(G),"randomUniform"),fl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";const n=k(t.x,t.y,-1,1),r=Ma.$.viewInv,i=Ma.$.projInv.mul(n),p=k(i.xyz.div(i.w),1),y=r.mul(p),v=r.columns[3].xyz,_=an(y.xyz.sub(v));return el({origin:v,direction:_})}),{v:1,name:"getRay",ast:{params:[{type:"i",name:"ndc"}],body:[0,[[13,"clipPos",[6,[7,"d","vec4f"],[[7,"ndc","x"],[7,"ndc","y"],[4,"-",[5,"1"]],[5,"1"]]]],[13,"invView",[7,[7,"cameraUniform","$"],"viewInv"]],[13,"invProj",[7,[7,"cameraUniform","$"],"projInv"]],[13,"viewPos",[6,[7,"invProj","mul"],["clipPos"]]],[13,"viewPosNormalized",[6,[7,"d","vec4f"],[[6,[7,[7,"viewPos","xyz"],"div"],[[7,"viewPos","w"]]],[5,"1"]]]],[13,"worldPos",[6,[7,"invView","mul"],["viewPosNormalized"]]],[13,"rayOrigin",[7,[8,[7,"invView","columns"],[5,"3"]],"xyz"]],[13,"rayDir",[6,[7,"std","normalize"],[[6,[7,[7,"worldPos","xyz"],"sub"],["rayOrigin"]]]]],[10,[6,"Ray",[[104,{origin:"rayOrigin",direction:"rayDir"}]]]]]],externalNames:["d","cameraUniform","std","Ray"]},get externals(){return{d:de,cameraUniform:Ma,std:De,Ray:el}}})&&e.f)({}),ml=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(()=>{"use gpu";return tl({min:O(-1,-1,-1),max:O(.5,1,1)})}),{v:1,name:"getJellyBounds",ast:{params:[],body:[0,[[10,[6,"BoundingBox",[[104,{min:[6,[7,"d","vec3f"],[[4,"-",[5,"1"]],[4,"-",[5,"1"]],[4,"-",[5,"1"]]]],max:[6,[7,"d","vec3f"],[[5,"0.5"],[5,"1"],[5,"1"]]]}]]]]]],externalNames:["BoundingBox","d"]},get externals(){return{BoundingBox:tl,d:de}}})&&e.f)({}),fr={groundThickness:.03,groundRadius:.3,groundRoundness:.02},Xi=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";const n=fr.groundRoundness,r=fr.groundRadius;return Te(t)-(r+n)}),{v:1,name:"circleCutoutDist",ast:{params:[{type:"i",name:"position"}],body:[0,[[13,"groundRoundness",[7,"GroundParams","groundRoundness"]],[13,"groundRadius",[7,"GroundParams","groundRadius"]],[10,[1,[6,[7,"std","length"],["position"]],"-",[1,"groundRadius","+","groundRoundness"]]]]],externalNames:["GroundParams","std"]},get externals(){return{GroundParams:fr,std:De}}})&&e.f)({}),vr=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";const n=fr.groundThickness,r=fr.groundRoundness;return sp(ap(t,O(0,1,0),.06),rp(t,-Xi(t.xz),n-r)-r)}),{v:1,name:"getMainSceneDist",ast:{params:[{type:"i",name:"position"}],body:[0,[[13,"groundThickness",[7,"GroundParams","groundThickness"]],[13,"groundRoundness",[7,"GroundParams","groundRoundness"]],[10,[6,[7,"sdf","opUnion"],[[6,[7,"sdf","sdPlane"],["position",[6,[7,"d","vec3f"],[[5,"0"],[5,"1"],[5,"0"]]],[5,"0.06"]]],[1,[6,[7,"sdf","opExtrudeY"],["position",[4,"-",[6,"circleCutoutDist",[[7,"position","xz"]]]],[1,"groundThickness","-","groundRoundness"]]],"-","groundRoundness"]]]]]],externalNames:["GroundParams","sdf","d","circleCutoutDist"]},get externals(){return{GroundParams:fr,sdf:op,d:de,circleCutoutDist:Xi}}})&&e.f)({}),yl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";const r=Ft(n*t.x),s=un(n*t.x),i=xn(r,-s,s,r);return O(i.mul(t.xy),t.z)}),{v:1,name:"opCheapBend",ast:{params:[{type:"i",name:"p"},{type:"i",name:"k"}],body:[0,[[13,"c",[6,[7,"std","cos"],[[1,"k","*",[7,"p","x"]]]]],[13,"s",[6,[7,"std","sin"],[[1,"k","*",[7,"p","x"]]]]],[13,"m",[6,[7,"d","mat2x2f"],["c",[4,"-","s"],"s","c"]]],[10,[6,[7,"d","vec3f"],[[6,[7,"m","mul"],[[7,"p","xy"]]],[7,"p","z"]]]]]],externalNames:["std","d"]},get externals(){return{std:De,d:de}}})&&e.f)({}),gl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{"use gpu";return ue(rn(n.mul(ae(t,n)),t,Ft(r)),Dc(t,n).mul(un(r)))}),{v:1,name:"opRotateAxisAngle",ast:{params:[{type:"i",name:"p"},{type:"i",name:"axis"},{type:"i",name:"angle"}],body:[0,[[10,[6,[7,"std","add"],[[6,[7,"std","mix"],[[6,[7,"axis","mul"],[[6,[7,"std","dot"],["p","axis"]]]],"p",[6,[7,"std","cos"],["angle"]]]],[6,[7,[6,[7,"std","cross"],["p","axis"]],"mul"],[[6,[7,"std","sin"],["angle"]]]]]]]]],externalNames:["std"]},get externals(){return{std:De}}})&&e.f)({}),Ji=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";const n=bt.stateUniform.$,r=O(n.baseCenterX,.7,-n.baseCenterY),s=t.sub(r),i=jt((s.y+cs.y)/(cs.y*2)),p=O(n.posX*i/15,n.posY*i/-18,n.posZ*i/15),y=s.sub(p),v=O(1,1,1/(1-n.squashZ*.5+.001)),_=y.mul(v),P=gl(_,O(0,0,1),n.wiggleX);return ip(yl(P,.2),cs.sub(.1),.1)}),{v:1,name:"getJellyDist",ast:{params:[{type:"i",name:"position"}],body:[0,[[13,"state",[7,[7,"buttonBehavior","stateUniform"],"$"]],[13,"baseCenter",[6,[7,"d","vec3f"],[[7,"state","baseCenterX"],[5,"0.7"],[4,"-",[7,"state","baseCenterY"]]]]],[13,"localToBase",[6,[7,"position","sub"],["baseCenter"]]],[13,"heightFactor",[6,[7,"std","saturate"],[[1,[1,[7,"localToBase","y"],"+",[7,"JELLY_HALFSIZE","y"]],"/",[1,[7,"JELLY_HALFSIZE","y"],"*",[5,"2"]]]]]],[13,"displacement",[6,[7,"d","vec3f"],[[1,[1,[7,"state","posX"],"*","heightFactor"],"/",[5,"15"]],[1,[1,[7,"state","posY"],"*","heightFactor"],"/",[4,"-",[5,"18"]]],[1,[1,[7,"state","posZ"],"*","heightFactor"],"/",[5,"15"]]]]],[13,"displacedPos",[6,[7,"localToBase","sub"],["displacement"]]],[13,"jellyInvScale",[6,[7,"d","vec3f"],[[5,"1"],[5,"1"],[1,[5,"1"],"/",[1,[1,[5,"1"],"-",[1,[7,"state","squashZ"],"*",[5,"0.5"]]],"+",[5,"0.001"]]]]]],[13,"scaledPos",[6,[7,"displacedPos","mul"],["jellyInvScale"]]],[13,"localPos",[6,"opRotateAxisAngle",["scaledPos",[6,[7,"d","vec3f"],[[5,"0"],[5,"0"],[5,"1"]]],[7,"state","wiggleX"]]]],[10,[6,[7,"sdf","sdRoundedBox3d"],[[6,"opCheapBend",["localPos",[5,"0.2"]]],[6,[7,"JELLY_HALFSIZE","sub"],[[5,"0.1"]]],[5,"0.1"]]]]]],externalNames:["buttonBehavior","d","std","JELLY_HALFSIZE","opRotateAxisAngle","sdf","opCheapBend"]},get externals(){return{buttonBehavior:bt,d:de,std:De,JELLY_HALFSIZE:cs,opRotateAxisAngle:gl,sdf:op,opCheapBend:yl}}})&&e.f)({}),Ur=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";const n=vr(t),r=Ji(t),s=Qu();return r<n?(s.distance=r,s.objectType=Rs.SLIDER):(s.distance=n,s.objectType=Rs.BACKGROUND),s}),{v:1,name:"getSceneDist",ast:{params:[{type:"i",name:"position"}],body:[0,[[13,"mainScene",[6,"getMainSceneDist",["position"]]],[13,"jelly",[6,"getJellyDist",["position"]]],[13,"hitInfo",[6,"HitInfo",[]]],[11,[1,"jelly","<","mainScene"],[0,[[2,[7,"hitInfo","distance"],"=","jelly"],[2,[7,"hitInfo","objectType"],"=",[7,"ObjectType","SLIDER"]]]],[0,[[2,[7,"hitInfo","distance"],"=","mainScene"],[2,[7,"hitInfo","objectType"],"=",[7,"ObjectType","BACKGROUND"]]]]],[10,"hitInfo"]]],externalNames:["getMainSceneDist","getJellyDist","HitInfo","ObjectType"]},get externals(){return{getMainSceneDist:vr,getJellyDist:Ji,HitInfo:Qu,ObjectType:Rs}}})&&e.f)({}),wl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";const n=vr(t),r=Ji(t);return pe(n,r)}),{v:1,name:"getSceneDistForAO",ast:{params:[{type:"i",name:"position"}],body:[0,[[13,"mainScene",[6,"getMainSceneDist",["position"]]],[13,"jelly",[6,"getJellyDist",["position"]]],[10,[6,[7,"std","min"],["mainScene","jelly"]]]]],externalNames:["getMainSceneDist","getJellyDist","std"]},get externals(){return{getMainSceneDist:vr,getJellyDist:Ji,std:De}}})&&e.f)({}),xl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";const r=Ur(t).distance,s=O(Ur(ue(t,O(n,0,0))).distance-r,Ur(ue(t,O(0,n,0))).distance-r,Ur(ue(t,O(0,0,n))).distance-r);return an(s)}),{v:1,name:"getApproxNormal",ast:{params:[{type:"i",name:"p"},{type:"i",name:"e"}],body:[0,[[13,"dist",[7,[6,"getSceneDist",["p"]],"distance"]],[13,"n",[6,[7,"d","vec3f"],[[1,[7,[6,"getSceneDist",[[6,[7,"std","add"],["p",[6,[7,"d","vec3f"],["e",[5,"0"],[5,"0"]]]]]]],"distance"],"-","dist"],[1,[7,[6,"getSceneDist",[[6,[7,"std","add"],["p",[6,[7,"d","vec3f"],[[5,"0"],"e",[5,"0"]]]]]]],"distance"],"-","dist"],[1,[7,[6,"getSceneDist",[[6,[7,"std","add"],["p",[6,[7,"d","vec3f"],[[5,"0"],[5,"0"],"e"]]]]]],"distance"],"-","dist"]]]],[10,[6,[7,"std","normalize"],["n"]]]]],externalNames:["getSceneDist","d","std"]},get externals(){return{getSceneDist:Ur,d:de,std:De}}})&&e.f)({}),Zi=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";return Je(t.z)>.5||Je(t.x)>.6?O(0,1,0):xl(t,1e-4)}),{v:1,name:"getNormal",ast:{params:[{type:"i",name:"position"}],body:[0,[[11,[3,[1,[6,[7,"std","abs"],[[7,"position","z"]]],">",[5,"0.5"]],"||",[1,[6,[7,"std","abs"],[[7,"position","x"]]],">",[5,"0.6"]]],[0,[[10,[6,[7,"d","vec3f"],[[5,"0"],[5,"1"],[5,"0"]]]]]]],[10,[6,"getApproxNormal",["position",[5,"0.0001"]]]]]],externalNames:["std","d","getApproxNormal"]},get externals(){return{std:De,d:de,getApproxNormal:xl}}})&&e.f)({}),vl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";return ae(t,t)}),{v:1,name:"sqLength",ast:{params:[{type:"i",name:"a"}],body:[0,[[10,[6,[7,"std","dot"],["a","a"]]]]],externalNames:["std"]},get externals(){return{std:De}}})&&e.f)({}),bl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";if(t.y<-fr.groundThickness){const i=Xi(t.xz)+.02,p=jt(1-i*30),y=jt(-t.z*4*n.z+1);return O(1).mul(p).mul(y*.5)}return O(1)}),{v:1,name:"getFakeShadow",ast:{params:[{type:"i",name:"position"},{type:"i",name:"lightDir"}],body:[0,[[11,[1,[7,"position","y"],"<",[4,"-",[7,"GroundParams","groundThickness"]]],[0,[[13,"fadeSharpness",[5,"30"]],[13,"inset",[5,"0.02"]],[13,"cutout",[1,[6,"circleCutoutDist",[[7,"position","xz"]]],"+","inset"]],[13,"edgeDarkening",[6,[7,"std","saturate"],[[1,[5,"1"],"-",[1,"cutout","*","fadeSharpness"]]]]],[13,"lightGradient",[6,[7,"std","saturate"],[[1,[1,[1,[4,"-",[7,"position","z"]],"*",[5,"4"]],"*",[7,"lightDir","z"]],"+",[5,"1"]]]]],[10,[6,[7,[6,[7,[6,[7,"d","vec3f"],[[5,"1"]]],"mul"],["edgeDarkening"]],"mul"],[[1,"lightGradient","*",[5,"0.5"]]]]]]]],[10,[6,[7,"d","vec3f"],[[5,"1"]]]]]],externalNames:["GroundParams","circleCutoutDist","std","d"]},get externals(){return{GroundParams:fr,circleCutoutDist:Xi,std:De,d:de}}})&&e.f)({}),Tl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";let r=$(0),s=$(1);const i=$i/Ta;for(let y=1;y<=Ta;y++){const v=i*$(y),_=t.add(n.mul(v)),P=wl(_)-Hu,U=re(0,v-P);if(r+=U*s,s*=.5,r>$i/_a)break}const p=1-_a*r/$i;return jt(p)}),{v:1,name:"calculateAO",ast:{params:[{type:"i",name:"position"},{type:"i",name:"normal"}],body:[0,[[12,"totalOcclusion",[6,[7,"d","f32"],[[5,"0"]]]],[12,"sampleWeight",[6,[7,"d","f32"],[[5,"1"]]]],[13,"stepDistance",[1,"AO_RADIUS","/","AO_STEPS"]],[14,[12,"i",[5,"1"]],[1,"i","<=","AO_STEPS"],[102,"++","i"],[0,[[13,"sampleHeight",[1,"stepDistance","*",[6,[7,"d","f32"],["i"]]]],[13,"samplePosition",[6,[7,"position","add"],[[6,[7,"normal","mul"],["sampleHeight"]]]]],[13,"distanceToSurface",[1,[6,"getSceneDistForAO",["samplePosition"]],"-","AO_BIAS"]],[13,"occlusionContribution",[6,[7,"std","max"],[[5,"0"],[1,"sampleHeight","-","distanceToSurface"]]]],[2,"totalOcclusion","+=",[1,"occlusionContribution","*","sampleWeight"]],[2,"sampleWeight","*=",[5,"0.5"]],[11,[1,"totalOcclusion",">",[1,"AO_RADIUS","/","AO_INTENSITY"]],[0,[[17]]]]]]],[13,"rawAO",[1,[5,"1"],"-",[1,[1,"AO_INTENSITY","*","totalOcclusion"],"/","AO_RADIUS"]]],[10,[6,[7,"std","saturate"],["rawAO"]]]]],externalNames:["d","AO_RADIUS","AO_STEPS","getSceneDistForAO","AO_BIAS","std","AO_INTENSITY"]},get externals(){return{d:de,AO_RADIUS:$i,AO_STEPS:Ta,getSceneDistForAO:wl,AO_BIAS:Hu,std:De,AO_INTENSITY:_a}}})&&e.f)({}),_l=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{"use gpu";const s=js(Ir.$.direction),i=bl(t,s),p=re(ae(n,s),0),y=an(r.sub(t)),v=Nc(js(s),n),_=re(ae(y,v),0)**Xu,P=Ir.$.color.mul(_*Ju),U=O(.9),N=U.mul(Ir.$.color).mul(p).mul(i),j=U.mul(qu).mul(Wu),L=P.mul(i);return jt(N.add(j).add(L))}),{v:1,name:"calculateLighting",ast:{params:[{type:"i",name:"hitPosition"},{type:"i",name:"normal"},{type:"i",name:"rayOrigin"}],body:[0,[[13,"lightDir",[6,[7,"std","neg"],[[7,[7,"lightUniform","$"],"direction"]]]],[13,"fakeShadow",[6,"getFakeShadow",["hitPosition","lightDir"]]],[13,"diffuse",[6,[7,"std","max"],[[6,[7,"std","dot"],["normal","lightDir"]],[5,"0"]]]],[13,"viewDir",[6,[7,"std","normalize"],[[6,[7,"rayOrigin","sub"],["hitPosition"]]]]],[13,"reflectDir",[6,[7,"std","reflect"],[[6,[7,"std","neg"],["lightDir"]],"normal"]]],[13,"specularFactor",[1,[6,[7,"std","max"],[[6,[7,"std","dot"],["viewDir","reflectDir"]],[5,"0"]]],"**","SPECULAR_POWER"]],[13,"specular",[6,[7,[7,[7,"lightUniform","$"],"color"],"mul"],[[1,"specularFactor","*","SPECULAR_INTENSITY"]]]],[13,"baseColor",[6,[7,"d","vec3f"],[[5,"0.9"]]]],[13,"directionalLight",[6,[7,[6,[7,[6,[7,"baseColor","mul"],[[7,[7,"lightUniform","$"],"color"]]],"mul"],["diffuse"]],"mul"],["fakeShadow"]]],[13,"ambientLight",[6,[7,[6,[7,"baseColor","mul"],["AMBIENT_COLOR"]],"mul"],["AMBIENT_INTENSITY"]]],[13,"finalSpecular",[6,[7,"specular","mul"],["fakeShadow"]]],[10,[6,[7,"std","saturate"],[[6,[7,[6,[7,"directionalLight","add"],["ambientLight"]],"add"],["finalSpecular"]]]]]]],externalNames:["std","lightUniform","getFakeShadow","SPECULAR_POWER","SPECULAR_INTENSITY","d","AMBIENT_COLOR","AMBIENT_INTENSITY"]},get externals(){return{std:De,lightUniform:Ir,getFakeShadow:bl,SPECULAR_POWER:Xu,SPECULAR_INTENSITY:Ju,d:de,AMBIENT_COLOR:qu,AMBIENT_INTENSITY:Wu}}})&&e.f)({}),$l=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{"use gpu";const s=Tl(n,r),i=t.mul(s);return k(i,1)}),{v:1,name:"applyAO",ast:{params:[{type:"i",name:"litColor"},{type:"i",name:"hitPosition"},{type:"i",name:"normal"}],body:[0,[[13,"ao",[6,"calculateAO",["hitPosition","normal"]]],[13,"finalColor",[6,[7,"litColor","mul"],["ao"]]],[10,[6,[7,"d","vec4f"],["finalColor",[5,"1"]]]]]],externalNames:["calculateAO","d"]},get externals(){return{calculateAO:Tl,d:de}}})&&e.f)({}),Ml=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";let r=$(),s=$();for(let i=0;i<6;i++){const p=t.add(n.mul(r));if(s=vr(p),r+=s,r>va||s<cr*10)break}return r<va?Hi(t,n,r).xyz:O()}),{v:1,name:"rayMarchNoJelly",ast:{params:[{type:"i",name:"rayOrigin"},{type:"i",name:"rayDirection"}],body:[0,[[12,"distanceFromOrigin",[6,[7,"d","f32"],[]]],[12,"hit",[6,[7,"d","f32"],[]]],[14,[12,"i",[5,"0"]],[1,"i","<",[5,"6"]],[102,"++","i"],[0,[[13,"p",[6,[7,"rayOrigin","add"],[[6,[7,"rayDirection","mul"],["distanceFromOrigin"]]]]],[2,"hit","=",[6,"getMainSceneDist",["p"]]],[2,"distanceFromOrigin","+=","hit"],[11,[3,[1,"distanceFromOrigin",">","MAX_DIST"],"||",[1,"hit","<",[1,"SURF_DIST","*",[5,"10"]]]],[0,[[17]]]]]]],[11,[1,"distanceFromOrigin","<","MAX_DIST"],[0,[[10,[7,[6,"renderBackground",["rayOrigin","rayDirection","distanceFromOrigin"]],"xyz"]]]]],[10,[6,[7,"d","vec3f"],[]]]]],externalNames:["d","getMainSceneDist","MAX_DIST","SURF_DIST","renderBackground"]},get externals(){return{d:de,getMainSceneDist:vr,MAX_DIST:va,SURF_DIST:cr,renderBackground:Hi}}})&&e.f)({}),Hi=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{"use gpu";const s=bt.stateUniform.$,i=t.add(n.mul(r)),p=Zi(i),y=Xs.$,v=vl(i.sub(O(0,0,0))),_=y.xyz.mul(1/(v*15+1)*.4),P=y.xyz.mul(1/(v*40+1)*.3).mul(Je(p.z)),U=Fc(.7,1,s.posY)*2+.7,N=_l(i,p,t),j=$l(Cs(Yu,Cu,Js.$===1).mul(N),i,p).add(k(_.mul(U),0)).add(k(P.mul(U),0));return k(j.xyz,1)}),{v:1,name:"renderBackground",ast:{params:[{type:"i",name:"rayOrigin"},{type:"i",name:"rayDirection"},{type:"i",name:"backgroundHitDist"}],body:[0,[[13,"state",[7,[7,"buttonBehavior","stateUniform"],"$"]],[13,"hitPosition",[6,[7,"rayOrigin","add"],[[6,[7,"rayDirection","mul"],["backgroundHitDist"]]]]],[13,"newNormal",[6,"getNormal",["hitPosition"]]],[13,"jellyColor",[7,"jellyColorUniform","$"]],[13,"sqDist",[6,"sqLength",[[6,[7,"hitPosition","sub"],[[6,[7,"d","vec3f"],[[5,"0"],[5,"0"],[5,"0"]]]]]]]],[13,"bounceLight",[6,[7,[7,"jellyColor","xyz"],"mul"],[[1,[1,[5,"1"],"/",[1,[1,"sqDist","*",[5,"15"]],"+",[5,"1"]]],"*",[5,"0.4"]]]]],[13,"sideBounceLight",[6,[7,[6,[7,[7,"jellyColor","xyz"],"mul"],[[1,[1,[5,"1"],"/",[1,[1,"sqDist","*",[5,"40"]],"+",[5,"1"]]],"*",[5,"0.3"]]]],"mul"],[[6,[7,"std","abs"],[[7,"newNormal","z"]]]]]],[13,"emission",[1,[1,[6,[7,"std","smoothstep"],[[5,"0.7"],[5,"1"],[7,"state","posY"]]],"*",[5,"2"]],"+",[5,"0.7"]]],[13,"litColor",[6,"calculateLighting",["hitPosition","newNormal","rayOrigin"]]],[13,"backgroundColor",[6,[7,[6,[7,[6,"applyAO",[[6,[7,[6,[7,"std","select"],["LIGHT_GROUND_ALBEDO","DARK_GROUND_ALBEDO",[1,[7,"darkModeUniform","$"],"==",[5,"1"]]]],"mul"],["litColor"]],"hitPosition","newNormal"]],"add"],[[6,[7,"d","vec4f"],[[6,[7,"bounceLight","mul"],["emission"]],[5,"0"]]]]],"add"],[[6,[7,"d","vec4f"],[[6,[7,"sideBounceLight","mul"],["emission"]],[5,"0"]]]]]],[10,[6,[7,"d","vec4f"],[[7,"backgroundColor","xyz"],[5,"1"]]]]]],externalNames:["buttonBehavior","getNormal","jellyColorUniform","sqLength","d","std","calculateLighting","applyAO","LIGHT_GROUND_ALBEDO","DARK_GROUND_ALBEDO","darkModeUniform"]},get externals(){return{buttonBehavior:bt,getNormal:Zi,jellyColorUniform:Xs,sqLength:vl,d:de,std:De,calculateLighting:_l,applyAO:$l,LIGHT_GROUND_ALBEDO:Yu,DARK_GROUND_ALBEDO:Cu,darkModeUniform:Js}}})&&e.f)({}),zl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n,r)=>{"use gpu";let s=J(),i=$();for(let P=0;P<_i;P++){const U=t.add(n.mul(i)),N=vr(U);if(i+=N,N<cr)break}const p=Hi(t,n,i),y=ml(),v=hl(t,n,y);if(!v.hit)return p;let _=re($(0),v.tMin);for(let P=0;P<_i&&!(s>=_i);P++){const U=t.add(n.mul(_)),N=Ur(U);if(_+=N.distance,s++,N.distance<cr){const j=t.add(n.mul(_));if(N.objectType!==Rs.SLIDER)break;const L=Zi(j),Z=n,Q=pe(1,re(0,ae(js(Z),L))),se=ll(Q,$(1),$(ba)),ze=jt(O(j.y+.2)),oe=1/ba,_e=1-oe*oe*(1-Q*Q);let Ee=O();if(_e>0){const Ue=an(ue(Z.mul(oe),L.mul(oe*Q-gn(_e)))),ht=j.add(Ue.mul(cr*2)).add(Ue.mul(cr*2)),it=Ml(ht,Ue),Ct=Xs.$,_t=Ct.xyz.mul(1.5),Ht=$(20),gt=O(1).sub(Ct.xyz).mul(Ht),Se=bt.stateUniform.$,$e=jt(rn(1,.6,j.y*(1/(cs.y*2))+.25))*(1-Se.posY*.5),xe=cl(gt.mul($e**2),.08),$t=js(Ir.$.direction),Qt=re(0,ae($t,Ue)),je=_t.mul(Zu*Qt*$e**3);Ee=it.mul(xe).add(je)}const Pe=ue(ze.mul(se),Ee.mul(1-se));return k(Pe,1)}if(_>i)break}return p}),{v:1,name:"rayMarch",ast:{params:[{type:"i",name:"rayOrigin"},{type:"i",name:"rayDirection"},{type:"i",name:"_uv"}],body:[0,[[12,"totalSteps",[6,[7,"d","u32"],[]]],[12,"backgroundDist",[6,[7,"d","f32"],[]]],[14,[12,"i",[5,"0"]],[1,"i","<","MAX_STEPS"],[102,"++","i"],[0,[[13,"p",[6,[7,"rayOrigin","add"],[[6,[7,"rayDirection","mul"],["backgroundDist"]]]]],[13,"hit",[6,"getMainSceneDist",["p"]]],[2,"backgroundDist","+=","hit"],[11,[1,"hit","<","SURF_DIST"],[0,[[17]]]]]]],[13,"background",[6,"renderBackground",["rayOrigin","rayDirection","backgroundDist"]]],[13,"bbox",[6,"getJellyBounds",[]]],[13,"intersection",[6,"intersectBox",["rayOrigin","rayDirection","bbox"]]],[11,[4,"!",[7,"intersection","hit"]],[0,[[10,"background"]]]],[12,"distanceFromOrigin",[6,[7,"std","max"],[[6,[7,"d","f32"],[[5,"0"]]],[7,"intersection","tMin"]]]],[14,[12,"i",[5,"0"]],[1,"i","<","MAX_STEPS"],[102,"++","i"],[0,[[11,[1,"totalSteps",">=","MAX_STEPS"],[0,[[17]]]],[13,"currentPosition",[6,[7,"rayOrigin","add"],[[6,[7,"rayDirection","mul"],["distanceFromOrigin"]]]]],[13,"hitInfo",[6,"getSceneDist",["currentPosition"]]],[2,"distanceFromOrigin","+=",[7,"hitInfo","distance"]],[102,"++","totalSteps"],[11,[1,[7,"hitInfo","distance"],"<","SURF_DIST"],[0,[[13,"hitPosition",[6,[7,"rayOrigin","add"],[[6,[7,"rayDirection","mul"],["distanceFromOrigin"]]]]],[11,[4,"!",[1,[7,"hitInfo","objectType"],"==",[7,"ObjectType","SLIDER"]]],[0,[[17]]]],[13,"N",[6,"getNormal",["hitPosition"]]],[13,"I","rayDirection"],[13,"cosi",[6,[7,"std","min"],[[5,"1"],[6,[7,"std","max"],[[5,"0"],[6,[7,"std","dot"],[[6,[7,"std","neg"],["I"]],"N"]]]]]]],[13,"F",[6,"fresnelSchlick",["cosi",[6,[7,"d","f32"],[[5,"1"]]],[6,[7,"d","f32"],["JELLY_IOR"]]]]],[13,"reflection",[6,[7,"std","saturate"],[[6,[7,"d","vec3f"],[[1,[7,"hitPosition","y"],"+",[5,"0.2"]]]]]]],[13,"eta",[1,[5,"1"],"/","JELLY_IOR"]],[13,"k",[1,[5,"1"],"-",[1,[1,"eta","*","eta"],"*",[1,[5,"1"],"-",[1,"cosi","*","cosi"]]]]],[12,"refractedColor",[6,[7,"d","vec3f"],[]]],[11,[1,"k",">",[5,"0"]],[0,[[13,"refrDir",[6,[7,"std","normalize"],[[6,[7,"std","add"],[[6,[7,"I","mul"],["eta"]],[6,[7,"N","mul"],[[1,[1,"eta","*","cosi"],"-",[6,[7,"std","sqrt"],["k"]]]]]]]]]],[13,"p",[6,[7,"hitPosition","add"],[[6,[7,"refrDir","mul"],[[1,"SURF_DIST","*",[5,"2"]]]]]]],[13,"exitPos",[6,[7,"p","add"],[[6,[7,"refrDir","mul"],[[1,"SURF_DIST","*",[5,"2"]]]]]]],[13,"env",[6,"rayMarchNoJelly",["exitPos","refrDir"]]],[13,"jellyColor",[7,"jellyColorUniform","$"]],[13,"scatterTint",[6,[7,[7,"jellyColor","xyz"],"mul"],[[5,"1.5"]]]],[13,"density",[6,[7,"d","f32"],[[5,"20"]]]],[13,"absorb",[6,[7,[6,[7,[6,[7,"d","vec3f"],[[5,"1"]]],"sub"],[[7,"jellyColor","xyz"]]],"mul"],["density"]]],[13,"state",[7,[7,"buttonBehavior","stateUniform"],"$"]],[13,"progress",[1,[6,[7,"std","saturate"],[[6,[7,"std","mix"],[[5,"1"],[5,"0.6"],[1,[1,[7,"hitPosition","y"],"*",[1,[5,"1"],"/",[1,[7,"JELLY_HALFSIZE","y"],"*",[5,"2"]]]],"+",[5,"0.25"]]]]]],"*",[1,[5,"1"],"-",[1,[7,"state","posY"],"*",[5,"0.5"]]]]],[13,"T",[6,"beerLambert",[[6,[7,"absorb","mul"],[[1,"progress","**",[5,"2"]]]],[5,"0.08"]]]],[13,"lightDir",[6,[7,"std","neg"],[[7,[7,"lightUniform","$"],"direction"]]]],[13,"forward",[6,[7,"std","max"],[[5,"0"],[6,[7,"std","dot"],["lightDir","refrDir"]]]]],[13,"scatter",[6,[7,"scatterTint","mul"],[[1,[1,"JELLY_SCATTER_STRENGTH","*","forward"],"*",[1,"progress","**",[5,"3"]]]]]],[2,"refractedColor","=",[6,[7,[6,[7,"env","mul"],["T"]],"add"],["scatter"]]]]]],[13,"jelly",[6,[7,"std","add"],[[6,[7,"reflection","mul"],["F"]],[6,[7,"refractedColor","mul"],[[1,[5,"1"],"-","F"]]]]]],[10,[6,[7,"d","vec4f"],["jelly",[5,"1"]]]]]]],[11,[1,"distanceFromOrigin",">","backgroundDist"],[0,[[17]]]]]]],[10,"background"]]],externalNames:["d","MAX_STEPS","getMainSceneDist","SURF_DIST","renderBackground","getJellyBounds","intersectBox","std","getSceneDist","ObjectType","getNormal","fresnelSchlick","JELLY_IOR","rayMarchNoJelly","jellyColorUniform","buttonBehavior","JELLY_HALFSIZE","beerLambert","lightUniform","JELLY_SCATTER_STRENGTH"]},get externals(){return{d:de,MAX_STEPS:_i,getMainSceneDist:vr,SURF_DIST:cr,renderBackground:Hi,getJellyBounds:ml,intersectBox:hl,std:De,getSceneDist:Ur,ObjectType:Rs,getNormal:Zi,fresnelSchlick:ll,JELLY_IOR:ba,rayMarchNoJelly:Ml,jellyColorUniform:Xs,buttonBehavior:bt,JELLY_HALFSIZE:cs,beerLambert:cl,lightUniform:Ir,JELLY_SCATTER_STRENGTH:Zu}}})&&e.f)({}),g2=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H["~unstable"].fragmentFn({in:{uv:G},out:k})((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(({uv:t})=>{ju.seed2(uo.$.mul(t));const n=G(t.x*2-1,-(t.y*2-1)),r=fl(n),s=zl(r.origin,r.direction,t),i=Cs(1.5,2,Js.$===1);return k(Lc(s.xyz.mul(i)),1)}),{v:1,name:void 0,ast:{params:[{type:"d",props:[{name:"uv",alias:"uv"}]}],body:[0,[[6,[7,"randf","seed2"],[[6,[7,[7,"randomUniform","$"],"mul"],["uv"]]]],[13,"ndc",[6,[7,"d","vec2f"],[[1,[1,[7,"uv","x"],"*",[5,"2"]],"-",[5,"1"]],[4,"-",[1,[1,[7,"uv","y"],"*",[5,"2"]],"-",[5,"1"]]]]]],[13,"ray",[6,"getRay",["ndc"]]],[13,"color",[6,"rayMarch",[[7,"ray","origin"],[7,"ray","direction"],"uv"]]],[13,"exposure",[6,[7,"std","select"],[[5,"1.5"],[5,"2"],[1,[7,"darkModeUniform","$"],"==",[5,"1"]]]]],[10,[6,[7,"d","vec4f"],[[6,[7,"std","tanh"],[[6,[7,[7,"color","xyz"],"mul"],["exposure"]]]],[5,"1"]]]]]],externalNames:["randf","randomUniform","d","getRay","rayMarch","std","darkModeUniform"]},get externals(){return{randf:ju,randomUniform:uo,d:de,getRay:fl,rayMarch:zl,std:De,darkModeUniform:Js}}})&&e.f)({})),"raymarchFn"),w2=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(H["~unstable"].fragmentFn({in:{uv:G},out:k})((e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>ep(ao.$.currentTexture,dl.$,t.uv)),{v:1,name:void 0,ast:{params:[{type:"i",name:"input"}],body:[0,[[10,[6,[7,"std","textureSample"],[[7,[7,"sampleLayout","$"],"currentTexture"],[7,"filteringSampler","$"],[7,"input","uv"]]]]]],externalNames:["std","sampleLayout","filteringSampler"]},get externals(){return{std:De,sampleLayout:ao,filteringSampler:dl}}})&&e.f)({})),"fragmentMain"),gp=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(He["~unstable"].withVertex(up,{}).withFragment(g2,{format:"rgba8unorm"}).createPipeline(),"rayMarchPipeline"),x2=(globalThis.__TYPEGPU_AUTONAME__??(e=>e))(He["~unstable"].withVertex(up,{}).withFragment(w2,{format:mp}).createPipeline(),"renderPipeline");let El=performance.now(),Bi=0;const Qo=new m2(He,Qn,Kn);function wp(){return{rayMarch:He.createBindGroup(hp,{backgroundTexture:Zo.sampled}),render:[0,1].map(e=>He.createBindGroup(ao,{currentTexture:Qo.getResolvedTexture(e)}))}}let xp=wp();function vp(e){Bi++,Ho.jitter();const t=Math.min((e-El)*.001,.1);El=e,uo.write(G((Math.random()-.5)*2,(Math.random()-.5)*2)),bt.update(t);const n=Bi%2;gp.withColorAttachment({view:He.unwrap(oo[n].sampled),loadOp:"clear",storeOp:"store"}).draw(3),Qo.resolve(oo[n].sampled,Bi,n),x2.withColorAttachment({view:yp.getCurrentTexture().createView(),loadOp:"clear",storeOp:"store"}).with(xp.render[n]).draw(3),requestAnimationFrame(vp)}function lo(){[Qn,Kn]=[Zt.width*ds,Zt.height*ds],Ho.updateProjection(Math.PI/4,Qn,Kn),oo=dp(He,Qn,Kn),Zo=fp(He,Qn,Kn),Qo.resize(Qn,Kn),Bi=0,xp=wp()}const bp=new ResizeObserver(()=>{lo()});bp.observe(Zt);requestAnimationFrame(vp);let qn=!1;Zt.addEventListener("touchstart",e=>{const t=e.touches[0];bt.startDrag(t.clientX,t.clientY),qn=!0,e.preventDefault()});Zt.addEventListener("touchmove",e=>{if(qn){const t=e.touches[0];bt.updateDrag(t.clientX,t.clientY),e.preventDefault()}});Zt.addEventListener("touchend",e=>{qn&&(bt.endDrag(),qn=!1),bt.pressed=!1});Zt.addEventListener("mousedown",e=>{bt.startDrag(e.clientX,e.clientY),qn=!0,e.preventDefault()});Zt.addEventListener("mousemove",e=>{qn&&bt.updateDrag(e.clientX,e.clientY)});Zt.addEventListener("mouseup",e=>{qn&&(bt.endDrag(),qn=!1),bt.pressed=!1,e.stopPropagation()});window.addEventListener("mouseup",()=>{qn&&(bt.endDrag(),qn=!1),bt.pressed=!1});async function v2(){if(!y2)return .5;const e=5,t=2;let n=.3,r=0;const s=gp.withPerformanceCallback((i,p)=>{r=Number(p-i)/1e6});for(let i=0;i<8;i++){const p=(globalThis.__TYPEGPU_AUTONAME__??(v=>v))(He["~unstable"].createTexture({size:[Zt.width*n,Zt.height*n],format:"rgba8unorm"}).$usage("render"),"testTexture");if(s.withColorAttachment({view:He.unwrap(p).createView(),loadOp:"clear",storeOp:"store"}).with(He.createBindGroup(hp,{backgroundTexture:Zo.sampled})).draw(3),await He.device.queue.onSubmittedWorkDone(),p.destroy(),Math.abs(r-e)<t)break;const y=r>e?-.1:.1;n=Math.max(.3,Math.min(1,n+y))}return console.log(`Auto-selected quality scale: ${n.toFixed(2)}`),n}const yv={Quality:{initial:"Auto",options:["Auto","Very Low","Low","Medium","High","Ultra"],onSelectChange:e=>{if(e==="Auto"){v2().then(n=>{ds=n,lo()});return}ds={"Very Low":.3,Low:.5,Medium:.7,High:.85,Ultra:1}[e]||.5,lo()}},"Light dir":{initial:0,min:0,max:1,step:.01,onSliderChange:e=>{const t=an(O(.18,-.3,.64)),n=an(O(-.5,-.14,-.8)),r=an(rn(t,n,e));Ir.writePartial({direction:r})}},"Jelly Color":{initial:[.08,.5,1],onColorChange:e=>{Xs.write(k(...e,1))}},"Dark Mode":{initial:!1,onToggleChange:e=>{Js.write(J(e))}}};function gv(){bp.disconnect(),He.destroy()}const Mn=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";const r=Je(t).sub(n);return Te(re(r,G(0,0)))+pe(re(r.x,r.y),10)}),{v:1,name:"sdBox2d",ast:{params:[{type:"i",name:"p"},{type:"i",name:"b"}],body:[0,[[13,"d0",[6,[7,[6,[7,"std","abs"],["p"]],"sub"],["b"]]],[10,[1,[6,[7,"std","length"],[[6,[7,"std","max"],["d0",[6,[7,"d","vec2f"],[[5,"0"],[5,"0"]]]]]]],"+",[6,[7,"std","min"],[[6,[7,"std","max"],[[7,"d0","x"],[7,"d0","y"]]],[5,"10"]]]]]]],externalNames:["std","d"]},get externals(){return{std:De,d:de}}})&&e.f)({}),za=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";const r=t.div(n),s=Mn(r.sub(G(0,-.05)),G(.07,.3)),i=Mn(r.sub(G(0,.27)),G(.22,.08));return pe(s,i)*n}),{v:1,name:"sdLetterT",ast:{params:[{type:"i",name:"p"},{type:"i",name:"scale"}],body:[0,[[13,"pos",[6,[7,"p","div"],["scale"]]],[13,"bar",[6,"sdBox2d",[[6,[7,"pos","sub"],[[6,[7,"d","vec2f"],[[5,"0"],[4,"-",[5,"0.05"]]]]]],[6,[7,"d","vec2f"],[[5,"0.07"],[5,"0.3"]]]]]],[13,"top",[6,"sdBox2d",[[6,[7,"pos","sub"],[[6,[7,"d","vec2f"],[[5,"0"],[5,"0.27"]]]]],[6,[7,"d","vec2f"],[[5,"0.22"],[5,"0.08"]]]]]],[10,[1,[6,[7,"std","min"],["bar","top"]],"*","scale"]]]],externalNames:["sdBox2d","d","std"]},get externals(){return{sdBox2d:Mn,d:de,std:De}}})&&e.f)({}),Sl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";const r=t.div(n),s=.6,i=Mn(G(r.x*s+r.y*s,r.y*s-r.x*s),G(.07,.32)),p=Mn(G(r.x*s-r.y*s,r.x*s+r.y*s),G(.07,.32));return pe(i,p)*n}),{v:1,name:"sdLetterX",ast:{params:[{type:"i",name:"p"},{type:"i",name:"scale"}],body:[0,[[13,"pos",[6,[7,"p","div"],["scale"]]],[13,"angleMult",[5,"0.6"]],[13,"diag1",[6,"sdBox2d",[[6,[7,"d","vec2f"],[[1,[1,[7,"pos","x"],"*","angleMult"],"+",[1,[7,"pos","y"],"*","angleMult"]],[1,[1,[7,"pos","y"],"*","angleMult"],"-",[1,[7,"pos","x"],"*","angleMult"]]]],[6,[7,"d","vec2f"],[[5,"0.07"],[5,"0.32"]]]]]],[13,"diag2",[6,"sdBox2d",[[6,[7,"d","vec2f"],[[1,[1,[7,"pos","x"],"*","angleMult"],"-",[1,[7,"pos","y"],"*","angleMult"]],[1,[1,[7,"pos","x"],"*","angleMult"],"+",[1,[7,"pos","y"],"*","angleMult"]]]],[6,[7,"d","vec2f"],[[5,"0.07"],[5,"0.32"]]]]]],[10,[1,[6,[7,"std","min"],["diag1","diag2"]],"*","scale"]]]],externalNames:["sdBox2d","d","std"]},get externals(){return{sdBox2d:Mn,d:de,std:De}}})&&e.f)({}),Pl=(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=((t,n)=>{"use gpu";const r=t.div(n),s=Mn(r.sub(G(-.12,0)),G(.08,.35)),i=Mn(r.sub(G(.05,.27)),G(.17,.08)),p=Mn(r.sub(G(.03,0)),G(.15,.08)),y=Mn(r.sub(G(.05,-.27)),G(.17,.08));return pe(pe(pe(s,i),p),y)*n}),{v:1,name:"sdLetterE",ast:{params:[{type:"i",name:"p"},{type:"i",name:"scale"}],body:[0,[[13,"pos",[6,[7,"p","div"],["scale"]]],[13,"bar",[6,"sdBox2d",[[6,[7,"pos","sub"],[[6,[7,"d","vec2f"],[[4,"-",[5,"0.12"]],[5,"0"]]]]],[6,[7,"d","vec2f"],[[5,"0.08"],[5,"0.35"]]]]]],[13,"top",[6,"sdBox2d",[[6,[7,"pos","sub"],[[6,[7,"d","vec2f"],[[5,"0.05"],[5,"0.27"]]]]],[6,[7,"d","vec2f"],[[5,"0.17"],[5,"0.08"]]]]]],[13,"middle",[6,"sdBox2d",[[6,[7,"pos","sub"],[[6,[7,"d","vec2f"],[[5,"0.03"],[5,"0"]]]]],[6,[7,"d","vec2f"],[[5,"0.15"],[5,"0.08"]]]]]],[13,"bottom",[6,"sdBox2d",[[6,[7,"pos","sub"],[[6,[7,"d","vec2f"],[[5,"0.05"],[4,"-",[5,"0.27"]]]]]],[6,[7,"d","vec2f"],[[5,"0.17"],[5,"0.08"]]]]]],[10,[1,[6,[7,"std","min"],[[6,[7,"std","min"],[[6,[7,"std","min"],["bar","top"]],"middle"]],"bottom"]],"*","scale"]]]],externalNames:["sdBox2d","d","std"]},get externals(){return{sdBox2d:Mn,d:de,std:De}}})&&e.f)({});(e=>(globalThis.__TYPEGPU_META__??=new WeakMap).set(e.f=(t=>{"use gpu";const n=G(t.x,-t.y),r=.45,s=.25,i=za(n.sub(G(-s*1.5,0)),r),p=Pl(n.sub(G(-s*.5,0)),r),y=Sl(n.sub(G(s*.5,0)),r),v=za(n.sub(G(s*1.5,0)),r);return pe(pe(i,p),pe(y,v))}),{v:1,name:"sdText",ast:{params:[{type:"i",name:"p"}],body:[0,[[13,"t",[6,[7,"d","vec2f"],[[7,"p","x"],[4,"-",[7,"p","y"]]]]],[13,"letterScale",[5,"0.45"]],[13,"spacing",[5,"0.25"]],[13,"t1",[6,"sdLetterT",[[6,[7,"t","sub"],[[6,[7,"d","vec2f"],[[1,[4,"-","spacing"],"*",[5,"1.5"]],[5,"0"]]]]],"letterScale"]]],[13,"e",[6,"sdLetterE",[[6,[7,"t","sub"],[[6,[7,"d","vec2f"],[[1,[4,"-","spacing"],"*",[5,"0.5"]],[5,"0"]]]]],"letterScale"]]],[13,"x",[6,"sdLetterX",[[6,[7,"t","sub"],[[6,[7,"d","vec2f"],[[1,"spacing","*",[5,"0.5"]],[5,"0"]]]]],"letterScale"]]],[13,"t2",[6,"sdLetterT",[[6,[7,"t","sub"],[[6,[7,"d","vec2f"],[[1,"spacing","*",[5,"1.5"]],[5,"0"]]]]],"letterScale"]]],[10,[6,[7,"std","min"],[[6,[7,"std","min"],["t1","e"]],[6,[7,"std","min"],["x","t2"]]]]]]],externalNames:["d","sdLetterT","sdLetterE","sdLetterX","std"]},get externals(){return{d:de,sdLetterT:za,sdLetterE:Pl,sdLetterX:Sl,std:De}}})&&e.f)({});export{yv as controls,gv as onCleanup};
